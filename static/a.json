{
  "result": true,
  "statusCode": 200,
  "message": {
    "data": {
      "preNodesSize": 0,
      "postNodesSize": 55,
      "nodes": [
        {
          "id": "18864935_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "leap_182:Optimus_BPC_Calculate/IDC",
          "job_name": "IDC",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-25 13:53:23",
          "job_end_time": "2019-04-25 13:53:58",
          "job_start_unix_time": 1556171603,
          "job_end_unix_time": 1556171638,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 18864935,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_Optimus",
          "owner_id": "wuth3",
          "ref_id": "18043",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "Insert overwrite table prj_optimus_prd.optimus_bpc_detail partition(partition_case='IDC')\nselect \nt.quarter,\nt.fiscper,\nt.zbpc_case as bpc_item,\nt.zbpc_case as bpc_case,\nc.geo,\nc.region_or_market,\nt.zbpc_geo as bpc_country,\nc.country,\nt.zbpc_sgmt as ww_bpc_segment,\ns.segment,\ns.sub_segment_l1,\ns.sub_segment_l2,\nt.zbpc_pgrp as bpc_pgrp,\nb.biz_group,\nb.biz_unit_l1,\nb.biz_unit_l2,\nh.high_growth_l1, \nh.high_growth_l2,\nt.acct_parents as bpc_parents,\nt.account_kpi,\nt.kpi_value,\n0 AS Last_Year_kpi_value\nfrom  \n(SELECT p.quarter,p.fiscper,zbpc_geo,zbpc_sgmt,zbpc_pgrp,zbpc_case,a.acct_parents,a.account_kpi,\nsum(a.value*zbpc_data) as kpi_value\nFROM cdl_finance.bw_fin_coobps02l_cdl bpc\njoin  prj_optimus_prd.mt_optimus_fiscal_period p\non  bpc.zbpc_time=p.bpc_time_mth \njoin prj_optimus_prd.mt_optimus_account_mapping a\non  bpc.zbpc_acct=a.bpc_acct\nwhere  p.quarter>'FY1617Q4'  and zbpc_case='IDC' and  length(zbpc_time)=8 and zbpc_chan = 'TOTCHANNEL'  \ngroup by p.quarter,p.fiscper,zbpc_geo,zbpc_sgmt,zbpc_pgrp,zbpc_case,a.acct_parents,a.account_kpi) t\njoin (select zbpc_geo,max(geo) as geo,max(region_or_market) as region_or_market,max(country) as country \nfrom  prj_optimus_prd.mt_optimus_country group by zbpc_geo )c\non t.zbpc_geo=c.zbpc_geo\njoin (select zbpc_sgmt,max(segment)as segment,max(sub_segment_l1) as  sub_segment_l1,max(sub_segment_l2) as sub_segment_l2 \nfrom prj_optimus_prd.mt_optimus_customer_segment_hierarchy\ngroup by zbpc_sgmt) s\non t.zbpc_sgmt=s.zbpc_sgmt \njoin (select zbpc_pgrp,max(biz_group) as biz_group,max(biz_unit_l1) as biz_unit_l1,max(biz_unit_l2) as biz_unit_l2\nfrom prj_optimus_prd.mt_optimus_product_hierarchy \ngroup by zbpc_pgrp)b\non t.zbpc_pgrp=b.zbpc_pgrp\nleft join (select zbpc_pgrp,max(high_growth_l1) as high_growth_l1,max(high_growth_l2) as high_growth_l2\nfrom prj_optimus_prd.mt_optimus_high_growth\n group by zbpc_pgrp ) h\non t.zbpc_pgrp=h.zbpc_pgrp",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18864935_0_0_data_0",
          "node_type": "data",
          "abstracted_path": "/cdl_finance/bw_fin_coobps02l_cdl",
          "storage_type": "spark",
          "urn": "spark://cdl_finance/bw_fin_coobps02l_cdl",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-25 13:53:23",
          "job_end_time": "2019-04-25 13:53:58",
          "job_start_unix_time": 1556171603,
          "job_end_unix_time": 1556171638,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 18864935,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "cdl_finance",
          "tbl_name": "bw_fin_coobps02l_cdl",
          "sqlText": null,
          "datasetId": 4584812,
          "srl_no": "0",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": true
        },
        {
          "id": "18864935_0_0_data_1",
          "node_type": "data",
          "abstracted_path": "/prj_optimus_prd/mt_optimus_country",
          "storage_type": "spark",
          "urn": "spark://prj_optimus_prd/mt_optimus_country",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-25 13:53:23",
          "job_end_time": "2019-04-25 13:53:58",
          "job_start_unix_time": 1556171603,
          "job_end_unix_time": 1556171638,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 18864935,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "prj_optimus_prd",
          "tbl_name": "mt_optimus_country",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "1",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18864935_0_0_data_2",
          "node_type": "data",
          "abstracted_path": "/prj_optimus_prd/mt_optimus_fiscal_period",
          "storage_type": "spark",
          "urn": "spark://prj_optimus_prd/mt_optimus_fiscal_period",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-25 13:53:23",
          "job_end_time": "2019-04-25 13:53:58",
          "job_start_unix_time": 1556171603,
          "job_end_unix_time": 1556171638,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 18864935,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "prj_optimus_prd",
          "tbl_name": "mt_optimus_fiscal_period",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "2",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18864935_0_0_data_3",
          "node_type": "data",
          "abstracted_path": "/prj_optimus_prd/mt_optimus_account_mapping",
          "storage_type": "spark",
          "urn": "spark://prj_optimus_prd/mt_optimus_account_mapping",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-25 13:53:23",
          "job_end_time": "2019-04-25 13:53:58",
          "job_start_unix_time": 1556171603,
          "job_end_unix_time": 1556171638,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 18864935,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "prj_optimus_prd",
          "tbl_name": "mt_optimus_account_mapping",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "3",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18864935_0_0_data_5",
          "node_type": "data",
          "abstracted_path": "/prj_optimus_prd/mt_optimus_high_growth",
          "storage_type": "spark",
          "urn": "spark://prj_optimus_prd/mt_optimus_high_growth",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-25 13:53:23",
          "job_end_time": "2019-04-25 13:53:58",
          "job_start_unix_time": 1556171603,
          "job_end_unix_time": 1556171638,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 18864935,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "prj_optimus_prd",
          "tbl_name": "mt_optimus_high_growth",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "5",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18864935_0_0_data_6",
          "node_type": "data",
          "abstracted_path": "/prj_optimus_prd/mt_optimus_customer_segment_hierarchy",
          "storage_type": "spark",
          "urn": "spark://prj_optimus_prd/mt_optimus_customer_segment_hierarchy",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-25 13:53:23",
          "job_end_time": "2019-04-25 13:53:58",
          "job_start_unix_time": 1556171603,
          "job_end_unix_time": 1556171638,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 18864935,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "prj_optimus_prd",
          "tbl_name": "mt_optimus_customer_segment_hierarchy",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "6",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18864935_0_0_data_7",
          "node_type": "data",
          "abstracted_path": "/prj_optimus_prd/mt_optimus_product_hierarchy",
          "storage_type": "spark",
          "urn": "spark://prj_optimus_prd/mt_optimus_product_hierarchy",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-25 13:53:23",
          "job_end_time": "2019-04-25 13:53:58",
          "job_start_unix_time": 1556171603,
          "job_end_unix_time": 1556171638,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 18864935,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "prj_optimus_prd",
          "tbl_name": "mt_optimus_product_hierarchy",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "7",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18864935_0_0_data_4",
          "node_type": "data",
          "abstracted_path": "/prj_optimus_prd/optimus_bpc_detail",
          "storage_type": "spark",
          "urn": "spark://prj_optimus_prd/optimus_bpc_detail",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-25 13:53:23",
          "job_end_time": "2019-04-25 13:53:58",
          "job_start_unix_time": 1556171603,
          "job_end_unix_time": 1556171638,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 18864935,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "prj_optimus_prd",
          "tbl_name": "optimus_bpc_detail",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "4",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18864937_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "leap_182:Optimus_BPC_Calculate/ACT",
          "job_name": "ACT",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-25 13:54:35",
          "job_end_time": "2019-04-25 13:55:34",
          "job_start_unix_time": 1556171675,
          "job_end_unix_time": 1556171734,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 18864937,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_Optimus",
          "owner_id": "wuth3",
          "ref_id": "18043",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "Insert overwrite table prj_optimus_prd.optimus_bpc_detail partition(partition_case='ACT')\nselect \nt.quarter,\nt.fiscper,\n'ACT' as bpc_item,\nt.zbpc_case as bpc_case,\nc.geo,\nc.region_or_market,\nt.zbpc_geo as bpc_country,\nc.country,\nt.zbpc_sgmt as ww_bpc_segment,\ns.segment,\ns.sub_segment_l1,\ns.sub_segment_l2,\nt.zbpc_pgrp as bpc_pgrp,\nb.biz_group,\nb.biz_unit_l1,\nb.biz_unit_l2,\nh.high_growth_l1, \nh.high_growth_l2,\nt.acct_parents as bpc_parents,\nt.account_kpi,\nt.kpi_value,\n0 AS Last_Year_kpi_value\nfrom  \n(SELECT p.quarter,p.fiscper,zbpc_geo,zbpc_sgmt,zbpc_pgrp,zbpc_case,a.acct_parents,a.account_kpi,\nsum(a.value*zbpc_data) as kpi_value\nFROM cdl_finance.bw_fin_coobps02l_cdl bpc\njoin  prj_optimus_prd.mt_optimus_fiscal_period p\non  bpc.zbpc_time=p.bpc_time_mth \njoin prj_optimus_prd.mt_optimus_account_mapping a\non  bpc.zbpc_acct=a.bpc_acct\nwhere  p.quarter>'FY1617Q4' and ((zbpc_case='ACTQ' and substr(p.quarter,1,6)='${cur_fy}' ) \nOR (zbpc_case='RACT' and substr(p.quarter,1,6)<'${cur_fy}'))    \nand  length(zbpc_time)=8 and zbpc_chan = 'TOTCHANNEL'  \ngroup by p.quarter,p.fiscper,zbpc_geo,zbpc_sgmt,zbpc_pgrp,zbpc_case,a.acct_parents,a.account_kpi) t\njoin (select zbpc_geo,max(geo) as geo,max(region_or_market) as region_or_market,max(country) as country \nfrom  prj_optimus_prd.mt_optimus_country group by zbpc_geo )c\non t.zbpc_geo=c.zbpc_geo\njoin (select zbpc_sgmt,max(segment)as segment,max(sub_segment_l1) as  sub_segment_l1,max(sub_segment_l2) as sub_segment_l2 \nfrom prj_optimus_prd.mt_optimus_customer_segment_hierarchy\ngroup by zbpc_sgmt) s\non t.zbpc_sgmt=s.zbpc_sgmt \njoin (select zbpc_pgrp,max(biz_group) as biz_group,max(biz_unit_l1) as biz_unit_l1,max(biz_unit_l2) as biz_unit_l2\nfrom prj_optimus_prd.mt_optimus_product_hierarchy \ngroup by zbpc_pgrp)b\non t.zbpc_pgrp=b.zbpc_pgrp\nleft  join (select zbpc_pgrp,max(high_growth_l1) as high_growth_l1,max(high_growth_l2) as high_growth_l2\nfrom prj_optimus_prd.mt_optimus_high_growth\n group by zbpc_pgrp ) h\non t.zbpc_pgrp=h.zbpc_pgrp",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18864937_0_0_data_2",
          "node_type": "data",
          "abstracted_path": "/default/fc_period",
          "storage_type": "spark",
          "urn": "spark://default/fc_period",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-25 13:54:35",
          "job_end_time": "2019-04-25 13:55:34",
          "job_start_unix_time": 1556171675,
          "job_end_unix_time": 1556171734,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 18864937,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "default",
          "tbl_name": "fc_period",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "2",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20270233_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Group_Total_Revenue/Group_Total_Revenue",
          "job_name": "Group_Total_Revenue",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 05:35:04",
          "job_end_time": "2019-05-22 05:38:48",
          "job_start_unix_time": 1558474504,
          "job_end_unix_time": 1558474728,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20270233,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "14510",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "----------Group Total Revenue\n--2793.2200187\nWITH TP AS \n( SELECT base_id\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='PRODGROUP' AND tree='PARENTH6' AND parent_id='BGL'\n),TG AS\n(SELECT base_id\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='GEOGRAPHY' AND tree='PARENTH1' AND parent_id='WW2013'\n),TC AS\n(SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='LAYERS' AND tree='PARENTH1' AND parent_id='ALLLAYERS'\n)\n, T AS ( \nSELECT zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, SUM(zbpc_data) AS zbpc_data\n, MAX(update_timestamp) AS update_timestamp\nFROM (SELECT *\n      FROM (SELECT *\n            FROM `cdl_finance`.`bw_fin_coobps02l_cdl` AS F\n            LEFT SEMI JOIN TP ON F.zbpc_pgrp=TP.base_id\n            WHERE zbpc_acct='TOTREV' \n            AND zbpc_case=CASE WHEN UPPER(zbpc_time) in ('2016.APR','2016.MAY','2016.JUN','2016.JUL','2016.AUG','2016.SEP','2016.OCT','2016.NOV','2016.DEC','2017.JAN','2017.FEB','2017.MAR') THEN 'RACT'\n                                WHEN UPPER(zbpc_time) in ('2017.APR','2017.MAY','2017.JUN','2017.JUL','2017.AUG','2017.SEP','2017.OCT','2017.NOV','2017.DEC','2018.JAN','2018.FEB','2018.MAR') THEN 'RACT'\n                                  ELSE\n                                     \tCASE WHEN UPPER(zbpc_time) LIKE '%.MAR' OR UPPER(zbpc_time) LIKE '%.JUN' OR UPPER(zbpc_time) LIKE '%.SEP' OR UPPER(zbpc_time) LIKE '%.DEC' \n                                     \t\t\t THEN 'ACTQ'\n                                     \t\tELSE 'ACT' END\n                                     END         \n            AND zbpc_chan='TOTCHANNEL' \n            AND zbpc_sgmt='INDUSTRY' \n            ) AS T1\n      LEFT SEMI JOIN TG ON T1.zbpc_geo = TG.base_id\n      )AS T2\nLEFT SEMI JOIN TC ON T2.zbpc_lays = TC.base_id \nGROUP BY zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n)\n\ninsert overwrite table proj_tx_kpi_prd.T_Transformation_Group_Total_Revenue\nSELECT CASE WHEN UPPER(zbpc_time) LIKE '%.JAN' THEN concat(substring(zbpc_time,1,4),'-01')\n            WHEN UPPER(zbpc_time) LIKE '%.FEB' THEN concat(substring(zbpc_time,1,4),'-02')\n            WHEN UPPER(zbpc_time) LIKE '%.MAR' THEN concat(substring(zbpc_time,1,4),'-03')\n            WHEN UPPER(zbpc_time) LIKE '%.APR' THEN concat(substring(zbpc_time,1,4),'-04')\n            WHEN UPPER(zbpc_time) LIKE '%.MAY' THEN concat(substring(zbpc_time,1,4),'-05')\n            WHEN UPPER(zbpc_time) LIKE '%.JUN' THEN concat(substring(zbpc_time,1,4),'-06')\n            WHEN UPPER(zbpc_time) LIKE '%.JUL' THEN concat(substring(zbpc_time,1,4),'-07')\n            WHEN UPPER(zbpc_time) LIKE '%.AUG' THEN concat(substring(zbpc_time,1,4),'-08')\n            WHEN UPPER(zbpc_time) LIKE '%.SEP' THEN concat(substring(zbpc_time,1,4),'-09')\n            WHEN UPPER(zbpc_time) LIKE '%.OCT' THEN concat(substring(zbpc_time,1,4),'-10')\n            WHEN UPPER(zbpc_time) LIKE '%.NOV' THEN concat(substring(zbpc_time,1,4),'-11')\n            WHEN UPPER(zbpc_time) LIKE '%.DEC' THEN concat(substring(zbpc_time,1,4),'-12')\n            END zbpc_time\n     , zbpc_pgrp\n     , 'Group Total Revenue' AS kpi_name\n     , 'ALL' BU\n     , SUM(zbpc_data) AS zbpc_data\n\nFROM T where SUBSTR(upper(zbpc_time),-3,3) <>'INP' and SUBSTR(upper(zbpc_time),1,4) <>'2015'\n--WHERE zbpc_time='2018.APR' ---------AND zbpc_pgrp='LNNL'\nGROUP BY zbpc_time, zbpc_pgrp\nORDER BY zbpc_time, zbpc_pgrp DESC",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20270233_0_0_data_0",
          "node_type": "data",
          "abstracted_path": "/default/tp",
          "storage_type": "spark",
          "urn": "spark://default/tp",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 05:35:04",
          "job_end_time": "2019-05-22 05:38:48",
          "job_start_unix_time": 1558474504,
          "job_end_unix_time": 1558474728,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20270233,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "default",
          "tbl_name": "tp",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "0",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20270233_0_0_data_1",
          "node_type": "data",
          "abstracted_path": "/default/t",
          "storage_type": "spark",
          "urn": "spark://default/t",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 05:35:04",
          "job_end_time": "2019-05-22 05:38:48",
          "job_start_unix_time": 1558474504,
          "job_end_unix_time": 1558474728,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20270233,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "default",
          "tbl_name": "t",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "1",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20270233_0_0_data_4",
          "node_type": "data",
          "abstracted_path": "/default/tg",
          "storage_type": "spark",
          "urn": "spark://default/tg",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 05:35:04",
          "job_end_time": "2019-05-22 05:38:48",
          "job_start_unix_time": 1558474504,
          "job_end_unix_time": 1558474728,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20270233,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "default",
          "tbl_name": "tg",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "4",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20270233_0_0_data_5",
          "node_type": "data",
          "abstracted_path": "/dm_finance/bpc_fin_dim_hier_odl",
          "storage_type": "spark",
          "urn": "spark://dm_finance/bpc_fin_dim_hier_odl",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 05:35:04",
          "job_end_time": "2019-05-22 05:38:48",
          "job_start_unix_time": 1558474504,
          "job_end_unix_time": 1558474728,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20270233,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "dm_finance",
          "tbl_name": "bpc_fin_dim_hier_odl",
          "sqlText": null,
          "datasetId": 4584863,
          "srl_no": "5",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20270233_0_0_data_6",
          "node_type": "data",
          "abstracted_path": "/default/tc",
          "storage_type": "spark",
          "urn": "spark://default/tc",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 05:35:04",
          "job_end_time": "2019-05-22 05:38:48",
          "job_start_unix_time": 1558474504,
          "job_end_unix_time": 1558474728,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20270233,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "default",
          "tbl_name": "tc",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "6",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20270233_0_0_data_3",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_group_total_revenue",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_group_total_revenue",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 05:35:04",
          "job_end_time": "2019-05-22 05:38:48",
          "job_start_unix_time": 1558474504,
          "job_end_unix_time": 1558474728,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20270233,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_group_total_revenue",
          "sqlText": null,
          "datasetId": 4656025,
          "srl_no": "3",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288699_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Non_device_Revenue_LCIG_Fact_geo/T_Transformation_Non_device_Revenue_LCIG_Fact_geo",
          "job_name": "T_Transformation_Non_device_Revenue_LCIG_Fact_geo",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:35:29",
          "job_end_time": "2019-05-22 12:36:17",
          "job_start_unix_time": 1558499729,
          "job_end_unix_time": 1558499777,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288699,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16221",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "WITH TG AS\n(SELECT base_id\n        ,parent_id as parent_id_1\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='GEOGRAPHY' AND tree='PARENTH1' AND parent_id in('WW2013','PRCG','AP','EMEANEW','NAG','LAR','HQ')\n),TC AS\n(SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='LAYERS' AND tree='PARENTH1' AND parent_id='ALLLAYERS'\n)\n, T AS ( \nSELECT zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, BU\n, kpi_name\n, parent_id_1\n, SUM(zbpc_data) AS zbpc_data\n, MAX(update_timestamp) AS update_timestamp\nFROM (  SELECT *\n              , TG.parent_id_1\n              , 'LCIG' BU\n              , CASE WHEN zbpc_pgrp='LPSWA' THEN 'Big Data'\n                     WHEN zbpc_pgrp='CSS' THEN 'Enterprise Cloud'\n                     WHEN zbpc_pgrp='CEM' THEN 'Lenovo Connect'\n                     END kpi_name   \n                 FROM `cdl_finance`.`bw_fin_coobps02l_cdl` AS F\n                 LEFT  JOIN TG ON F.zbpc_geo = TG.base_id\n                 WHERE zbpc_acct='TOTREV'  and F.zbpc_geo is not null\n                 AND zbpc_case=CASE WHEN UPPER(zbpc_time) in ('2016.APR','2016.MAY','2016.JUN','2016.JUL','2016.AUG','2016.SEP','2016.OCT','2016.NOV','2016.DEC','2017.JAN','2017.FEB','2017.MAR') THEN 'RACT'\n                                WHEN UPPER(zbpc_time) in ('2017.APR','2017.MAY','2017.JUN','2017.JUL','2017.AUG','2017.SEP','2017.OCT','2017.NOV','2017.DEC','2018.JAN','2018.FEB','2018.MAR') THEN 'RACT'\n                                  ELSE\n                                     \tCASE WHEN UPPER(zbpc_time) LIKE '%.MAR' OR UPPER(zbpc_time) LIKE '%.JUN' OR UPPER(zbpc_time) LIKE '%.SEP' OR UPPER(zbpc_time) LIKE '%.DEC' \n                                     \t\t\t THEN 'ACTQ'\n                                     \t\tELSE 'ACT' END\n                                     END    \n                 AND zbpc_chan='TOTCHANNEL' \n                 AND zbpc_sgmt='INDUSTRY' \n                 AND zbpc_pgrp IN ('LPSWA','CSS','CEM')\n      ) AS T1\nLEFT SEMI JOIN TC ON T1.zbpc_lays = TC.base_id \nGROUP BY zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, BU\n, kpi_name\n, parent_id_1\n)\n\n\ninsert overwrite table proj_tx_kpi_prd.T_Transformation_Non_device_Revenue_LCIG_Fact_geo\nSELECT  case when parent_id_1 ='PRCG' then 'PRC'\n          when parent_id_1 ='AP'   then 'AP'\n          when parent_id_1 ='EMEANEW' then 'EMEA'\n          when parent_id_1 ='NAG'     then 'NA'\n          when parent_id_1 ='LAR'     then 'LA'\n          when parent_id_1 ='HQ'      then 'HQ'\n          when parent_id_1 ='WW2013'      then 'WW2013'\n        end  as geo\n     ,upper(zbpc_time) as zbpc_time\n     , zbpc_pgrp\n     , kpi_name\n     , BU\n     , 'A' data_type\n     , 'Non_device' as business_type\n     , SUM(zbpc_data) AS zbpc_data\nFROM T where SUBSTR(upper(zbpc_time),-3,3) <>'INP' and SUBSTR(upper(zbpc_time),1,4) <>'2015'\nGROUP BY parent_id_1,upper(zbpc_time), zbpc_pgrp, kpi_name, BU\nORDER BY upper(zbpc_time), zbpc_pgrp, kpi_name, BU DESC",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288699_0_0_data_0",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_non_device_revenue_lcig_fact_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_non_device_revenue_lcig_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:35:29",
          "job_end_time": "2019-05-22 12:36:17",
          "job_start_unix_time": 1558499729,
          "job_end_unix_time": 1558499777,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288699,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_non_device_revenue_lcig_fact_geo",
          "sqlText": null,
          "datasetId": 4656077,
          "srl_no": "0",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288689_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:t_transformation_all_emerging_Fact_Geo/t_transformation_get_emerging_Fact_Geo",
          "job_name": "t_transformation_get_emerging_Fact_Geo",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:35:29",
          "job_end_time": "2019-05-22 12:37:59",
          "job_start_unix_time": 1558499729,
          "job_end_unix_time": 1558499879,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288689,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16219",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "-- Emerging_dcg_get\n--leap id 14504\nWITH TP AS \n( SELECT base_id\n       , 'Total Storage (j)' kpi_name\n       , 'DCG'  BU\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='PRODGROUP' AND tree IN ('PARENTH5') AND parent_id IN ('ST')  \n),TG AS\n(SELECT base_id\n        ,parent_id as parent_id_1\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='GEOGRAPHY' AND tree='PARENTH1' AND parent_id in('WW2013','PRCG','AP','EMEANEW','NAG','LAR','HQ')\n)\n,TC AS\n(SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='LAYERS' AND tree='PARENTH1' AND parent_id='ALLLAYERS'\n)\n, T AS (\nSELECT zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, BU\n, parent_id_1\n, SUM(zbpc_data) AS zbpc_data\n, MAX(update_timestamp) AS update_timestamp\nFROM (SELECT TG.parent_id_1,*\n      FROM ( SELECT *, TP.kpi_name, TP.BU\n             FROM `cdl_finance`.`bw_fin_coobps02l_cdl` AS F\n             LEFT OUTER JOIN TP ON F.zbpc_pgrp=TP.base_id\n             WHERE zbpc_acct='TOTREV' \n             AND zbpc_case=CASE WHEN UPPER(zbpc_time) in ('2016.APR','2016.MAY','2016.JUN','2016.JUL','2016.AUG','2016.SEP','2016.OCT','2016.NOV','2016.DEC','2017.JAN','2017.FEB','2017.MAR') THEN 'RACT'\n                                WHEN UPPER(zbpc_time) in ('2017.APR','2017.MAY','2017.JUN','2017.JUL','2017.AUG','2017.SEP','2017.OCT','2017.NOV','2017.DEC','2018.JAN','2018.FEB','2018.MAR') THEN 'RACT'\n                                  ELSE\n                                     \tCASE WHEN UPPER(zbpc_time) LIKE '%.MAR' OR UPPER(zbpc_time) LIKE '%.JUN' OR UPPER(zbpc_time) LIKE '%.SEP' OR UPPER(zbpc_time) LIKE '%.DEC' \n                                     \t\t\t THEN 'ACTQ'\n                                     \t\tELSE 'ACT' END\n                                     END    \n             AND zbpc_chan='TOTCHANNEL' \n             AND zbpc_sgmt='INDUSTRY' \n             AND TP.kpi_name IS NOT NULL \n             AND TP.BU IS NOT NULL \n            ) AS T1\n      LEFT  JOIN TG ON T1.zbpc_geo = TG.base_id where T1.zbpc_geo is not null\n      ) AS T2\nLEFT SEMI JOIN TC ON T2.zbpc_lays = TC.base_id \nGROUP BY zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, BU\n, parent_id_1\n)\n\n\n,BU_ALL as (\nSELECT case when parent_id_1 ='PRCG' then 'PRC'\n          when parent_id_1 ='AP'   then 'AP'\n          when parent_id_1 ='EMEANEW' then 'EMEA'\n          when parent_id_1 ='NAG'     then 'NA'\n          when parent_id_1 ='LAR'     then 'LA'\n          when parent_id_1 ='HQ'      then 'HQ'\n          when parent_id_1 ='WW2013'      then 'WW2013'\n        end  as geo\n     ,upper(zbpc_time) as zbpc_time\n     ,zbpc_pgrp\n     ,kpi_name\n     ,BU\n     ,'A' as data_type\n     ,'Emerging' as business_type\n     ,SUM(zbpc_data) AS zbpc_data\nFROM T\n--WHERE zbpc_time='2018.APR' \nGROUP BY parent_id_1,upper(zbpc_time), zbpc_pgrp,kpi_name, BU\nORDER BY upper(zbpc_time), zbpc_pgrp,kpi_name, BU DESC )\n\n\n---- dcg\n\n\n,TP1 AS \n( SELECT base_id\n       , 'Software Defined Storage (SDS) (i)' kpi_name\n       , 'DCG'  BU\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='PRODGROUP' AND tree IN ('PARENTH6') AND parent_id IN ('EBG') \n),TG1 AS\n(SELECT base_id\n        ,parent_id as parent_id_1\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='GEOGRAPHY' AND tree='PARENTH1' AND parent_id in('WW2013','PRCG','AP','EMEANEW','NAG','LAR','HQ')\n)\n,TC1 AS\n(SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='LAYERS' AND tree='PARENTH1' AND parent_id='ALLLAYERS'\n)\n, T1 AS (\nSELECT zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, BU\n, parent_id_1\n, SUM(zbpc_data) AS zbpc_data\n, MAX(update_timestamp) AS update_timestamp\nFROM (SELECT TG1.parent_id_1,*\n      FROM ( SELECT *, TP1.kpi_name, TP1.BU\n             FROM `cdl_finance`.`bw_fin_coobps02l_cdl` AS F1\n             LEFT OUTER JOIN TP1 ON F1.zbpc_pgrp=TP1.base_id\n             WHERE zbpc_acct='TOTREV' \n             AND zbpc_case=CASE WHEN UPPER(zbpc_time) in ('2016.APR','2016.MAY','2016.JUN','2016.JUL','2016.AUG','2016.SEP','2016.OCT','2016.NOV','2016.DEC','2017.JAN','2017.FEB','2017.MAR') THEN 'RACT'\n                                WHEN UPPER(zbpc_time) in ('2017.APR','2017.MAY','2017.JUN','2017.JUL','2017.AUG','2017.SEP','2017.OCT','2017.NOV','2017.DEC','2018.JAN','2018.FEB','2018.MAR') THEN 'RACT'\n                                  ELSE\n                                     \tCASE WHEN UPPER(zbpc_time) LIKE '%.MAR' OR UPPER(zbpc_time) LIKE '%.JUN' OR UPPER(zbpc_time) LIKE '%.SEP' OR UPPER(zbpc_time) LIKE '%.DEC' \n                                     \t\t\t THEN 'ACTQ'\n                                     \t\tELSE 'ACT' END\n                                     END     \n             AND zbpc_chan='BSSDSTG' \n             AND zbpc_sgmt='INDUSTRY' \n             AND TP1.kpi_name IS NOT NULL \n             AND TP1.BU IS NOT NULL \n            ) AS T11\n      LEFT  JOIN TG1 ON T11.zbpc_geo = TG1.base_id where T11.zbpc_geo is not null\n      ) AS T21\nLEFT SEMI JOIN TC1 ON T21.zbpc_lays = TC1.base_id \nGROUP BY zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, BU\n, parent_id_1\n)\n,\nDCG_ONE as (\nSELECT \ncase when parent_id_1 ='PRCG' then 'PRC'\n          when parent_id_1 ='AP'   then 'AP'\n          when parent_id_1 ='EMEANEW' then 'EMEA'\n          when parent_id_1 ='NAG'     then 'NA'\n          when parent_id_1 ='LAR'     then 'LA'\n          when parent_id_1 ='HQ'      then 'HQ'\n          when parent_id_1 ='WW2013'      then 'WW2013'\n        end  as geo\n     ,upper(zbpc_time) as zbpc_time\n     ,zbpc_pgrp\n     , kpi_name\n     , BU\n     ,'A' as data_type\n     ,'Emerging' as business_type\n     , SUM(zbpc_data) AS zbpc_data\nFROM T1\nGROUP BY parent_id_1,upper(zbpc_time), zbpc_pgrp,kpi_name, BU\nORDER BY upper(zbpc_time),zbpc_pgrp, kpi_name, BU DESC \n)\n\ninsert overwrite table proj_tx_kpi_prd.t_transformation_get_emerging_Fact_Geo\nselect * from BU_ALL  where SUBSTR(upper(zbpc_time),-3,3) <>'INP' and SUBSTR(upper(zbpc_time),1,4) <>'2015'\nunion all\nselect * from DCG_ONE  where SUBSTR(upper(zbpc_time),-3,3) <>'INP' and SUBSTR(upper(zbpc_time),1,4) <>'2015'",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288689_0_0_data_0",
          "node_type": "data",
          "abstracted_path": "/default/bu_all",
          "storage_type": "spark",
          "urn": "spark://default/bu_all",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:35:29",
          "job_end_time": "2019-05-22 12:37:59",
          "job_start_unix_time": 1558499729,
          "job_end_unix_time": 1558499879,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20288689,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "default",
          "tbl_name": "bu_all",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "0",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288689_0_0_data_2",
          "node_type": "data",
          "abstracted_path": "/default/t1",
          "storage_type": "spark",
          "urn": "spark://default/t1",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:35:29",
          "job_end_time": "2019-05-22 12:37:59",
          "job_start_unix_time": 1558499729,
          "job_end_unix_time": 1558499879,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20288689,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "default",
          "tbl_name": "t1",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "2",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288689_0_0_data_4",
          "node_type": "data",
          "abstracted_path": "/default/tc1",
          "storage_type": "spark",
          "urn": "spark://default/tc1",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:35:29",
          "job_end_time": "2019-05-22 12:37:59",
          "job_start_unix_time": 1558499729,
          "job_end_unix_time": 1558499879,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20288689,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "default",
          "tbl_name": "tc1",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "4",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288689_0_0_data_6",
          "node_type": "data",
          "abstracted_path": "/default/dcg_one",
          "storage_type": "spark",
          "urn": "spark://default/dcg_one",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:35:29",
          "job_end_time": "2019-05-22 12:37:59",
          "job_start_unix_time": 1558499729,
          "job_end_unix_time": 1558499879,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20288689,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "default",
          "tbl_name": "dcg_one",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "6",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288689_0_0_data_8",
          "node_type": "data",
          "abstracted_path": "/default/tg1",
          "storage_type": "spark",
          "urn": "spark://default/tg1",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:35:29",
          "job_end_time": "2019-05-22 12:37:59",
          "job_start_unix_time": 1558499729,
          "job_end_unix_time": 1558499879,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20288689,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "default",
          "tbl_name": "tg1",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "8",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288689_0_0_data_11",
          "node_type": "data",
          "abstracted_path": "/default/tp1",
          "storage_type": "spark",
          "urn": "spark://default/tp1",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:35:29",
          "job_end_time": "2019-05-22 12:37:59",
          "job_start_unix_time": 1558499729,
          "job_end_unix_time": 1558499879,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20288689,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "default",
          "tbl_name": "tp1",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "11",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288689_0_0_data_12",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_get_emerging_fact_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_get_emerging_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:35:29",
          "job_end_time": "2019-05-22 12:37:59",
          "job_start_unix_time": 1558499729,
          "job_end_unix_time": 1558499879,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288689,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_get_emerging_fact_geo",
          "sqlText": null,
          "datasetId": 4656020,
          "srl_no": "12",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288693_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Non_device_Revenue_all_DCG_Fact_Geo/T_Transformation_Non_device_Revenue_get_NOT_TOTCHANNEL_DCG_Fact_Geo",
          "job_name": "T_Transformation_Non_device_Revenue_get_NOT_TOTCHANNEL_DCG_Fact_Geo",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:35:29",
          "job_end_time": "2019-05-22 12:36:45",
          "job_start_unix_time": 1558499729,
          "job_end_unix_time": 1558499805,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288693,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16220",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "--------DCG Non-device Revenue get Basemember NOT TOTCHANNEL\nWITH TP AS \n( SELECT  base_id, parent_id\n  FROM `dm_finance`.`bpc_fin_dim_hier_odl`\n  WHERE category='PRODGROUP' AND tree IN ('PARENTH6','PARENTH8') AND parent_id IN ('EMDS','EBG')\n)\n,TG AS\n(SELECT base_id\n        ,parent_id as parent_id_1\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='GEOGRAPHY' AND tree='PARENTH1' AND parent_id in('WW2013','PRCG','AP','EMEANEW','NAG','LAR','HQ')\n)\n,TC AS\n(SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='LAYERS' AND tree='PARENTH1' AND parent_id='ALLLAYERS'\n)\n, T AS ( \nSELECT zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, parent_id_1\n, SUM(zbpc_data) AS zbpc_data\n, MAX(update_timestamp) AS update_timestamp\nFROM (SELECT TG.parent_id_1, *\n      FROM (SELECT *\n                 , CASE WHEN TP. parent_id='EMDS' AND zbpc_chan ='HYPCONV' THEN 'Hyperconverged Software (b)'\n                        WHEN TP. parent_id='EMDS' AND zbpc_chan ='CONV' THEN 'Converged Software (c)'\n                        WHEN TP. parent_id='EMDS' AND zbpc_chan ='BSSDSTG' THEN 'SDS Software (d)'\n                        WHEN TP. parent_id='EMDS' AND zbpc_chan ='BSDCISTG' THEN 'DCI Storage Software (e)'\n                        WHEN TP. parent_id='EMDS' AND zbpc_chan ='BSSDNW' THEN 'Networking Software (f)'\n                        WHEN TP. parent_id='EBG' AND zbpc_chan ='HYPCONV' THEN 'Hyperconverged'\n                        WHEN TP. parent_id='EBG' AND zbpc_chan ='CONV' THEN 'Converged (h)'\n                        WHEN TP. parent_id='EBG' AND zbpc_chan ='BSSDSTG' THEN 'Software Defined Storage (SDS) (i)'\n                        --new add two kpi\n                        WHEN TP. parent_id='EBG' AND zbpc_chan ='BSSDIVM' THEN 'SDI - VM Ware (j)'\n                        WHEN TP. parent_id='EBG' AND zbpc_chan ='BSSDICP' THEN 'SDI - Cloud Platform (k)'\n                        WHEN TP. parent_id='EMDS' AND zbpc_chan ='BSSDIVM' THEN 'SDI  VM Ware (g)'\n                        WHEN TP. parent_id='EMDS' AND zbpc_chan ='BSSDICP' THEN 'SDI - Cloud Platform (h)'\n                        \n                        END kpi_name\n            FROM `cdl_finance`.`bw_fin_coobps02l_cdl` AS F\n            LEFT OUTER JOIN TP ON F.zbpc_pgrp=TP.base_id\n            WHERE zbpc_acct='TOTREV' \n            AND zbpc_case= CASE WHEN UPPER(zbpc_time) in ('2016.APR','2016.MAY','2016.JUN','2016.JUL','2016.AUG','2016.SEP','2016.OCT','2016.NOV','2016.DEC','2017.JAN','2017.FEB','2017.MAR') THEN 'RACT'\n                                WHEN UPPER(zbpc_time) in ('2017.APR','2017.MAY','2017.JUN','2017.JUL','2017.AUG','2017.SEP','2017.OCT','2017.NOV','2017.DEC','2018.JAN','2018.FEB','2018.MAR') THEN 'RACT'\n                                  ELSE\n                                     \tCASE WHEN UPPER(zbpc_time) LIKE '%.MAR' OR UPPER(zbpc_time) LIKE '%.JUN' OR UPPER(zbpc_time) LIKE '%.SEP' OR UPPER(zbpc_time) LIKE '%.DEC' \n                                     \t\t\t THEN 'ACTQ'\n                                     \t\tELSE 'ACT' END\n                                     END    \n            AND zbpc_chan IN ('HYPCONV','CONV','BSSDSTG','BSDCISTG','BSSDNW','HYPCONV','BSSDIVM','BSSDICP')\n            AND zbpc_sgmt='INDUSTRY' \n            AND TP.parent_id IS NOT NULL\n            ) AS T1\n      LEFT  JOIN TG ON T1.zbpc_geo = TG.base_id where T1.zbpc_geo is not null\n      )AS T2\nLEFT SEMI JOIN TC ON T2.zbpc_lays = TC.base_id \nGROUP BY zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, parent_id_1\n)\n\n\ninsert overwrite table proj_tx_kpi_prd.T_Transformation_Non_device_Revenue_get_NOT_TOTCHANNEL_DCG_Fact_Geo\n\nSELECT \ncase when parent_id_1 ='PRCG' then 'PRC'\n          when parent_id_1 ='AP'   then 'AP'\n          when parent_id_1 ='EMEANEW' then 'EMEA'\n          when parent_id_1 ='NAG'     then 'NA'\n          when parent_id_1 ='LAR'     then 'LA'\n          when parent_id_1 ='HQ'      then 'HQ'\n          when parent_id_1 ='WW2013'      then 'WW2013'\n        end  as geo\n     ,upper(zbpc_time) as zbpc_time\n     , zbpc_pgrp\n     , kpi_name\n     , 'DCG' BU\n     , 'A' data_type\n     , 'Non_device' as business_type\n     , SUM(zbpc_data) AS zbpc_data\nFROM T\nWHERE  kpi_name IS NOT NULL AND SUBSTR(upper(zbpc_time),-3,3) <>'INP'\nGROUP BY parent_id_1,upper(zbpc_time), kpi_name, zbpc_pgrp\nORDER BY upper(zbpc_time), kpi_name , zbpc_pgrp DESC",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288693_0_0_data_6",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_non_device_revenue_get_not_totchannel_dcg_fact_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_non_device_revenue_get_not_totchannel_dcg_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:35:29",
          "job_end_time": "2019-05-22 12:36:45",
          "job_start_unix_time": 1558499729,
          "job_end_unix_time": 1558499805,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288693,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_non_device_revenue_get_not_totchannel_dcg_fact_geo",
          "sqlText": null,
          "datasetId": 4656057,
          "srl_no": "6",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20270234_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Group_Total_Revenue/BG_Total_Revenue",
          "job_name": "BG_Total_Revenue",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 05:38:48",
          "job_end_time": "2019-05-22 05:41:01",
          "job_start_unix_time": 1558474728,
          "job_end_unix_time": 1558474861,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20270234,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "14510",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "-------BG Total Revenue\nWITH TP AS \n( SELECT base_id\n        , CASE WHEN parent_id='PCL' THEN 'PCSD Total Revenue'\n               WHEN parent_id='MBG' THEN 'MBG Total Revenue'\n               WHEN parent_id='EBG' THEN 'DCG Total Revenue'\n               --WHEN parent_id='ECS' THEN 'LCIG Total Revenue'\n               END kpi_name\n        , CASE WHEN parent_id='PCL' THEN 'PCSD'\n               WHEN parent_id='MBG' THEN 'MBG'\n               WHEN parent_id='EBG' THEN 'DCG'\n              -- WHEN parent_id='ECS' THEN 'LCIG'\n               END bg\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='PRODGROUP'  AND parent_id IN ('PCL','MBG','EBG','ECS')\n),\nTG AS\n(SELECT base_id\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='GEOGRAPHY' AND tree='PARENTH1' AND parent_id='WW2013'\n),\nTC AS\n(SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='LAYERS' AND tree='PARENTH1' AND parent_id='ALLLAYERS'\n)\n, \n\nT AS ( \nSELECT zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, bg\n, SUM(zbpc_data) AS zbpc_data\n, MAX(update_timestamp) AS update_timestamp\nFROM (SELECT *\n      FROM (SELECT F.*, TP.kpi_name, TP.bg\n            FROM `cdl_finance`.`bw_fin_coobps02l_cdl` AS F\n            LEFT OUTER JOIN TP ON F.zbpc_pgrp=TP.base_id\n            WHERE zbpc_acct='TOTREV' \n            AND zbpc_case=CASE WHEN UPPER(zbpc_time) in ('2016.APR','2016.MAY','2016.JUN','2016.JUL','2016.AUG','2016.SEP','2016.OCT','2016.NOV','2016.DEC','2017.JAN','2017.FEB','2017.MAR') THEN 'RACT'\n                                WHEN UPPER(zbpc_time) in ('2017.APR','2017.MAY','2017.JUN','2017.JUL','2017.AUG','2017.SEP','2017.OCT','2017.NOV','2017.DEC','2018.JAN','2018.FEB','2018.MAR') THEN 'RACT'\n                                  ELSE\n                                     \tCASE WHEN UPPER(zbpc_time) LIKE '%.MAR' OR UPPER(zbpc_time) LIKE '%.JUN' OR UPPER(zbpc_time) LIKE '%.SEP' OR UPPER(zbpc_time) LIKE '%.DEC' \n                                     \t\t\t THEN 'ACTQ'\n                                     \t\tELSE 'ACT' END\n                                     END              \n            AND zbpc_chan='TOTCHANNEL' \n            AND zbpc_sgmt='INDUSTRY' \n            AND TP.bg IS NOT NULL\n            AND TP.kpi_name IS NOT NULL\n            ) AS T1\n      LEFT SEMI JOIN TG ON T1.zbpc_geo = TG.base_id\n      )AS T2\nLEFT SEMI JOIN TC ON T2.zbpc_lays = TC.base_id \nGROUP BY zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, bg\n)\n\nINSERT OVERWRITE TABLE proj_tx_kpi_prd.T_Transformation_BG_Total_Revenue_middle\nSELECT zbpc_time\n     , kpi_name AS kpi_layer1\n     , bg\n     , SUM(zbpc_data) AS zbpc_data\nFROM T where SUBSTR(upper(zbpc_time),-3,3) <>'INP' and SUBSTR(upper(zbpc_time),1,4) <>'2015'\nGROUP BY zbpc_time, kpi_name, bg \nORDER BY zbpc_time DESC",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20270234_0_0_data_0",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_bg_total_revenue_middle",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_bg_total_revenue_middle",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 05:38:48",
          "job_end_time": "2019-05-22 05:41:01",
          "job_start_unix_time": 1558474728,
          "job_end_unix_time": 1558474861,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20270234,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_bg_total_revenue_middle",
          "sqlText": null,
          "datasetId": 4655982,
          "srl_no": "0",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288707_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:idg_medion_non_pc_all_kpi_name_Fact_Geo/medion_pc_bounty_Fact_Geo",
          "job_name": "medion_pc_bounty_Fact_Geo",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:38:00",
          "job_end_time": "2019-05-22 12:38:43",
          "job_start_unix_time": 1558499880,
          "job_end_unix_time": 1558499923,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288707,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16224",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "-- <exclude> medion pc bounty\n\nWITH TP AS \n( SELECT base_id\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='PRODGROUP' AND tree ='PARENTH8' AND parent_id='MEDEB'\n),\n\n\nTG AS\n(SELECT base_id\n       ,parent_id as parent_id_1\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='GEOGRAPHY' AND tree='PARENTH1' AND parent_id in('WW2013','PRCG','AP','EMEANEW','NAG','LAR','HQ')\n),\n\n\nTC AS\n(SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='LAYERS' AND tree='PARENTH1' AND parent_id='ALLLAYERS'\n)\n, \n\nT AS ( \nSELECT zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, parent_id_1\n, SUM(zbpc_data) AS zbpc_data\n, MAX(update_timestamp) AS update_timestamp\nFROM (SELECT TG.parent_id_1,*\n      FROM (SELECT *\n            FROM `cdl_finance`.`bw_fin_coobps02l_cdl` AS F\n            LEFT SEMI JOIN TP ON F.zbpc_pgrp=TP.base_id\n            WHERE zbpc_acct='TOTREV' AND \n            zbpc_case=CASE WHEN UPPER(zbpc_time) in ('2016.APR','2016.MAY','2016.JUN','2016.JUL','2016.AUG','2016.SEP','2016.OCT','2016.NOV','2016.DEC','2017.JAN','2017.FEB','2017.MAR') THEN 'RACT'\n                                WHEN UPPER(zbpc_time) in ('2017.APR','2017.MAY','2017.JUN','2017.JUL','2017.AUG','2017.SEP','2017.OCT','2017.NOV','2017.DEC','2018.JAN','2018.FEB','2018.MAR') THEN 'RACT'\n                                  ELSE\n                                     \tCASE WHEN UPPER(zbpc_time) LIKE '%.MAR' OR UPPER(zbpc_time) LIKE '%.JUN' OR UPPER(zbpc_time) LIKE '%.SEP' OR UPPER(zbpc_time) LIKE '%.DEC' \n                                     \t\t\t THEN 'ACTQ'\n                                     \t\tELSE 'ACT' END\n                                     END  \n             AND zbpc_chan='TOTCHANNEL' AND zbpc_sgmt='INDUSTRY' \n            ) AS T1\n      LEFT  JOIN TG ON T1.zbpc_geo = TG.base_id where T1.zbpc_geo is not null\n      )AS T2\nLEFT SEMI JOIN TC ON T2.zbpc_lays = TC.base_id \nGROUP BY zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, parent_id_1\n)\n\ninsert overwrite table proj_tx_kpi_prd.medion_pc_bounty_Fact_Geo \n\nSELECT case when parent_id_1 ='PRCG' then 'PRC'\n          when parent_id_1 ='AP'   then 'AP'\n          when parent_id_1 ='EMEANEW' then 'EMEA'\n          when parent_id_1 ='NAG'     then 'NA'\n          when parent_id_1 ='LAR'     then 'LA'\n          when parent_id_1 ='HQ'      then 'HQ'\n          when parent_id_1 ='WW2013'      then 'WW2013'\n        end  as geo\n,upper(zbpc_time) as zbpc_time\n,zbpc_pgrp\n,'<Exclude> Medion PC Bounty' as kpi_name\n,'PCSD' as BU\n,'A' as data_type\n,'Non_device' as business_type\n,SUM(zbpc_data) AS zbpc_data\nFROM T where SUBSTR(upper(zbpc_time),-3,3) <>'INP' and SUBSTR(upper(zbpc_time),1,4) <>'2015'\n--where zbpc_time='2018.APR'\nGROUP BY parent_id_1,upper(zbpc_time),zbpc_pgrp \nORDER BY upper(zbpc_time),zbpc_pgrp DESC",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288707_0_0_data_5",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/medion_pc_bounty_fact_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/medion_pc_bounty_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:38:00",
          "job_end_time": "2019-05-22 12:38:43",
          "job_start_unix_time": 1558499880,
          "job_end_unix_time": 1558499923,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288707,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "medion_pc_bounty_fact_geo",
          "sqlText": null,
          "datasetId": 4655948,
          "srl_no": "5",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288690_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:t_transformation_all_emerging_Fact_Geo/T_Transformation_is_Emerging_Fact_Geo",
          "job_name": "T_Transformation_is_Emerging_Fact_Geo",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:37:59",
          "job_end_time": "2019-05-22 12:38:21",
          "job_start_unix_time": 1558499879,
          "job_end_unix_time": 1558499901,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288690,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16219",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "--------Emerging dcg licg: is Basemember\nWITH TG AS\n(SELECT base_id\n       ,parent_id as parent_id_1\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='GEOGRAPHY' AND tree='PARENTH1' AND parent_id in('WW2013','PRCG','AP','EMEANEW','NAG','LAR','HQ')\n),TC AS\n(SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='LAYERS' AND tree='PARENTH1' AND parent_id='ALLLAYERS'\n)\n, T AS ( \nSELECT zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, BU\n, kpi_name\n, parent_id_1\n, SUM(zbpc_data) AS zbpc_data\n, MAX(update_timestamp) AS update_timestamp\nFROM (  SELECT  *\n             ,TG.parent_id_1\n             , CASE WHEN zbpc_pgrp in('MVNO','VCS','ECSHQ','LNNL') then 'LCIG'\n                    else 'DCG'\n                    END BU\n             , CASE WHEN zbpc_chan ='TOTCHANNEL' AND zbpc_pgrp='NW' THEN 'Network (k)'                    \n                    WHEN zbpc_chan ='CONV' AND zbpc_pgrp='NW' THEN 'Networking in Converged (l)'\n                    \n                    when zbpc_chan='TOTCHANNEL' and zbpc_pgrp='MVNO' then 'Smart Glasses'\n                    when zbpc_chan='TOTCHANNEL' and zbpc_pgrp='VCS' then 'Smart Healthcare'\n                    when zbpc_chan='TOTCHANNEL' and zbpc_pgrp='ECSHQ' then 'ECS Others'\n                    when zbpc_chan='TOTCHANNEL' and zbpc_pgrp='LNNL' then 'Online Authentication'\n                    END kpi_name   \n        FROM `cdl_finance`.`bw_fin_coobps02l_cdl` AS F\n        LEFT  JOIN TG ON F.zbpc_geo = TG.base_id\n        WHERE zbpc_acct='TOTREV'  and F.zbpc_geo is not null\n        AND zbpc_case=CASE WHEN UPPER(zbpc_time) in ('2016.APR','2016.MAY','2016.JUN','2016.JUL','2016.AUG','2016.SEP','2016.OCT','2016.NOV','2016.DEC','2017.JAN','2017.FEB','2017.MAR') THEN 'RACT'\n                                WHEN UPPER(zbpc_time) in ('2017.APR','2017.MAY','2017.JUN','2017.JUL','2017.AUG','2017.SEP','2017.OCT','2017.NOV','2017.DEC','2018.JAN','2018.FEB','2018.MAR') THEN 'RACT'\n                                  ELSE\n                                     \tCASE WHEN UPPER(zbpc_time) LIKE '%.MAR' OR UPPER(zbpc_time) LIKE '%.JUN' OR UPPER(zbpc_time) LIKE '%.SEP' OR UPPER(zbpc_time) LIKE '%.DEC' \n                                     \t\t\t THEN 'ACTQ'\n                                     \t\tELSE 'ACT' END\n                                     END    \n        AND zbpc_chan IN ('TOTCHANNEL','CONV')\n        AND zbpc_sgmt='INDUSTRY' \n        AND zbpc_pgrp IN ('NW','MVNO','VCS','ECSHQ','LNNL')\n      ) AS T1\nLEFT SEMI JOIN TC ON T1.zbpc_lays = TC.base_id \nGROUP BY zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, BU\n, kpi_name\n, parent_id_1\n)\n\ninsert overwrite table proj_tx_kpi_prd.T_Transformation_is_Emerging_Fact_Geo\nSELECT\ncase when parent_id_1 ='PRCG' then 'PRC'\n          when parent_id_1 ='AP'   then 'AP'\n          when parent_id_1 ='EMEANEW' then 'EMEA'\n          when parent_id_1 ='NAG'     then 'NA'\n          when parent_id_1 ='LAR'     then 'LA'\n          when parent_id_1 ='HQ'      then 'HQ'\n          when parent_id_1 ='WW2013'      then 'WW2013'\n        end  as geo\n     , upper(zbpc_time) as zbpc_time\n     , zbpc_pgrp\n     , kpi_name\n     , BU\n     ,'A' as data_type\n     ,'Emerging' as business_type\n     , SUM(zbpc_data) AS zbpc_data\nFROM T where SUBSTR(upper(zbpc_time),-3,3) <>'INP' and SUBSTR(upper(zbpc_time),1,4) <>'2015'\nGROUP BY parent_id_1,upper(zbpc_time), zbpc_pgrp, kpi_name, BU\nORDER BY upper(zbpc_time), zbpc_pgrp, kpi_name, BU DESC",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288690_0_0_data_3",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_is_emerging_fact_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_is_emerging_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:37:59",
          "job_end_time": "2019-05-22 12:38:21",
          "job_start_unix_time": 1558499879,
          "job_end_unix_time": 1558499901,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288690,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_is_emerging_fact_geo",
          "sqlText": null,
          "datasetId": 4656032,
          "srl_no": "3",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20270235_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Group_Total_Revenue/union_all",
          "job_name": "union_all",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 05:41:01",
          "job_end_time": "2019-05-22 05:43:34",
          "job_start_unix_time": 1558474861,
          "job_end_unix_time": 1558475014,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20270235,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "14510",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "-- Services - Lenovo PC --9.5\n\nWITH TP AS \n( SELECT base_id\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='PRODGROUP' AND tree ='PARENTH5' AND parent_id='ECS'\n),\n\n\nTG AS\n(SELECT base_id\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='GEOGRAPHY' AND tree='PARENTH1' AND parent_id='WW2013'\n),\n\n\nTC AS\n(SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='LAYERS' AND tree='PARENTH1' AND parent_id='ALLLAYERS'\n)\n, \n\nT AS ( \nSELECT zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, SUM(zbpc_data) AS zbpc_data\n, MAX(update_timestamp) AS update_timestamp\nFROM (SELECT *\n      FROM (SELECT *\n            FROM `cdl_finance`.`bw_fin_coobps02l_cdl` AS F\n            LEFT SEMI JOIN TP ON F.zbpc_pgrp=TP.base_id\n            WHERE zbpc_acct='TOTREV' AND \n            zbpc_case=CASE WHEN UPPER(zbpc_time) in ('2016.APR','2016.MAY','2016.JUN','2016.JUL','2016.AUG','2016.SEP','2016.OCT','2016.NOV','2016.DEC','2017.JAN','2017.FEB','2017.MAR') THEN 'RACT'\n                                WHEN UPPER(zbpc_time) in ('2017.APR','2017.MAY','2017.JUN','2017.JUL','2017.AUG','2017.SEP','2017.OCT','2017.NOV','2017.DEC','2018.JAN','2018.FEB','2018.MAR') THEN 'RACT'\n                                  ELSE\n                                     \tCASE WHEN UPPER(zbpc_time) LIKE '%.MAR' OR UPPER(zbpc_time) LIKE '%.JUN' OR UPPER(zbpc_time) LIKE '%.SEP' OR UPPER(zbpc_time) LIKE '%.DEC' \n                                     \t\t\t THEN 'ACTQ'\n                                     \t\tELSE 'ACT' END\n                                     END    \n             AND zbpc_chan='TOTCHANNEL' AND zbpc_sgmt='INDUSTRY' \n            ) AS T1\n      LEFT SEMI JOIN TG ON T1.zbpc_geo = TG.base_id\n      )AS T2\nLEFT SEMI JOIN TC ON T2.zbpc_lays = TC.base_id \nGROUP BY zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n)\n\ninsert OVERWRITE table  proj_tx_kpi_prd.T_Transformation_BG_Total_Revenue_LCIG\n\nSELECT zbpc_time,'LCIG Total Revenue' as kpi_layer1,'LCIG' as bg ,SUM(zbpc_data) AS zbpc_data\nFROM T  where SUBSTR(upper(zbpc_time),-3,3) <>'INP' and SUBSTR(upper(zbpc_time),1,4) <>'2015'\ngroup by zbpc_time\norder by zbpc_time\n",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20270235_0_0_data_3",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_bg_total_revenue_lcig",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_bg_total_revenue_lcig",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 05:41:01",
          "job_end_time": "2019-05-22 05:43:34",
          "job_start_unix_time": 1558474861,
          "job_end_unix_time": 1558475014,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20270235,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_bg_total_revenue_lcig",
          "sqlText": null,
          "datasetId": 4655980,
          "srl_no": "3",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288709_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Non_device_and_Emerging_Revenue_all_PCSD_Fact_Geo/T_Transformation_Non_device_Revenue_get_PCSD_Fact_Geo",
          "job_name": "T_Transformation_Non_device_Revenue_get_PCSD_Fact_Geo",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:39:57",
          "job_end_time": "2019-05-22 12:40:21",
          "job_start_unix_time": 1558499997,
          "job_end_unix_time": 1558500021,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288709,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16226",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "--pcsd_no_device_get\nWITH TP AS \n( SELECT  base_id\n        , CASE WHEN parent_id='LPVI' AND tree ='PARENTH9' THEN 'Services - Lenovo PC'\n               WHEN parent_id='LPVT' AND tree ='PARENTH9' THEN 'Services - Think PC'           \n               WHEN parent_id='LPPSESVT' AND tree ='PARENTH9' THEN 'Services - Smart Solution'\n               WHEN parent_id='LPVNEC' AND tree ='PARENTH9' THEN 'Service -NEC Maintenance and Upsell'\n               WHEN parent_id='LPIOTS' AND tree ='PARENTH5' THEN 'IoT Content Services'\n               WHEN parent_id='WEMPC' AND tree ='PARENTH8' THEN 'Windows E&M'\n               WHEN parent_id='LPPSESWT' AND tree ='PARENTH8' THEN 'Solution Software'\n               END AS kpi_name\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='PRODGROUP' \nAND tree IN ('PARENTH9','PARENTH8','PARENTH5') \n----------AND tree IN ('PARENTH3','PARENTH5','PARENTH6','PARENTH7','PARENTH8','PARENTH9')\nAND parent_id IN ('LPVI','LPVT','LPPSESVT','LPVNEC','LPIOTS','WEMPC','LPPSESWT')\n)\n,TG AS\n(SELECT base_id\n        ,parent_id as parent_id_1\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='GEOGRAPHY' AND tree='PARENTH1' AND parent_id in('WW2013','PRCG','AP','EMEANEW','NAG','LAR','HQ')\n)\n,TC AS\n(SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='LAYERS' AND tree='PARENTH1' AND parent_id='ALLLAYERS'\n)\n, T AS ( \nSELECT zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, parent_id_1\n, SUM(zbpc_data) AS zbpc_data\n, MAX(update_timestamp) AS update_timestamp\nFROM (SELECT TG.parent_id_1,*\n      FROM (SELECT *\n            FROM `cdl_finance`.`bw_fin_coobps02l_cdl` AS F\n            LEFT OUTER JOIN TP ON F.zbpc_pgrp=TP.base_id\n            WHERE zbpc_acct='TOTREV' \n            AND zbpc_case=CASE WHEN UPPER(zbpc_time) in ('2016.APR','2016.MAY','2016.JUN','2016.JUL','2016.AUG','2016.SEP','2016.OCT','2016.NOV','2016.DEC','2017.JAN','2017.FEB','2017.MAR') THEN 'RACT'\n                                WHEN UPPER(zbpc_time) in ('2017.APR','2017.MAY','2017.JUN','2017.JUL','2017.AUG','2017.SEP','2017.OCT','2017.NOV','2017.DEC','2018.JAN','2018.FEB','2018.MAR') THEN 'RACT'\n                                  ELSE\n                                     \tCASE WHEN UPPER(zbpc_time) LIKE '%.MAR' OR UPPER(zbpc_time) LIKE '%.JUN' OR UPPER(zbpc_time) LIKE '%.SEP' OR UPPER(zbpc_time) LIKE '%.DEC' \n                                     \t\t\t THEN 'ACTQ'\n                                     \t\tELSE 'ACT' END\n                                     END    \n            AND zbpc_chan='TOTCHANNEL' \n            AND zbpc_sgmt='INDUSTRY' \n            AND kpi_name IS NOT NULL\n            ) AS T1\n      LEFT  JOIN TG ON T1.zbpc_geo = TG.base_id where T1.zbpc_geo is not null\n      )AS T2\nLEFT SEMI JOIN TC ON T2.zbpc_lays = TC.base_id \nGROUP BY zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, parent_id_1\n)\n\n\ninsert overwrite table proj_tx_kpi_prd.T_Transformation_Non_device_Revenue_get_PCSD_Fact_Geo\nSELECT \n case when parent_id_1 ='PRCG' then 'PRC'\n          when parent_id_1 ='AP'   then 'AP'\n          when parent_id_1 ='EMEANEW' then 'EMEA'\n          when parent_id_1 ='NAG'     then 'NA'\n          when parent_id_1 ='LAR'     then 'LA'\n          when parent_id_1 ='HQ'      then 'HQ'\n          when parent_id_1 ='WW2013'      then 'WW2013'\n        end  as geo\n    ,upper(zbpc_time) as zbpc_time\n    , zbpc_pgrp\n    , kpi_name\n    , 'PCSD' BU\n    ,'A' as data_type\n    ,'Non_device' as business_type\n    , SUM(zbpc_data) AS zbpc_data\nFROM T where SUBSTR(upper(zbpc_time),-3,3) <>'INP' and SUBSTR(upper(zbpc_time),1,4) <>'2015'\n--where zbpc_time='2018.APR'\nGROUP BY parent_id_1,upper(zbpc_time),zbpc_pgrp, kpi_name \nORDER BY upper(zbpc_time),zbpc_pgrp, kpi_name DESC",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288709_0_0_data_3",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_non_device_revenue_get_pcsd_fact_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_non_device_revenue_get_pcsd_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:39:57",
          "job_end_time": "2019-05-22 12:40:21",
          "job_start_unix_time": 1558499997,
          "job_end_unix_time": 1558500021,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288709,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_non_device_revenue_get_pcsd_fact_geo",
          "sqlText": null,
          "datasetId": 4656061,
          "srl_no": "3",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288694_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Non_device_Revenue_all_DCG_Fact_Geo/T_Transformation_Non_device_Revenue_get_TOTCHANNEL_DCG_Fact_Geo",
          "job_name": "T_Transformation_Non_device_Revenue_get_TOTCHANNEL_DCG_Fact_Geo",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:36:45",
          "job_end_time": "2019-05-22 12:37:59",
          "job_start_unix_time": 1558499805,
          "job_end_unix_time": 1558499879,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288694,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16220",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "--------DCG Non-device Revenue get Basemember TOTCHANNEL\nWITH TP AS \n( SELECT  base_id\n        , CASE WHEN parent_id='LPEMS' AND tree ='PARENTH9' THEN 'Maintenance Services'\n               WHEN parent_id='LPPM' AND tree ='PARENTH9' THEN 'Professional/Managed Services'           \n               WHEN parent_id='EMDS' AND tree ='PARENTH8' THEN 'Software licenses (with Overlap)(a)'\n               END AS kpi_name\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='PRODGROUP' \nAND tree IN ('PARENTH9','PARENTH8') \n----------AND tree IN ('PARENTH3','PARENTH5','PARENTH6','PARENTH7','PARENTH8','PARENTH9')\nAND parent_id IN ('LPEMS','LPPM','EMDS')\n)\n,TG AS\n(SELECT base_id\n        ,parent_id as parent_id_1\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='GEOGRAPHY' AND tree='PARENTH1' AND parent_id in('WW2013','PRCG','AP','EMEANEW','NAG','LAR','HQ')\n)\n,TC AS\n(SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='LAYERS' AND tree='PARENTH1' AND parent_id='ALLLAYERS'\n)\n, T AS ( \nSELECT zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, parent_id_1\n, SUM(zbpc_data) AS zbpc_data\n, MAX(update_timestamp) AS update_timestamp\nFROM (SELECT TG.parent_id_1,*\n      FROM (SELECT *\n            FROM `cdl_finance`.`bw_fin_coobps02l_cdl` AS F\n            LEFT OUTER JOIN TP ON F.zbpc_pgrp=TP.base_id\n            WHERE zbpc_acct='TOTREV' \n            AND zbpc_case= CASE WHEN UPPER(zbpc_time) in ('2016.APR','2016.MAY','2016.JUN','2016.JUL','2016.AUG','2016.SEP','2016.OCT','2016.NOV','2016.DEC','2017.JAN','2017.FEB','2017.MAR') THEN 'RACT'\n                                WHEN UPPER(zbpc_time) in ('2017.APR','2017.MAY','2017.JUN','2017.JUL','2017.AUG','2017.SEP','2017.OCT','2017.NOV','2017.DEC','2018.JAN','2018.FEB','2018.MAR') THEN 'RACT'\n                              ELSE CASE WHEN UPPER(zbpc_time) LIKE '%.MAR' OR UPPER(zbpc_time) LIKE '%.JUN' OR UPPER(zbpc_time) LIKE '%.SEP' OR UPPER(zbpc_time) LIKE '%.DEC' \n                                             THEN 'ACTQ'  \n                                              ELSE 'ACT' END                                    \n                                     END    \n            AND zbpc_chan='TOTCHANNEL' \n            AND zbpc_sgmt='INDUSTRY' \n            AND kpi_name IS NOT NULL\n            ) AS T1\n      LEFT  JOIN TG ON T1.zbpc_geo = TG.base_id where T1.zbpc_geo is not null\n      )AS T2\nLEFT SEMI JOIN TC ON T2.zbpc_lays = TC.base_id \nGROUP BY zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, parent_id_1\n)\n\n\ninsert overwrite table proj_tx_kpi_prd.T_Transformation_Non_device_Revenue_get_TOTCHANNEL_DCG_Fact_Geo\nSELECT case when parent_id_1 ='PRCG' then 'PRC'\n          when parent_id_1 ='AP'   then 'AP'\n          when parent_id_1 ='EMEANEW' then 'EMEA'\n          when parent_id_1 ='NAG'     then 'NA'\n          when parent_id_1 ='LAR'     then 'LA'\n          when parent_id_1 ='HQ'      then 'HQ'\n          when parent_id_1 ='WW2013'      then 'WW2013'\n        end  as geo\n     ,upper(zbpc_time) as zbpc_time\n     , zbpc_pgrp\n     , kpi_name\n     , 'DCG' BU\n     , 'A'  data_type\n     , 'Non_device' as business_type\n     , SUM(zbpc_data) AS zbpc_data\nFROM T where SUBSTR(upper(zbpc_time),-3,3) <>'INP'\n--where zbpc_time='2018.APR'\nGROUP BY parent_id_1,upper(zbpc_time), kpi_name, zbpc_pgrp\nORDER BY upper(zbpc_time), kpi_name, zbpc_pgrp DESC",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288694_0_0_data_3",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_non_device_revenue_get_totchannel_dcg_fact_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_non_device_revenue_get_totchannel_dcg_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:36:45",
          "job_end_time": "2019-05-22 12:37:59",
          "job_start_unix_time": 1558499805,
          "job_end_unix_time": 1558499879,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288694,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_non_device_revenue_get_totchannel_dcg_fact_geo",
          "sqlText": null,
          "datasetId": 4656065,
          "srl_no": "3",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288703_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Non_device_Revenue_MBG_Fact_Geo/T_Transformation_Non_device_Revenue_MBG_Middle_Fact_Geo",
          "job_name": "T_Transformation_Non_device_Revenue_MBG_Middle_Fact_Geo",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:38:49",
          "job_end_time": "2019-05-22 12:39:23",
          "job_start_unix_time": 1558499929,
          "job_end_unix_time": 1558499963,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288703,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16222",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "--MBG no device Revenue\n\nWITH TG AS\n(SELECT base_id\n        ,parent_id as parent_id_1\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='GEOGRAPHY' AND tree='PARENTH1' AND parent_id in('WW2013','PRCG','AP','EMEANEW','NAG','LAR','HQ')\n),TC AS\n(SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='LAYERS' AND tree='PARENTH1' AND parent_id='ALLLAYERS'\n)\n, T AS ( \nSELECT zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, BU\n, kpi_name\n, parent_id_1\n, SUM(zbpc_data) AS zbpc_data\n, MAX(update_timestamp) AS update_timestamp\nFROM (  SELECT *\n              ,TG.parent_id_1\n              , 'MBG' AS BU\n              , case when zbpc_chan ='TOTCHANNEL' and zbpc_pgrp='LRRPS' then 'Smart Phone Services (PRC) - Lenovo'\n              \t\t\t when zbpc_chan ='TOTCHANNEL' and zbpc_pgrp='LROPS' then 'Smart Phone Services (ROW) - Lenovo'\n              \t\t\t when zbpc_chan ='TOTCHANNEL' and zbpc_pgrp='SQSPV' then 'Smart Phone Shenqi  - Services'\n              \t\t\t when zbpc_chan ='TOTCHANNEL' and zbpc_pgrp='LRMPOT' then 'Moto Services'\n              \t\t\t when zbpc_chan ='TOTCHANNEL' and zbpc_pgrp='LROT' then 'Trademark'\n              \t\t\t when zbpc_chan ='TOTCHANNEL' and zbpc_pgrp='LRMPL' then 'Brand and Tech Licensing'\n              \t\t\t when zbpc_chan ='TOTCHANNEL' and zbpc_pgrp='LPSWB' then 'Android Gaming Software'\n              \t\t\t when zbpc_chan ='TOTCHANNEL' and zbpc_pgrp='LRLWA' then 'LeStore Software'\n              \t\t\t when zbpc_chan ='TOTCHANNEL' and zbpc_pgrp='LRMPR' then 'Royalty'\n              \t\t\t \n              \t\t\t \n              \t\t\tend as kpi_name\n                 FROM `cdl_finance`.`bw_fin_coobps02l_cdl` AS F\n                 LEFT  JOIN TG ON F.zbpc_geo = TG.base_id\n                 WHERE zbpc_acct='TOTREV'  and F.zbpc_geo is not null\n                 AND zbpc_case=CASE WHEN UPPER(zbpc_time) in ('2016.APR','2016.MAY','2016.JUN','2016.JUL','2016.AUG','2016.SEP','2016.OCT','2016.NOV','2016.DEC','2017.JAN','2017.FEB','2017.MAR') THEN 'RACT'\n                                WHEN UPPER(zbpc_time) in ('2017.APR','2017.MAY','2017.JUN','2017.JUL','2017.AUG','2017.SEP','2017.OCT','2017.NOV','2017.DEC','2018.JAN','2018.FEB','2018.MAR') THEN 'RACT'\n                                  ELSE\n                                     \tCASE WHEN UPPER(zbpc_time) LIKE '%.MAR' OR UPPER(zbpc_time) LIKE '%.JUN' OR UPPER(zbpc_time) LIKE '%.SEP' OR UPPER(zbpc_time) LIKE '%.DEC' \n                                     \t\t\t THEN 'ACTQ'\n                                     \t\tELSE 'ACT' END\n                                     END  \n                 AND zbpc_chan='TOTCHANNEL' \n                 AND zbpc_sgmt='INDUSTRY' \n                 AND zbpc_pgrp in ('LRRPS','LROPS','SQSPV','LRMPOT','LROT','LRMPL','LPSWB','LRLWA','LRMPR')\n      ) AS T1\nLEFT SEMI JOIN TC ON T1.zbpc_lays = TC.base_id \nGROUP BY zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, BU\n, kpi_name\n,parent_id_1\n)\n\ninsert overwrite table proj_tx_kpi_prd.T_Transformation_Non_device_Revenue_MBG_Middle_Fact_Geo \n\nSELECT case when parent_id_1 ='PRCG' then 'PRC'\n          when parent_id_1 ='AP'   then 'AP'\n          when parent_id_1 ='EMEANEW' then 'EMEA'\n          when parent_id_1 ='NAG'     then 'NA'\n          when parent_id_1 ='LAR'     then 'LA'\n          when parent_id_1 ='HQ'      then 'HQ'\n          when parent_id_1 ='WW2013'      then 'WW2013'\n        end  as geo\n     ,upper(zbpc_time) as zbpc_time\n     ,zbpc_pgrp\n     ,kpi_name\n     ,BU\n     ,'A' as data_type\n     ,'Non_device' as business_type\n     , SUM(zbpc_data) AS zbpc_data\nFROM T where SUBSTR(upper(zbpc_time),-3,3) <>'INP' and SUBSTR(upper(zbpc_time),1,4) <>'2015'\n--where zbpc_time='2018.APR'\nGROUP BY parent_id_1,upper(zbpc_time),zbpc_pgrp,kpi_name,BU \nORDER BY upper(zbpc_time),zbpc_pgrp,kpi_name, BU DESC",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288703_0_0_data_5",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_non_device_revenue_mbg_middle_fact_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_non_device_revenue_mbg_middle_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:38:49",
          "job_end_time": "2019-05-22 12:39:23",
          "job_start_unix_time": 1558499929,
          "job_end_unix_time": 1558499963,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288703,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_non_device_revenue_mbg_middle_fact_geo",
          "sqlText": null,
          "datasetId": 4656085,
          "srl_no": "5",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288710_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Non_device_and_Emerging_Revenue_all_PCSD_Fact_Geo/T_Transformation_Non_device_Revenue_is_PCSD_Fact_Geo",
          "job_name": "T_Transformation_Non_device_Revenue_is_PCSD_Fact_Geo",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:40:21",
          "job_end_time": "2019-05-22 12:41:20",
          "job_start_unix_time": 1558500021,
          "job_end_unix_time": 1558500080,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288710,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16226",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "--pcsd_no_device_is\n\nWITH TG AS\n(SELECT base_id\n        ,parent_id as parent_id_1\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='GEOGRAPHY' AND tree='PARENTH1' AND parent_id  in('WW2013','PRCG','AP','EMEANEW','NAG','LAR','HQ')\n),TC AS\n(SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='LAYERS' AND tree='PARENTH1' AND parent_id='ALLLAYERS'\n)\n, T AS ( \nSELECT zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, BU\n, kpi_name\n, parent_id_1\n, SUM(zbpc_data) AS zbpc_data\n, MAX(update_timestamp) AS update_timestamp\nFROM (  SELECT *\n              , TG.parent_id_1\n              , 'PCSD' AS BU\n              , case when zbpc_pgrp='LPCBV' AND zbpc_chan ='TOTCHANNEL' THEN 'Services - Chromebook'\n              \t\t\t when zbpc_pgrp='LPVPT' AND zbpc_chan ='TOTCHANNEL' THEN 'Service - PC Top' \n              \t\t\t when zbpc_pgrp='LRTBV' AND zbpc_chan ='TOTCHANNEL' THEN 'Services - Tablet'\n              \t\t\t when zbpc_pgrp='LPVO' AND zbpc_chan ='TOTCHANNEL' THEN 'Services - Sunny'\n              end AS kpi_name   \n              \n              \n                 FROM `cdl_finance`.`bw_fin_coobps02l_cdl` AS F\n                 LEFT  JOIN TG ON F.zbpc_geo = TG.base_id\n                 WHERE zbpc_acct='TOTREV'  and F.zbpc_geo is not null\n                 AND zbpc_case=CASE WHEN UPPER(zbpc_time) in ('2016.APR','2016.MAY','2016.JUN','2016.JUL','2016.AUG','2016.SEP','2016.OCT','2016.NOV','2016.DEC','2017.JAN','2017.FEB','2017.MAR') THEN 'RACT'\n                                WHEN UPPER(zbpc_time) in ('2017.APR','2017.MAY','2017.JUN','2017.JUL','2017.AUG','2017.SEP','2017.OCT','2017.NOV','2017.DEC','2018.JAN','2018.FEB','2018.MAR') THEN 'RACT'\n                                  ELSE\n                                     \tCASE WHEN UPPER(zbpc_time) LIKE '%.MAR' OR UPPER(zbpc_time) LIKE '%.JUN' OR UPPER(zbpc_time) LIKE '%.SEP' OR UPPER(zbpc_time) LIKE '%.DEC' \n                                     \t\t\t THEN 'ACTQ'\n                                     \t\tELSE 'ACT' END\n                                     END  \n                 AND zbpc_chan='TOTCHANNEL' \n                 AND zbpc_sgmt='INDUSTRY' \n                 AND zbpc_pgrp in('LPCBV','LPVPT','LRTBV','LPVO')\n      ) AS T1\nLEFT SEMI JOIN TC ON T1.zbpc_lays = TC.base_id \nGROUP BY zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, BU\n, kpi_name\n, parent_id_1\n)\n\ninsert overwrite table proj_tx_kpi_prd.T_Transformation_Non_device_Revenue_is_PCSD_Fact_Geo \n\nSELECT \ncase when parent_id_1 ='PRCG' then 'PRC'\n          when parent_id_1 ='AP'   then 'AP'\n          when parent_id_1 ='EMEANEW' then 'EMEA'\n          when parent_id_1 ='NAG'     then 'NA'\n          when parent_id_1 ='LAR'     then 'LA'\n          when parent_id_1 ='HQ'      then 'HQ'\n          when parent_id_1 ='WW2013'      then 'WW2013'\n        end  as geo\n     ,upper(zbpc_time) as zbpc_time\n     ,zbpc_pgrp\n     , kpi_name\n     , BU    --zbpc_pgrp\n     ,'A' as data_type\n     ,'Non_device' as business_type\n     , SUM(zbpc_data) AS zbpc_data\nFROM T where SUBSTR(upper(zbpc_time),-3,3) <>'INP' and SUBSTR(upper(zbpc_time),1,4) <>'2015'\n--where zbpc_time='2018.APR'\nGROUP BY parent_id_1,upper(zbpc_time),zbpc_pgrp,kpi_name, BU   --zbpc_pgrp\nORDER BY upper(zbpc_time),zbpc_pgrp,kpi_name, BU DESC  --zbpc_pgrp",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288710_0_0_data_5",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_non_device_revenue_is_pcsd_fact_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_non_device_revenue_is_pcsd_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:40:21",
          "job_end_time": "2019-05-22 12:41:20",
          "job_start_unix_time": 1558500021,
          "job_end_unix_time": 1558500080,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288710,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_non_device_revenue_is_pcsd_fact_geo",
          "sqlText": null,
          "datasetId": 4656073,
          "srl_no": "5",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288695_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Non_device_Revenue_all_DCG_Fact_Geo/T_Transformation_Non_device_Revenue_is_DCG_Fact_Geo",
          "job_name": "T_Transformation_Non_device_Revenue_is_DCG_Fact_Geo",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:37:59",
          "job_end_time": "2019-05-22 12:38:49",
          "job_start_unix_time": 1558499879,
          "job_end_unix_time": 1558499929,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288695,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16220",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "--------DCG Non-device Revenue is Basemember\nWITH TG AS\n(SELECT base_id\n        ,parent_id as parent_id_1\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='GEOGRAPHY' AND tree='PARENTH1' AND parent_id in('WW2013','PRCG','AP','EMEANEW','NAG','LAR','HQ')\n),TC AS\n(SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='LAYERS' AND tree='PARENTH1' AND parent_id='ALLLAYERS'\n)\n, T AS ( \nSELECT zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, BU\n, kpi_name\n, parent_id_1\n, SUM(zbpc_data) AS zbpc_data\n, MAX(update_timestamp) AS update_timestamp\nFROM (  SELECT *\n              , TG.parent_id_1\n              , 'DCG' AS BU\n              , 'Cloud' AS kpi_name   \n                 FROM `cdl_finance`.`bw_fin_coobps02l_cdl` AS F\n                 LEFT  JOIN TG ON F.zbpc_geo = TG.base_id \n                 WHERE zbpc_acct='TOTREV'  and F.zbpc_geo is not null\n                 AND zbpc_case= CASE WHEN UPPER(zbpc_time) in ('2016.APR','2016.MAY','2016.JUN','2016.JUL','2016.AUG','2016.SEP','2016.OCT','2016.NOV','2016.DEC','2017.JAN','2017.FEB','2017.MAR') THEN 'RACT'\n                                WHEN UPPER(zbpc_time) in ('2017.APR','2017.MAY','2017.JUN','2017.JUL','2017.AUG','2017.SEP','2017.OCT','2017.NOV','2017.DEC','2018.JAN','2018.FEB','2018.MAR') THEN 'RACT'\n                              ELSE CASE WHEN UPPER(zbpc_time) LIKE '%.MAR' OR UPPER(zbpc_time) LIKE '%.JUN' OR UPPER(zbpc_time) LIKE '%.SEP' OR UPPER(zbpc_time) LIKE '%.DEC' \n                                             THEN 'ACTQ'  \n                                              ELSE 'ACT' END                                    \n                                     END     \n                 AND zbpc_chan='TOTCHANNEL' \n                 AND zbpc_sgmt='INDUSTRY' \n                 AND zbpc_pgrp='LPCS'\n      ) AS T1\nLEFT SEMI JOIN TC ON T1.zbpc_lays = TC.base_id \nGROUP BY zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, BU\n, kpi_name\n, parent_id_1\n)\n\ninsert overwrite table proj_tx_kpi_prd.T_Transformation_Non_device_Revenue_is_DCG_Fact_Geo \n\nSELECT \n case when parent_id_1 ='PRCG' then 'PRC'\n          when parent_id_1 ='AP'   then 'AP'\n          when parent_id_1 ='EMEANEW' then 'EMEA'\n          when parent_id_1 ='NAG'     then 'NA'\n          when parent_id_1 ='LAR'     then 'LA'\n          when parent_id_1 ='HQ'      then 'HQ'\n          when parent_id_1 ='WW2013'      then 'WW2013'\n        end  as geo\n     ,upper(zbpc_time) as zbpc_time\n     , zbpc_pgrp\n     , kpi_name\n     , BU\n     , 'A'  data_type\n     , 'Non_device' as business_type\n     , SUM(zbpc_data) AS zbpc_data\nFROM T\nwhere SUBSTR(upper(zbpc_time),-3,3) <>'INP'\nGROUP BY parent_id_1,upper(zbpc_time), zbpc_pgrp, kpi_name, BU\nORDER BY upper(zbpc_time), zbpc_pgrp, kpi_name, BU DESC",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288695_0_0_data_5",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_non_device_revenue_is_dcg_fact_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_non_device_revenue_is_dcg_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:37:59",
          "job_end_time": "2019-05-22 12:38:49",
          "job_start_unix_time": 1558499879,
          "job_end_unix_time": 1558499929,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288695,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_non_device_revenue_is_dcg_fact_geo",
          "sqlText": null,
          "datasetId": 4656069,
          "srl_no": "5",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288711_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Non_device_and_Emerging_Revenue_all_PCSD_Fact_Geo/T_Transformation_pcsd_is_Emerging_Fact_Geo",
          "job_name": "T_Transformation_pcsd_is_Emerging_Fact_Geo",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:41:20",
          "job_end_time": "2019-05-22 12:41:59",
          "job_start_unix_time": 1558500080,
          "job_end_unix_time": 1558500119,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288711,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16226",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "--------Emerging Revenue: is Basemember\nWITH TG AS\n(SELECT base_id\n       ,parent_id as parent_id_1\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='GEOGRAPHY' AND tree='PARENTH1' AND parent_id in('WW2013','PRCG','AP','EMEANEW','NAG','LAR','HQ')\n),TC AS\n(SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='LAYERS' AND tree='PARENTH1' AND parent_id='ALLLAYERS'\n)\n, T AS ( \nSELECT zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, BU\n, kpi_name\n, parent_id_1\n, SUM(zbpc_data) AS zbpc_data\n, MAX(update_timestamp) AS update_timestamp\nFROM (  SELECT *\n             ,TG.parent_id_1\n             , CASE WHEN zbpc_pgrp IN ('LPARVRW','LPARVRV','LPSMOW','LPSMOV','LPSD','LPTVOT') THEN 'PCSD'\n                    END BU\n             , CASE WHEN zbpc_chan ='TOTCHANNEL' AND zbpc_pgrp='LPARVRW' THEN 'ARVR Software'\n                    WHEN zbpc_chan ='TOTCHANNEL' AND zbpc_pgrp='LPARVRV' THEN 'ARVR Services'\n                    WHEN zbpc_chan ='TOTCHANNEL' AND zbpc_pgrp='LPSMOW' THEN 'Smart Office Software'\n                    WHEN zbpc_chan ='TOTCHANNEL' AND zbpc_pgrp='LPSMOV' THEN 'Smart Office Services'\n                    WHEN zbpc_chan ='TOTCHANNEL' AND zbpc_pgrp='LPSD' THEN 'Smart Device'\n                    WHEN zbpc_chan ='TOTCHANNEL' AND zbpc_pgrp='LPTVOT' THEN 'TV' \n                    END kpi_name   \n        FROM `cdl_finance`.`bw_fin_coobps02l_cdl` AS F\n        LEFT  JOIN TG ON F.zbpc_geo = TG.base_id\n        WHERE zbpc_acct='TOTREV' and F.zbpc_geo is not null\n        AND zbpc_case=CASE WHEN UPPER(zbpc_time) in ('2016.APR','2016.MAY','2016.JUN','2016.JUL','2016.AUG','2016.SEP','2016.OCT','2016.NOV','2016.DEC','2017.JAN','2017.FEB','2017.MAR') THEN 'RACT'\n                                WHEN UPPER(zbpc_time) in ('2017.APR','2017.MAY','2017.JUN','2017.JUL','2017.AUG','2017.SEP','2017.OCT','2017.NOV','2017.DEC','2018.JAN','2018.FEB','2018.MAR') THEN 'RACT'\n                                  ELSE\n                                     \tCASE WHEN UPPER(zbpc_time) LIKE '%.MAR' OR UPPER(zbpc_time) LIKE '%.JUN' OR UPPER(zbpc_time) LIKE '%.SEP' OR UPPER(zbpc_time) LIKE '%.DEC' \n                                     \t\t\t THEN 'ACTQ'\n                                     \t\tELSE 'ACT' END\n                                     END  \n        AND zbpc_chan IN ('TOTCHANNEL')\n        AND zbpc_sgmt='INDUSTRY' \n        AND zbpc_pgrp IN ('LPARVRW','LPARVRV','LPSMOW','LPSMOV','LPSD','LPTVOT')\n      ) AS T1\nLEFT SEMI JOIN TC ON T1.zbpc_lays = TC.base_id \nGROUP BY zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, BU\n, kpi_name\n, parent_id_1\n)\n\ninsert overwrite table proj_tx_kpi_prd.T_Transformation_pcsd_is_Emerging_Fact_Geo\nSELECT \ncase when parent_id_1 ='PRCG' then 'PRC'\n          when parent_id_1 ='AP'   then 'AP'\n          when parent_id_1 ='EMEANEW' then 'EMEA'\n          when parent_id_1 ='NAG'     then 'NA'\n          when parent_id_1 ='LAR'     then 'LA'\n          when parent_id_1 ='HQ'      then 'HQ'\n          when parent_id_1 ='WW2013'      then 'WW2013'\n        end  as geo\n     ,upper(zbpc_time) as zbpc_time\n     , zbpc_pgrp\n     , kpi_name\n     , BU\n     ,'A' as data_type\n     ,'Emerging' as business_type\n     , SUM(zbpc_data) AS zbpc_data\nFROM T where SUBSTR(upper(zbpc_time),-3,3) <>'INP' and SUBSTR(upper(zbpc_time),1,4) <>'2015'\nGROUP BY parent_id_1,upper(zbpc_time), zbpc_pgrp, kpi_name, BU\nORDER BY upper(zbpc_time), zbpc_pgrp, kpi_name, BU DESC",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288711_0_0_data_5",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_pcsd_is_emerging_fact_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_pcsd_is_emerging_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:41:20",
          "job_end_time": "2019-05-22 12:41:59",
          "job_start_unix_time": 1558500080,
          "job_end_unix_time": 1558500119,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288711,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_pcsd_is_emerging_fact_geo",
          "sqlText": null,
          "datasetId": 4656111,
          "srl_no": "5",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288712_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Non_device_and_Emerging_Revenue_all_PCSD_Fact_Geo/T_Transformation_pcsd_get_Emerging_Fact_Geo",
          "job_name": "T_Transformation_pcsd_get_Emerging_Fact_Geo",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:41:59",
          "job_end_time": "2019-05-22 12:42:40",
          "job_start_unix_time": 1558500119,
          "job_end_unix_time": 1558500160,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288712,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16226",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "-- Emerging all get  \n--leap id 14504\nWITH TP AS \n( SELECT base_id\n       , CASE WHEN tree IN ('PARENTH5') AND parent_id='ARVR' THEN 'AR VR Total'\n              WHEN tree IN ('PARENTH5') AND parent_id='SMO' THEN 'Smart Office Total'\n              WHEN tree IN ('PARENTH5') AND parent_id='LPIOTHW' THEN 'IOT Hardware exclude TV'\n              END kpi_name\n       , CASE WHEN parent_id IN ('ARVR','SMO','LPIOTHW') THEN 'PCSD'  \n              END  BU\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='PRODGROUP' AND tree IN ('PARENTH5') \nAND parent_id IN ('ARVR','SMO','LPIOTHW') \n),TG AS\n(SELECT base_id\n        ,parent_id as parent_id_1\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='GEOGRAPHY' AND tree='PARENTH1' AND parent_id in('WW2013','PRCG','AP','EMEANEW','NAG','LAR','HQ')\n)\n,TC AS\n(SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='LAYERS' AND tree='PARENTH1' AND parent_id='ALLLAYERS'\n)\n, T AS (\nSELECT zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, BU\n, parent_id_1\n, SUM(zbpc_data) AS zbpc_data\n, MAX(update_timestamp) AS update_timestamp\nFROM (SELECT TG.parent_id_1,*\n      FROM ( SELECT *, TP.kpi_name, TP.BU\n             FROM `cdl_finance`.`bw_fin_coobps02l_cdl` AS F\n             LEFT OUTER JOIN TP ON F.zbpc_pgrp=TP.base_id\n             WHERE zbpc_acct='TOTREV' \n             AND zbpc_case=CASE WHEN UPPER(zbpc_time) in ('2016.APR','2016.MAY','2016.JUN','2016.JUL','2016.AUG','2016.SEP','2016.OCT','2016.NOV','2016.DEC','2017.JAN','2017.FEB','2017.MAR') THEN 'RACT'\n                                WHEN UPPER(zbpc_time) in ('2017.APR','2017.MAY','2017.JUN','2017.JUL','2017.AUG','2017.SEP','2017.OCT','2017.NOV','2017.DEC','2018.JAN','2018.FEB','2018.MAR') THEN 'RACT'\n                                  ELSE\n                                     \tCASE WHEN UPPER(zbpc_time) LIKE '%.MAR' OR UPPER(zbpc_time) LIKE '%.JUN' OR UPPER(zbpc_time) LIKE '%.SEP' OR UPPER(zbpc_time) LIKE '%.DEC' \n                                     \t\t\t THEN 'ACTQ'\n                                     \t\tELSE 'ACT' END\n                                     END \n             AND zbpc_chan='TOTCHANNEL' \n             AND zbpc_sgmt='INDUSTRY' \n             AND TP.kpi_name IS NOT NULL \n             AND TP.BU IS NOT NULL \n            ) AS T1\n      LEFT  JOIN TG ON T1.zbpc_geo = TG.base_id where T1.zbpc_geo is not null\n      ) AS T2\nLEFT SEMI JOIN TC ON T2.zbpc_lays = TC.base_id \nGROUP BY zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, BU\n, parent_id_1\n)\n\ninsert overwrite table proj_tx_kpi_prd.T_Transformation_pcsd_get_Emerging_Fact_Geo\nSELECT \ncase when parent_id_1 ='PRCG' then 'PRC'\n          when parent_id_1 ='AP'   then 'AP'\n          when parent_id_1 ='EMEANEW' then 'EMEA'\n          when parent_id_1 ='NAG'     then 'NA'\n          when parent_id_1 ='LAR'     then 'LA'\n          when parent_id_1 ='HQ'      then 'HQ'\n          when parent_id_1 ='WW2013'      then 'WW2013'\n        end  as geo\n     ,upper(zbpc_time) as zbpc_time\n     ,zbpc_pgrp\n     , kpi_name\n     , BU\n     ,'A' as data_type\n     ,'Emerging' as business_type\n     , SUM(zbpc_data) AS zbpc_data\nFROM T where SUBSTR(upper(zbpc_time),-3,3) <>'INP' and SUBSTR(upper(zbpc_time),1,4) <>'2015'\n--WHERE zbpc_time='2018.APR' \nGROUP BY parent_id_1,upper(zbpc_time), zbpc_pgrp,kpi_name, BU\nORDER BY upper(zbpc_time), zbpc_pgrp,kpi_name, BU DESC",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288712_0_0_data_3",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_pcsd_get_emerging_fact_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_pcsd_get_emerging_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:41:59",
          "job_end_time": "2019-05-22 12:42:40",
          "job_start_unix_time": 1558500119,
          "job_end_unix_time": 1558500160,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288712,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_pcsd_get_emerging_fact_geo",
          "sqlText": null,
          "datasetId": 4656107,
          "srl_no": "3",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288731_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Five_Part_PcServicePenRate_numerator/T_Transformation_Five_part_geo",
          "job_name": "T_Transformation_Five_part_geo",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:31:46",
          "job_end_time": "2019-05-22 12:32:12",
          "job_start_unix_time": 1558499506,
          "job_end_unix_time": 1558499532,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288731,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16358",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "--------分子\nWITH TP AS \n( SELECT  base_id, parent_id\n  FROM `dm_finance`.`bpc_fin_dim_hier_odl`\n  WHERE category='PRODGROUP' AND tree IN ('PARENTH6') AND parent_id ='PCSD'\n)\n,TG AS\n(SELECT base_id,parent_id as parent_id_1\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='GEOGRAPHY' AND tree='PARENTH1' AND parent_id in ('PRCG','NAG','LASR','EMEANEW','AP','HQ','WW2013')\n)\n\n, T AS ( \nSELECT zbpc_time\n,parent_id_1\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, SUM(zbpc_data) AS zbpc_data\n, MAX(update_timestamp) AS update_timestamp\nFROM (SELECT TG.parent_id_1, *  \n      FROM (SELECT *\n                 ,'PC Service Pen Rate Numerator' as kpi_name\n            FROM `cdl_finance`.`bw_fin_coobps02l_cdl` AS F\n            LEFT OUTER JOIN TP ON F.zbpc_pgrp=TP.base_id\n            WHERE zbpc_acct in ('REVTCV') \n            AND zbpc_case= CASE WHEN UPPER(zbpc_time) in ('2016.APR','2016.MAY','2016.JUN','2016.JUL','2016.AUG','2016.SEP','2016.OCT','2016.NOV','2016.DEC','2017.JAN','2017.FEB','2017.MAR') THEN 'RACT'\n                                     WHEN UPPER(zbpc_time) in ('2017.APR','2017.MAY','2017.JUN','2017.JUL','2017.AUG','2017.SEP','2017.OCT','2017.NOV','2017.DEC','2018.JAN','2018.FEB','2018.MAR') THEN 'RACT'\n                                     ELSE CASE WHEN UPPER(zbpc_time) LIKE '%.OCT' OR UPPER(zbpc_time) LIKE '%.NOV' OR UPPER(zbpc_time) LIKE '%.DEC' then 'ACT'\n                                     \t\t\tELSE 'RACT' END\n                                     END    \n            -------AND zbpc_lays='ALLLAYERS'\n            AND zbpc_sgmt='INDUSTRY' \n            AND zbpc_lays='BOTTOMSUP'\n            AND zbpc_chan='TOTCHANNEL'\n          --  AND TP.parent_id IS NOT NULL\n            ) AS T1\n      LEFT  JOIN TG ON T1.zbpc_geo = TG.base_id  where T1.zbpc_geo is not null\n ) AS T3\n\n \n\nGROUP BY zbpc_time\n,parent_id_1\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n)\n\n\n--此时的geo的数据量是不全的 需要后面的job 补充\n\ninsert overwrite table proj_tx_kpi_prd.T_Transformation_Five_part_geo\nselect \nzbpc_time as zbpc_month,\ncase when substr(zbpc_time,6,3) in ('JAN','FEB','MAR') then concat((cast ((cast(substr(zbpc_time,1,4) as int) -1) as string)),'.Q4')\n     when substr(zbpc_time,6,3) in ('APR','MAY','JUN') then concat(substr(zbpc_time,1,4),'.Q1')\n     when substr(zbpc_time,6,3) in ('JUL','AUG','SEP') then concat(substr(zbpc_time,1,4),'.Q2')\n     when substr(zbpc_time,6,3) in ('OCT','NOV','DEC') then concat(substr(zbpc_time,1,4),'.Q3')\n   end as zbpc_time\n,geo\n,kpi_name\n,sum(zbpc_data) as zbpc_data from (\n\nSELECT \n     zbpc_time\n     ,case when parent_id_1='PRCG' then 'PRCG'\n           when parent_id_1='NAG'  then 'NAG'\n           when parent_id_1='LASR' then 'LAS'\n           --when parent_id_1='LAG'  then 'LAG'\n           --when parent_id_1='BT'   then 'BT'\n           when parent_id_1='EMEANEW' then 'EMEANEW'\n           when parent_id_1='AP' then 'AP'\n           when parent_id_1='HQ' then 'HQ'\n           when parent_id_1='WW2013' then 'WW2013'\n         end as geo\n     , zbpc_pgrp\n     , kpi_name\n     , SUM(zbpc_data) AS zbpc_data\nFROM T\nWHERE  kpi_name IS NOT NULL\nGROUP BY zbpc_time,parent_id_1, kpi_name, zbpc_pgrp\nORDER BY zbpc_time  DESC\n) aa\ngroup by\nzbpc_time,\ncase when substr(zbpc_time,6,3) in ('JAN','FEB','MAR') then concat((cast ((cast(substr(zbpc_time,1,4) as int) -1) as string)),'.Q4')\n     when substr(zbpc_time,6,3) in ('APR','MAY','JUN') then concat(substr(zbpc_time,1,4),'.Q1')\n     when substr(zbpc_time,6,3) in ('JUL','AUG','SEP') then concat(substr(zbpc_time,1,4),'.Q2')\n     when substr(zbpc_time,6,3) in ('OCT','NOV','DEC') then concat(substr(zbpc_time,1,4),'.Q3')\n   end \n,geo\n,kpi_name",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288731_0_0_data_5",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_five_part_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_five_part_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:31:46",
          "job_end_time": "2019-05-22 12:32:12",
          "job_start_unix_time": 1558499506,
          "job_end_unix_time": 1558499532,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288731,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_five_part_geo",
          "sqlText": null,
          "datasetId": 4656012,
          "srl_no": "5",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288735_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Five_Part_PcServicePenRate_denominator/分母",
          "job_name": "分母",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:32:05",
          "job_end_time": "2019-05-22 12:35:22",
          "job_start_unix_time": 1558499525,
          "job_end_unix_time": 1558499722,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288735,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16360",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "--分母\nWITH TP AS \n( SELECT  base_id, parent_id\n  FROM `dm_finance`.`bpc_fin_dim_hier_odl`\n  WHERE category='PRODGROUP' AND tree IN ('PARENTH5') AND parent_id ='PCO'\n)\n,TG AS\n(SELECT base_id,parent_id as parent_id_1\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='GEOGRAPHY' AND tree='PARENTH1' AND parent_id in ('PRCG','NAG','LASR','LAG','BT','EMEANEW','APL','HQ','WW2013','MEDION')\n)\n,TL AS\n(SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='LAYERS' AND tree='PARENTH1' AND parent_id='ALLLAYERS'\n)\n, T AS ( \nSELECT zbpc_time\n, parent_id_1\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, SUM(zbpc_data) AS zbpc_data\n, MAX(update_timestamp) AS update_timestamp\nFROM (SELECT * FROM (SELECT TG.parent_id_1, *\n      FROM (SELECT *\n                 ,'PC Service Pen Rate denominator' as kpi_name\n            FROM `cdl_finance`.`bw_fin_coobps02l_cdl` AS F\n            LEFT OUTER JOIN TP ON F.zbpc_pgrp=TP.base_id\n            WHERE zbpc_acct='TOTREV' \n            AND zbpc_case= CASE WHEN UPPER(zbpc_time) in ('2016.APR','2016.MAY','2016.JUN','2016.JUL','2016.AUG','2016.SEP','2016.OCT','2016.NOV','2016.DEC','2017.JAN','2017.FEB','2017.MAR') THEN 'RACT'\n                                     WHEN UPPER(zbpc_time) in ('2017.APR','2017.MAY','2017.JUN','2017.JUL','2017.AUG','2017.SEP','2017.OCT','2017.NOV','2017.DEC','2018.JAN','2018.FEB','2018.MAR') THEN 'RACT'\n                                     \tELSE CASE WHEN UPPER(zbpc_time) LIKE '%.MAR' OR UPPER(zbpc_time) LIKE '%.JUN' OR UPPER(zbpc_time) LIKE '%.SEP' OR UPPER(zbpc_time) LIKE '%.DEC' THEN 'ACTQ' \n                                     \t\t        ELSE 'ACT' END\n                                     END    \n            -------AND zbpc_lays='ALLLAYERS'\n            AND zbpc_sgmt='INDUSTRY' \n            AND zbpc_chan='TOTCHANNEL'\n            AND TP.parent_id IS NOT NULL\n            ) AS T1\n      LEFT  JOIN TG ON T1.zbpc_geo = TG.base_id  where T1.zbpc_geo is not null\n      )AS T2\n   LEFT SEMI JOIN TL ON T2.zbpc_lays = TL.base_id \n ) AS T3\n \n\nGROUP BY zbpc_time\n, parent_id_1\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n)\n\n\n--insert overwrite table proj_tx_kpi_prd.T_Transformation_Hyperscale\n--('PRCG','NAG','LASR','LAG','BT','EMEANEW','APL','HQ','WW2013','MEDION')\ninsert overwrite table proj_tx_kpi_prd.T_Transformation_Five_denominator_middle\nselect \nzbpc_time as zbpc_month,\ncase when substr(zbpc_time,6,3) in ('JAN','FEB','MAR') then concat((cast ((cast(substr(zbpc_time,1,4) as int) -1) as string)),'.Q4')\n     when substr(zbpc_time,6,3) in ('APR','MAY','JUN') then concat(substr(zbpc_time,1,4),'.Q1')\n     when substr(zbpc_time,6,3) in ('JUL','AUG','SEP') then concat(substr(zbpc_time,1,4),'.Q2')\n     when substr(zbpc_time,6,3) in ('OCT','NOV','DEC') then concat(substr(zbpc_time,1,4),'.Q3')\n   end as zbpc_time\n,geo\n,kpi_name\n,sum(zbpc_data) as zbpc_data from\n(\nSELECT \n     zbpc_time\n     ,case when parent_id_1='PRCG' then 'PRCG'\n           when parent_id_1='NAG' then 'NAG'\n           when parent_id_1='LASR' then 'LAS'\n           when parent_id_1='LAG' then 'LAS'\n           when parent_id_1='BT' then 'BT'\n           when parent_id_1='EMEANEW' then 'EMEANEW'\n           when parent_id_1='APL' then 'AP'\n           when parent_id_1='HQ' then 'HQ'\n           when parent_id_1='WW2013' then 'WW2013'\n           when parent_id_1='MEDION' then 'MEDION'\n         end as geo\n     , zbpc_pgrp\n     , kpi_name\n     , SUM(zbpc_data) AS zbpc_data\nFROM T\nWHERE  kpi_name IS NOT NULL\nGROUP BY zbpc_time, parent_id_1,kpi_name, zbpc_pgrp\nORDER BY zbpc_time  DESC\n) aa\ngroup by\nzbpc_time,\ncase when substr(zbpc_time,6,3) in ('JAN','FEB','MAR') then concat((cast ((cast(substr(zbpc_time,1,4) as int) -1) as string)),'.Q4')\n     when substr(zbpc_time,6,3) in ('APR','MAY','JUN') then concat(substr(zbpc_time,1,4),'.Q1')\n     when substr(zbpc_time,6,3) in ('JUL','AUG','SEP') then concat(substr(zbpc_time,1,4),'.Q2')\n     when substr(zbpc_time,6,3) in ('OCT','NOV','DEC') then concat(substr(zbpc_time,1,4),'.Q3')\n   end \n,geo\n,kpi_name\n",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288735_0_0_data_3",
          "node_type": "data",
          "abstracted_path": "/default/tl",
          "storage_type": "spark",
          "urn": "spark://default/tl",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:32:05",
          "job_end_time": "2019-05-22 12:35:22",
          "job_start_unix_time": 1558499525,
          "job_end_unix_time": 1558499722,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20288735,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "default",
          "tbl_name": "tl",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "3",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288735_0_0_data_5",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_five_denominator_middle",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_five_denominator_middle",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:32:05",
          "job_end_time": "2019-05-22 12:35:22",
          "job_start_unix_time": 1558499525,
          "job_end_unix_time": 1558499722,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288735,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_five_denominator_middle",
          "sqlText": null,
          "datasetId": 4656006,
          "srl_no": "5",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288732_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Five_Part_PcServicePenRate_numerator/T_Transformation_Five_part_LAG",
          "job_name": "T_Transformation_Five_part_LAG",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:32:12",
          "job_end_time": "2019-05-22 12:32:37",
          "job_start_unix_time": 1558499532,
          "job_end_unix_time": 1558499557,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288732,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16358",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "--------分子\nWITH TP AS \n( SELECT  base_id, parent_id\n  FROM `dm_finance`.`bpc_fin_dim_hier_odl`\n  WHERE category='PRODGROUP' AND tree IN ('PARENTH6') AND parent_id ='PCSD'\n)\n\n, T AS ( \nSELECT zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, SUM(zbpc_data) AS zbpc_data\n, MAX(update_timestamp) AS update_timestamp\nFROM (SELECT *  \n      FROM (SELECT *\n                 ,'PC Service Pen Rate Numerator' as kpi_name\n            FROM `cdl_finance`.`bw_fin_coobps02l_cdl` AS F\n            LEFT OUTER JOIN TP ON F.zbpc_pgrp=TP.base_id\n            WHERE zbpc_acct in ('REVTCV') \n            AND zbpc_case= CASE WHEN UPPER(zbpc_time) in ('2016.APR','2016.MAY','2016.JUN','2016.JUL','2016.AUG','2016.SEP','2016.OCT','2016.NOV','2016.DEC','2017.JAN','2017.FEB','2017.MAR') THEN 'RACT'\n                                     WHEN UPPER(zbpc_time) in ('2017.APR','2017.MAY','2017.JUN','2017.JUL','2017.AUG','2017.SEP','2017.OCT','2017.NOV','2017.DEC','2018.JAN','2018.FEB','2018.MAR') THEN 'RACT'\n                                     ELSE CASE WHEN UPPER(zbpc_time) LIKE '%.OCT' OR UPPER(zbpc_time) LIKE '%.NOV' OR UPPER(zbpc_time) LIKE '%.DEC' then 'ACT'\n                                     \t\t\tELSE 'RACT' END\n                                     END     \n            -------AND zbpc_lays='ALLLAYERS'\n            AND zbpc_geo ='LAG'\n            AND zbpc_sgmt='INDUSTRY' \n            AND zbpc_lays='BOTTOMSUP'\n            AND zbpc_chan='TOTCHANNEL'\n          --  AND TP.parent_id IS NOT NULL\n            ) AS T1\n     \n ) AS T3\n\n \n\nGROUP BY zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n)\n\n\n--此步是生成LAG的geo的\ninsert overwrite table proj_tx_kpi_prd.T_Transformation_Five_part_LAG\nselect \nzbpc_time as zbpc_month,\ncase when substr(zbpc_time,6,3) in ('JAN','FEB','MAR') then concat((cast ((cast(substr(zbpc_time,1,4) as int) -1) as string)),'.Q4')\n     when substr(zbpc_time,6,3) in ('APR','MAY','JUN') then concat(substr(zbpc_time,1,4),'.Q1')\n     when substr(zbpc_time,6,3) in ('JUL','AUG','SEP') then concat(substr(zbpc_time,1,4),'.Q2')\n     when substr(zbpc_time,6,3) in ('OCT','NOV','DEC') then concat(substr(zbpc_time,1,4),'.Q3')\n   end as zbpc_time\n,geo\n,kpi_name\n,sum(zbpc_data) as zbpc_data  from (\n\nSELECT \n     zbpc_time\n     ,'LAS' as geo\n     , zbpc_pgrp\n     , kpi_name\n     , SUM(zbpc_data) AS zbpc_data\nFROM T\nWHERE  kpi_name IS NOT NULL\nGROUP BY zbpc_time ,kpi_name, zbpc_pgrp\nORDER BY zbpc_time  DESC\n) aa\ngroup by\nzbpc_time,\n case when substr(zbpc_time,6,3) in ('JAN','FEB','MAR') then concat((cast ((cast(substr(zbpc_time,1,4) as int) -1) as string)),'.Q4')\n     when substr(zbpc_time,6,3) in ('APR','MAY','JUN') then concat(substr(zbpc_time,1,4),'.Q1')\n     when substr(zbpc_time,6,3) in ('JUL','AUG','SEP') then concat(substr(zbpc_time,1,4),'.Q2')\n     when substr(zbpc_time,6,3) in ('OCT','NOV','DEC') then concat(substr(zbpc_time,1,4),'.Q3')\n   end\n,geo\n,kpi_name",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288732_0_0_data_3",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_five_part_lag",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_five_part_lag",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:32:12",
          "job_end_time": "2019-05-22 12:32:37",
          "job_start_unix_time": 1558499532,
          "job_end_unix_time": 1558499557,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288732,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_five_part_lag",
          "sqlText": null,
          "datasetId": 4656013,
          "srl_no": "3",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288733_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Five_Part_PcServicePenRate_numerator/T_Transformation_Five_part_BT",
          "job_name": "T_Transformation_Five_part_BT",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:32:37",
          "job_end_time": "2019-05-22 12:33:11",
          "job_start_unix_time": 1558499557,
          "job_end_unix_time": 1558499591,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288733,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16358",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "--------分子\nWITH TP AS \n( SELECT  base_id, parent_id\n  FROM `dm_finance`.`bpc_fin_dim_hier_odl`\n  WHERE category='PRODGROUP' AND tree IN ('PARENTH6') AND parent_id ='PCSD'\n)\n\n, T AS ( \nSELECT zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, SUM(zbpc_data) AS zbpc_data\n, MAX(update_timestamp) AS update_timestamp\nFROM (SELECT *  \n      FROM (SELECT *\n                 ,'PC Service Pen Rate Numerator' as kpi_name\n            FROM `cdl_finance`.`bw_fin_coobps02l_cdl` AS F\n            LEFT OUTER JOIN TP ON F.zbpc_pgrp=TP.base_id\n            WHERE zbpc_acct in ('REVTCV') \n            AND zbpc_case= CASE WHEN UPPER(zbpc_time) in ('2016.APR','2016.MAY','2016.JUN','2016.JUL','2016.AUG','2016.SEP','2016.OCT','2016.NOV','2016.DEC','2017.JAN','2017.FEB','2017.MAR') THEN 'RACT'\n                                     WHEN UPPER(zbpc_time) in ('2017.APR','2017.MAY','2017.JUN','2017.JUL','2017.AUG','2017.SEP','2017.OCT','2017.NOV','2017.DEC','2018.JAN','2018.FEB','2018.MAR') THEN 'RACT'\n                                     ELSE CASE WHEN UPPER(zbpc_time) LIKE '%.OCT' OR UPPER(zbpc_time) LIKE '%.NOV' OR UPPER(zbpc_time) LIKE '%.DEC' then 'ACT'\n                                     \t\t\tELSE 'RACT' END\n                                     END    \n            -------AND zbpc_lays='ALLLAYERS'\n            AND zbpc_geo ='BT'\n            AND zbpc_sgmt='INDUSTRY' \n            AND zbpc_lays='BOTTOMSUP'\n            AND zbpc_chan='TOTCHANNEL'\n          --  AND TP.parent_id IS NOT NULL\n            ) AS T1\n     \n ) AS T3\n\n \n\nGROUP BY zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n)\n\n\n--此时生成BT\n\ninsert overwrite table proj_tx_kpi_prd.T_Transformation_Five_part_BT\nselect \nzbpc_time as zbpc_month,\ncase when substr(zbpc_time,6,3) in ('JAN','FEB','MAR') then concat((cast ((cast(substr(zbpc_time,1,4) as int) -1) as string)),'.Q4')\n     when substr(zbpc_time,6,3) in ('APR','MAY','JUN') then concat(substr(zbpc_time,1,4),'.Q1')\n     when substr(zbpc_time,6,3) in ('JUL','AUG','SEP') then concat(substr(zbpc_time,1,4),'.Q2')\n     when substr(zbpc_time,6,3) in ('OCT','NOV','DEC') then concat(substr(zbpc_time,1,4),'.Q3')\n   end as zbpc_time\n,geo\n,kpi_name\n,sum(zbpc_data) as zbpc_data from (\n\nSELECT \n     zbpc_time\n     ,'BT' as geo\n     , zbpc_pgrp\n     , kpi_name\n     , SUM(zbpc_data) AS zbpc_data\nFROM T\nWHERE  kpi_name IS NOT NULL\nGROUP BY zbpc_time ,kpi_name, zbpc_pgrp\nORDER BY zbpc_time  DESC\n) aa\ngroup by\nzbpc_time,\n case when substr(zbpc_time,6,3) in ('JAN','FEB','MAR') then concat((cast ((cast(substr(zbpc_time,1,4) as int) -1) as string)),'.Q4')\n     when substr(zbpc_time,6,3) in ('APR','MAY','JUN') then concat(substr(zbpc_time,1,4),'.Q1')\n     when substr(zbpc_time,6,3) in ('JUL','AUG','SEP') then concat(substr(zbpc_time,1,4),'.Q2')\n     when substr(zbpc_time,6,3) in ('OCT','NOV','DEC') then concat(substr(zbpc_time,1,4),'.Q3')\n   end\n,geo\n,kpi_name",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288733_0_0_data_0",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_five_part_bt",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_five_part_bt",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:32:37",
          "job_end_time": "2019-05-22 12:33:11",
          "job_start_unix_time": 1558499557,
          "job_end_unix_time": 1558499591,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288733,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_five_part_bt",
          "sqlText": null,
          "datasetId": 4656010,
          "srl_no": "0",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288736_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Five_Part_PcServicePenRate_denominator/PRCG_geo",
          "job_name": "PRCG_geo",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:35:22",
          "job_end_time": "2019-05-22 12:36:32",
          "job_start_unix_time": 1558499722,
          "job_end_unix_time": 1558499792,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288736,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16360",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "--分母中单独  PRCG  sunny的 kpi的数据 进行计算\n\nWITH TG AS\n(SELECT base_id\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='GEOGRAPHY' AND tree='PARENTH1' AND parent_id ='PRCG'\n)\n,TL AS\n(SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='LAYERS' AND tree='PARENTH1' AND parent_id='ALLLAYERS'\n)\n, T AS ( \nSELECT zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, SUM(zbpc_data) AS zbpc_data\n, MAX(update_timestamp) AS update_timestamp\nFROM (SELECT * FROM (SELECT *\n      FROM (SELECT *\n                 ,'PC Service Pen Rate denominator' as kpi_name\n            FROM `cdl_finance`.`bw_fin_coobps02l_cdl` AS F\n           -- LEFT OUTER JOIN TP ON F.zbpc_pgrp=TP.base_id\n            WHERE zbpc_acct='TOTREV' \n            AND zbpc_case= CASE WHEN UPPER(zbpc_time) in ('2016.APR','2016.MAY','2016.JUN','2016.JUL','2016.AUG','2016.SEP','2016.OCT','2016.NOV','2016.DEC','2017.JAN','2017.FEB','2017.MAR') THEN 'RACT'\n                                     WHEN UPPER(zbpc_time) in ('2017.APR','2017.MAY','2017.JUN','2017.JUL','2017.AUG','2017.SEP','2017.OCT','2017.NOV','2017.DEC','2018.JAN','2018.FEB','2018.MAR') THEN 'RACT'\n                                     \tELSE CASE WHEN UPPER(zbpc_time) LIKE '%.MAR' OR UPPER(zbpc_time) LIKE '%.JUN' OR UPPER(zbpc_time) LIKE '%.SEP' OR UPPER(zbpc_time) LIKE '%.DEC' THEN 'ACTQ' \n                                     \t\t        ELSE 'ACT' END\n                                     END     \n            -------AND zbpc_lays='ALLLAYERS'\n            AND zbpc_sgmt='INDUSTRY' \n            AND zbpc_chan='TOTCHANNEL'\n            AND zbpc_pgrp='LPVO'\n          --  AND TP.parent_id IS NOT NULL\n            ) AS T1\n      LEFT semi JOIN TG ON T1.zbpc_geo = TG.base_id \n      )AS T2\n   LEFT SEMI JOIN TL ON T2.zbpc_lays = TL.base_id \n ) AS T3\n \n\nGROUP BY zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n)\n\n\n--insert overwrite table proj_tx_kpi_prd.T_Transformation_Hyperscale\n--2017.JUN 2017.FEB 2017.MAR 2017.APR 2017.MAY 2017.JUN 2017.JUL 2017.AUG 2017.SEP 2017.OCT 2017.NOV 2017.DEC\n\n\n\n\ninsert overwrite table proj_tx_kpi_prd.T_Transformation_Five_Sunny \n\nselect \nzbpc_time as zbpc_month,\ncase when substr(zbpc_time,6,3) in ('JAN','FEB','MAR') then concat((cast ((cast(substr(zbpc_time,1,4) as int) -1) as string)),'.Q4')\n     when substr(zbpc_time,6,3) in ('APR','MAY','JUN') then concat(substr(zbpc_time,1,4),'.Q1')\n     when substr(zbpc_time,6,3) in ('JUL','AUG','SEP') then concat(substr(zbpc_time,1,4),'.Q2')\n     when substr(zbpc_time,6,3) in ('OCT','NOV','DEC') then concat(substr(zbpc_time,1,4),'.Q3')\n   end as zbpc_time\n,geo\n,kpi_name\n, sum(zbpc_data) as zbpc_data \nfrom\n(\n\nSELECT \n     zbpc_time\n     ,'PRCG' as geo\n     , zbpc_pgrp\n     , kpi_name\n     , SUM(zbpc_data) AS zbpc_data\nFROM T\nWHERE  kpi_name IS NOT NULL\nGROUP BY zbpc_time, kpi_name, zbpc_pgrp\nORDER BY zbpc_time  DESC\n) aa\ngroup by\nzbpc_time,\ncase when substr(zbpc_time,6,3) in ('JAN','FEB','MAR') then concat((cast ((cast(substr(zbpc_time,1,4) as int) -1) as string)),'.Q4')\n     when substr(zbpc_time,6,3) in ('APR','MAY','JUN') then concat(substr(zbpc_time,1,4),'.Q1')\n     when substr(zbpc_time,6,3) in ('JUL','AUG','SEP') then concat(substr(zbpc_time,1,4),'.Q2')\n     when substr(zbpc_time,6,3) in ('OCT','NOV','DEC') then concat(substr(zbpc_time,1,4),'.Q3')\n   end\n,geo\n,kpi_name",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288736_0_0_data_3",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_five_sunny",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_five_sunny",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:35:22",
          "job_end_time": "2019-05-22 12:36:32",
          "job_start_unix_time": 1558499722,
          "job_end_unix_time": 1558499792,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288736,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_five_sunny",
          "sqlText": null,
          "datasetId": 4656017,
          "srl_no": "3",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288737_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Five_Part_PcServicePenRate_denominator/BT",
          "job_name": "BT",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:36:32",
          "job_end_time": "2019-05-22 12:37:16",
          "job_start_unix_time": 1558499792,
          "job_end_unix_time": 1558499836,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288737,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16360",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "--分母\nWITH TP AS \n( SELECT  base_id, parent_id\n  FROM `dm_finance`.`bpc_fin_dim_hier_odl`\n  WHERE category='PRODGROUP' AND tree IN ('PARENTH5') AND parent_id ='PCO'\n)\n,TL AS\n(SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='LAYERS' AND tree='PARENTH1' AND parent_id='ALLLAYERS'\n)\n, T AS ( \nSELECT zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, SUM(zbpc_data) AS zbpc_data\n, MAX(update_timestamp) AS update_timestamp\nFROM (SELECT * FROM (SELECT *\n      FROM (SELECT *\n                 ,'PC Service Pen Rate denominator' as kpi_name\n            FROM `cdl_finance`.`bw_fin_coobps02l_cdl` AS F\n            LEFT OUTER JOIN TP ON F.zbpc_pgrp=TP.base_id\n            WHERE zbpc_acct='TOTREV' \n            AND zbpc_case= CASE WHEN UPPER(zbpc_time) in ('2016.APR','2016.MAY','2016.JUN','2016.JUL','2016.AUG','2016.SEP','2016.OCT','2016.NOV','2016.DEC','2017.JAN','2017.FEB','2017.MAR') THEN 'RACT'\n                                     WHEN UPPER(zbpc_time) in ('2017.APR','2017.MAY','2017.JUN','2017.JUL','2017.AUG','2017.SEP','2017.OCT','2017.NOV','2017.DEC','2018.JAN','2018.FEB','2018.MAR') THEN 'RACT'\n                                     \tELSE CASE WHEN UPPER(zbpc_time) LIKE '%.MAR' OR UPPER(zbpc_time) LIKE '%.JUN' OR UPPER(zbpc_time) LIKE '%.SEP' OR UPPER(zbpc_time) LIKE '%.DEC' THEN 'ACTQ' \n                                     \t\t        ELSE 'ACT' END\n                                     END     \n            -------AND zbpc_lays='ALLLAYERS'\n            AND zbpc_geo ='BT'\n            AND zbpc_sgmt='INDUSTRY' \n            AND zbpc_chan='TOTCHANNEL'\n            AND TP.parent_id IS NOT NULL\n            ) AS T1\n      )AS T2\n   LEFT SEMI JOIN TL ON T2.zbpc_lays = TL.base_id \n ) AS T3\n \n\nGROUP BY zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n)\n\n\ninsert overwrite table proj_tx_kpi_prd.T_Transformation_Five_part_denominator_BT\nselect \nzbpc_time as zbpc_month,\n case when substr(zbpc_time,6,3) in ('JAN','FEB','MAR') then concat((cast ((cast(substr(zbpc_time,1,4) as int) -1) as string)),'.Q4')\n     when substr(zbpc_time,6,3) in ('APR','MAY','JUN') then concat(substr(zbpc_time,1,4),'.Q1')\n     when substr(zbpc_time,6,3) in ('JUL','AUG','SEP') then concat(substr(zbpc_time,1,4),'.Q2')\n     when substr(zbpc_time,6,3) in ('OCT','NOV','DEC') then concat(substr(zbpc_time,1,4),'.Q3')\n   end as zbpc_time\n,geo\n,kpi_name\n,sum(zbpc_data) as zbpc_data from\n(\nSELECT \n     zbpc_time\n     ,'BT' as geo\n     , zbpc_pgrp\n     , kpi_name\n     , SUM(zbpc_data) AS zbpc_data\nFROM T\nWHERE  kpi_name IS NOT NULL\nGROUP BY zbpc_time,kpi_name, zbpc_pgrp\nORDER BY zbpc_time  DESC\n) aa\ngroup by\nzbpc_time\n,zbpc_time\n,geo\n,kpi_name\n",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288737_0_0_data_0",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_five_part_denominator_bt",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_five_part_denominator_bt",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:36:32",
          "job_end_time": "2019-05-22 12:37:16",
          "job_start_unix_time": 1558499792,
          "job_end_unix_time": 1558499836,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288737,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_five_part_denominator_bt",
          "sqlText": null,
          "datasetId": 4656011,
          "srl_no": "0",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288721_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Bigdata_All/T_Transformation_Bigdata",
          "job_name": "T_Transformation_Bigdata",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:31:08",
          "job_end_time": "2019-05-22 12:31:32",
          "job_start_unix_time": 1558499468,
          "job_end_unix_time": 1558499492,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288721,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16340",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "--------Fives Objects \nWITH TG AS\n(SELECT base_id\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='GEOGRAPHY' AND tree='PARENTH1' AND parent_id ='WW2013'\n)\n,TL AS\n(SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='LAYERS' AND tree='PARENTH1' AND parent_id='ALLLAYERS'\n)\n, T AS ( \nSELECT zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, SUM(zbpc_data) AS zbpc_data\n, MAX(update_timestamp) AS update_timestamp\nFROM (SELECT * FROM (SELECT *\n      FROM (SELECT *\n                 ,'Big data, Vertical Solution Revenue and Customer Base Big_data' as kpi_name\n            FROM `cdl_finance`.`bw_fin_coobps02l_cdl` AS F\n            LEFT OUTER JOIN TG ON F.zbpc_pgrp=TG.base_id\n            WHERE zbpc_acct='TOTREV' \n            AND zbpc_case= CASE WHEN  UPPER(zbpc_time) in ('2016.APR','2016.MAY','2016.JUN','2016.JUL','2016.AUG','2016.SEP','2016.OCT','2016.NOV','2016.DEC','2017.JAN','2017.FEB','2017.MAR') THEN 'RACT'\n                                     WHEN UPPER(zbpc_time) in ('2017.APR','2017.MAY','2017.JUN','2017.JUL','2017.AUG','2017.SEP','2017.OCT','2017.NOV','2017.DEC','2018.JAN','2018.FEB','2018.MAR') THEN 'RACT'\n                                     ELSE CASE WHEN UPPER(zbpc_time) LIKE '%.MAR' OR UPPER(zbpc_time) LIKE '%.JUN' OR UPPER(zbpc_time) LIKE '%.SEP' OR UPPER(zbpc_time) LIKE '%.DEC' THEN 'ACTQ'\n                                                  ELSE 'ACT' END\n                                     END    \n            -------AND zbpc_lays='ALLLAYERS'\n            AND zbpc_sgmt='INDUSTRY' \n            AND zbpc_pgrp='LPSWA'\n            AND zbpc_chan='TOTCHANNEL'\n         \n            ) AS T1\n      )AS T2\n   LEFT SEMI JOIN TL ON T2.zbpc_lays = TL.base_id \n ) AS T3\n\nGROUP BY zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n)\n\n\ninsert overwrite table proj_tx_kpi_prd.T_Transformation_Bigdata \n\n\n\nselect \nzbpc_time\n,Fiscal_Year\n,kpi_name\n,'WW2013' as geo\n,bu\n,zbpc_data\n,cumulative_amount\n,sum(zbpc_data) OVER (PARTITION BY Fiscal_Year,kpi_name ORDER BY zbpc_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)  as Fiscal_Year_cumulative \nfrom\n(\nselect \nzbpc_time,\ncase when substr(zbpc_time,6,2) in ('01','02','03') then concat(cast((cast(substr(zbpc_time,1,4) as int)-1) as string),substr(zbpc_time,3,2))\n     else concat(substr(zbpc_time,1,4),cast((cast(substr(zbpc_time,3,2) as int)+1)as string))  end as Fiscal_Year,\nkpi_name,\nbu,\nsum(zbpc_data) as zbpc_data,\nsum(sum(zbpc_data)) OVER (PARTITION BY kpi_name,bu ORDER BY zbpc_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS cumulative_amount\n\nfrom(\nselect \nzbpc_time\n,kpi_name\n,BU\n,sum(zbpc_data) as zbpc_data\nfrom\n(\nSELECT \n     case when substring(zbpc_time,6,3)='AUG' then concat(substring(zbpc_time,1,4),'-08')\n     when substring(zbpc_time,6,3)='DEC' then concat(substring(zbpc_time,1,4),'-12')\n     when substring(zbpc_time,6,3)='JUN' then concat(substring(zbpc_time,1,4),'-06')\n     when substring(zbpc_time,6,3)='MAR' then concat(substring(zbpc_time,1,4),'-03')\n     when substring(zbpc_time,6,3)='APR' then concat(substring(zbpc_time,1,4),'-04')\n     when substring(zbpc_time,6,3)='FEB' then concat(substring(zbpc_time,1,4),'-02')\n     when substring(zbpc_time,6,3)='JAN' then concat(substring(zbpc_time,1,4),'-01')\n     when substring(zbpc_time,6,3)='NOV' then concat(substring(zbpc_time,1,4),'-11')\n     when substring(zbpc_time,6,3)='JUL' then concat(substring(zbpc_time,1,4),'-07')\n     when substring(zbpc_time,6,3)='OCT' then concat(substring(zbpc_time,1,4),'-10')\n     when substring(zbpc_time,6,3)='SEP' then concat(substring(zbpc_time,1,4),'-09')\n     when substring(zbpc_time,6,3)='MAY' then concat(substring(zbpc_time,1,4),'-05')\n    end as zbpc_time\n     , zbpc_pgrp\n     , kpi_name\n     , 'DCG' BU\n     , SUM(zbpc_data) AS zbpc_data\nFROM T\nWHERE  kpi_name IS NOT NULL AND SUBSTR(UPPER(zbpc_time),-3,3) <>'INP' AND SUBSTR(UPPER(zbpc_time),1,4) <>'2015'\nGROUP BY zbpc_time, kpi_name, zbpc_pgrp\nORDER BY zbpc_time  DESC\n) aa\ngroup by\nzbpc_time,kpi_name,BU\n)aa\ngroup by\nzbpc_time,\nkpi_name,\nbu\norder by\nzbpc_time\n)aaa\ngroup by\nzbpc_time\n,Fiscal_Year\n,kpi_name\n,bu\n,zbpc_data\n,cumulative_amount",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288721_0_0_data_4",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_bigdata",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_bigdata",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:31:08",
          "job_end_time": "2019-05-22 12:31:32",
          "job_start_unix_time": 1558499468,
          "job_end_unix_time": 1558499492,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288721,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_bigdata",
          "sqlText": null,
          "datasetId": 4655984,
          "srl_no": "4",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288717_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_5_Object/T_Transformation_Hyperscale",
          "job_name": "T_Transformation_Hyperscale",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:30:59",
          "job_end_time": "2019-05-22 12:31:28",
          "job_start_unix_time": 1558499459,
          "job_end_unix_time": 1558499488,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288717,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16274",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "--------DCG Non-device Revenue get Basemember NOT TOTCHANNEL\nWITH TP AS \n( SELECT  base_id, parent_id\n  FROM `dm_finance`.`bpc_fin_dim_hier_odl`\n  WHERE category='PRODGROUP' AND tree IN ('PARENTH6') AND parent_id ='EBG'\n)\n,TG AS\n(SELECT base_id\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='GEOGRAPHY' AND tree='PARENTH1' AND parent_id ='WW2013'\n)\n,TL AS\n(SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='LAYERS' AND tree='PARENTH1' AND parent_id='ALLLAYERS'\n)\n,TC AS\n (SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='CHANNEL' AND tree='PARENTH1' AND parent_id IN ('BSTHSCL')\n)\n, T AS ( \nSELECT zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, SUM(zbpc_data) AS zbpc_data\n, MAX(update_timestamp) AS update_timestamp\nFROM (SELECT * FROM (SELECT *\n      FROM (SELECT *\n                 ,'BSTHSCL - Hyperscale' as kpi_name\n            FROM `cdl_finance`.`bw_fin_coobps02l_cdl` AS F\n            LEFT OUTER JOIN TP ON F.zbpc_pgrp=TP.base_id\n            WHERE zbpc_acct='TOTREV' \n            AND zbpc_case= CASE WHEN UPPER(zbpc_time) in ('2016.APR','2016.MAY','2016.JUN','2016.JUL','2016.AUG','2016.SEP','2016.OCT','2016.NOV','2016.DEC','2017.JAN','2017.FEB','2017.MAR') THEN 'RACT'\n                                     WHEN UPPER(zbpc_time) in ('2017.APR','2017.MAY','2017.JUN','2017.JUL','2017.AUG','2017.SEP','2017.OCT','2017.NOV','2017.DEC','2018.JAN','2018.FEB','2018.MAR') THEN 'RACT'\n                                     ELSE CASE WHEN UPPER(zbpc_time) LIKE '%.MAR' OR UPPER(zbpc_time) LIKE '%.JUN' OR UPPER(zbpc_time) LIKE '%.SEP' OR UPPER(zbpc_time) LIKE '%.DEC' THEN 'ACTQ' \n                                                  ELSE 'ACT' END   \n                                     END    \n            -------AND zbpc_lays='ALLLAYERS'\n            AND zbpc_sgmt='INDUSTRY' \n            AND TP.parent_id IS NOT NULL\n            ) AS T1\n      LEFT semi JOIN TG ON T1.zbpc_geo = TG.base_id \n      )AS T2\n   LEFT SEMI JOIN TL ON T2.zbpc_lays = TL.base_id \n ) AS T3\n LEFT SEMI JOIN TC ON T3.zbpc_chan = TC.base_id \n \n\nGROUP BY zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n)\n\n\ninsert overwrite table proj_tx_kpi_prd.T_Transformation_Hyperscale\n\nSELECT \n     zbpc_time\n     , zbpc_pgrp\n     , kpi_name\n     , 'DCG' BU\n     , SUM(zbpc_data) AS zbpc_data\nFROM T WHERE  SUBSTR(UPPER(zbpc_time),-3,3) <> 'INP' AND SUBSTR(UPPER(zbpc_time),1,4) <> '2015'\nAND  kpi_name IS NOT NULL\nGROUP BY zbpc_time, kpi_name, zbpc_pgrp\nORDER BY zbpc_time  DESC",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288717_0_0_data_5",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_hyperscale",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_hyperscale",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:30:59",
          "job_end_time": "2019-05-22 12:31:28",
          "job_start_unix_time": 1558499459,
          "job_end_unix_time": 1558499488,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288717,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_hyperscale",
          "sqlText": null,
          "datasetId": 4656027,
          "srl_no": "5",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288722_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Bigdata_All/T_Transformation_China_geo",
          "job_name": "T_Transformation_China_geo",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:31:32",
          "job_end_time": "2019-05-22 12:31:56",
          "job_start_unix_time": 1558499492,
          "job_end_unix_time": 1558499516,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288722,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16340",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "--------DCG Non-device Revenue get Basemember NOT TOTCHANNEL\nWITH TP AS \n( SELECT  base_id, parent_id\n  FROM `dm_finance`.`bpc_fin_dim_hier_odl`\n  WHERE category='PRODGROUP' AND tree IN ('PARENTH6') AND parent_id ='PCGST'\n)\n,TG AS\n(SELECT base_id\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='GEOGRAPHY' AND tree='PARENTH1' AND parent_id ='WW2013'\n)\n,TL AS\n(SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='LAYERS' AND tree='PARENTH1' AND parent_id='ALLLAYERS'\n)\n\n, T AS ( \nSELECT zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, SUM(zbpc_data) AS zbpc_data\n, MAX(update_timestamp) AS update_timestamp\nFROM (SELECT * FROM (SELECT *\n      FROM (SELECT *\n                 ,'Big data, Vertical Solution Revenue and Customer Base China_geo' as kpi_name\n            FROM `cdl_finance`.`bw_fin_coobps02l_cdl` AS F\n            LEFT OUTER JOIN TP ON F.zbpc_pgrp=TP.base_id\n            WHERE zbpc_acct='TOTREV' \n            AND zbpc_case= CASE WHEN  UPPER(zbpc_time) in ('2016.APR','2016.MAY','2016.JUN','2016.JUL','2016.AUG','2016.SEP','2016.OCT','2016.NOV','2016.DEC','2017.JAN','2017.FEB','2017.MAR') THEN 'RACT'\n                                     WHEN UPPER(zbpc_time) in ('2017.APR','2017.MAY','2017.JUN','2017.JUL','2017.AUG','2017.SEP','2017.OCT','2017.NOV','2017.DEC','2018.JAN','2018.FEB','2018.MAR') THEN 'RACT'\n                                     ELSE CASE WHEN UPPER(zbpc_time) LIKE '%.MAR' OR UPPER(zbpc_time) LIKE '%.JUN' OR UPPER(zbpc_time) LIKE '%.SEP' OR UPPER(zbpc_time) LIKE '%.DEC' THEN 'ACTQ'\n                                                  ELSE 'ACT' END\n                                     END \n            -------AND zbpc_lays='ALLLAYERS'\n            AND zbpc_sgmt='CRS' \n             AND zbpc_chan='TOTCHANNEL'\n            AND TP.parent_id IS NOT NULL\n            ) AS T1\n      LEFT semi JOIN TG ON T1.zbpc_geo = TG.base_id \n      )AS T2\n   LEFT SEMI JOIN TL ON T2.zbpc_lays = TL.base_id \n ) AS T3\n\n \n\nGROUP BY zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n)\n\n\ninsert overwrite table proj_tx_kpi_prd.T_Transformation_China_geo\nselect \nzbpc_time\n,Fiscal_Year\n,kpi_name\n,'PRC' as geo\n,bu\n,zbpc_data\n,cumulative_amount\n,sum(zbpc_data) OVER (PARTITION BY Fiscal_Year,kpi_name ORDER BY zbpc_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)  as Fiscal_Year_cumulative \nfrom\n(\nselect \nzbpc_time,\ncase when substr(zbpc_time,6,2) in ('01','02','03') then concat(cast((cast(substr(zbpc_time,1,4) as int)-1) as string),substr(zbpc_time,3,2))\n     else concat(substr(zbpc_time,1,4),cast((cast(substr(zbpc_time,3,2) as int)+1)as string))  end as Fiscal_Year,\nkpi_name,\nbu,\nsum(zbpc_data) as zbpc_data,\nsum(sum(zbpc_data)) OVER (PARTITION BY kpi_name,bu ORDER BY zbpc_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS cumulative_amount\n\nfrom(\nselect \nzbpc_time\n,kpi_name\n,BU\n,sum(zbpc_data) as zbpc_data \nfrom \n(\nSELECT \ncase when substring(zbpc_time,6,3)='AUG' then concat(substring(zbpc_time,1,4),'-08')\n     when substring(zbpc_time,6,3)='DEC' then concat(substring(zbpc_time,1,4),'-12')\n     when substring(zbpc_time,6,3)='JUN' then concat(substring(zbpc_time,1,4),'-06')\n     when substring(zbpc_time,6,3)='MAR' then concat(substring(zbpc_time,1,4),'-03')\n     when substring(zbpc_time,6,3)='APR' then concat(substring(zbpc_time,1,4),'-04')\n     when substring(zbpc_time,6,3)='FEB' then concat(substring(zbpc_time,1,4),'-02')\n     when substring(zbpc_time,6,3)='JAN' then concat(substring(zbpc_time,1,4),'-01')\n     when substring(zbpc_time,6,3)='NOV' then concat(substring(zbpc_time,1,4),'-11')\n     when substring(zbpc_time,6,3)='JUL' then concat(substring(zbpc_time,1,4),'-07')\n     when substring(zbpc_time,6,3)='OCT' then concat(substring(zbpc_time,1,4),'-10')\n     when substring(zbpc_time,6,3)='SEP' then concat(substring(zbpc_time,1,4),'-09')\n     when substring(zbpc_time,6,3)='MAY' then concat(substring(zbpc_time,1,4),'-05')\n    end as zbpc_time\n     , zbpc_pgrp\n     , kpi_name\n     , 'PCSD' BU\n     , SUM(zbpc_data) AS zbpc_data\nFROM T\nWHERE  kpi_name IS NOT NULL  AND SUBSTR(UPPER(zbpc_time),-3,3) <>'INP' AND SUBSTR(UPPER(zbpc_time),1,4) <>'2015'\nGROUP BY zbpc_time, kpi_name, zbpc_pgrp\nORDER BY zbpc_time  DESC\n) aa\ngroup by\nzbpc_time,kpi_name,BU\n) b\ngroup by\nzbpc_time,\nkpi_name,\nbu\norder by\nzbpc_time\n) c\ngroup by\nzbpc_time\n,Fiscal_Year\n,kpi_name\n,bu\n,zbpc_data\n,cumulative_amount",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288722_0_0_data_6",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_china_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_china_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:31:32",
          "job_end_time": "2019-05-22 12:31:56",
          "job_start_unix_time": 1558499492,
          "job_end_unix_time": 1558499516,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288722,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_china_geo",
          "sqlText": null,
          "datasetId": 4655987,
          "srl_no": "6",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288718_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_5_Object/T_Transformation_SDI",
          "job_name": "T_Transformation_SDI",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:31:28",
          "job_end_time": "2019-05-22 12:32:13",
          "job_start_unix_time": 1558499488,
          "job_end_unix_time": 1558499533,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288718,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16274",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "--------DCG Non-device Revenue get Basemember NOT TOTCHANNEL\nWITH TP AS \n( SELECT  base_id, parent_id\n  FROM `dm_finance`.`bpc_fin_dim_hier_odl`\n  WHERE category='PRODGROUP' AND tree IN ('PARENTH6') AND parent_id ='EBG'\n)\n,TG AS\n(SELECT base_id\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='GEOGRAPHY' AND tree='PARENTH1' AND parent_id ='WW2013'\n)\n,TL AS\n(SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='LAYERS' AND tree='PARENTH1' AND parent_id='ALLLAYERS'\n)\n,TC AS\n (SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='CHANNEL' AND tree='PARENTH1' AND parent_id IN ('BSSDDC')\n)\n, T AS ( \nSELECT zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, SUM(zbpc_data) AS zbpc_data\n, MAX(update_timestamp) AS update_timestamp\nFROM (SELECT * FROM (SELECT *\n      FROM (SELECT *\n                 ,'BSSDDC - SDI' as kpi_name\n            FROM `cdl_finance`.`bw_fin_coobps02l_cdl` AS F\n            LEFT OUTER JOIN TP ON F.zbpc_pgrp=TP.base_id\n            WHERE zbpc_acct='TOTREV' \n            AND zbpc_case=  CASE WHEN UPPER(zbpc_time) in ('2016.APR','2016.MAY','2016.JUN','2016.JUL','2016.AUG','2016.SEP','2016.OCT','2016.NOV','2016.DEC','2017.JAN','2017.FEB','2017.MAR') THEN 'RACT'\n                                     WHEN UPPER(zbpc_time) in ('2017.APR','2017.MAY','2017.JUN','2017.JUL','2017.AUG','2017.SEP','2017.OCT','2017.NOV','2017.DEC','2018.JAN','2018.FEB','2018.MAR') THEN 'RACT'\n                                     ELSE CASE WHEN UPPER(zbpc_time) LIKE '%.MAR' OR UPPER(zbpc_time) LIKE '%.JUN' OR UPPER(zbpc_time) LIKE '%.SEP' OR UPPER(zbpc_time) LIKE '%.DEC' THEN 'ACTQ' \n                                                  ELSE 'ACT' END   \n                                     END   \n            -------AND zbpc_lays='ALLLAYERS'\n            AND zbpc_sgmt='INDUSTRY' \n            AND TP.parent_id IS NOT NULL\n            ) AS T1\n      LEFT semi JOIN TG ON T1.zbpc_geo = TG.base_id \n      )AS T2\n   LEFT SEMI JOIN TL ON T2.zbpc_lays = TL.base_id \n ) AS T3\n LEFT SEMI JOIN TC ON T3.zbpc_chan = TC.base_id \n \n\nGROUP BY zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n)\n\n\ninsert overwrite table proj_tx_kpi_prd.T_Transformation_SDI\n\nSELECT \n     zbpc_time\n     , zbpc_pgrp\n     , kpi_name\n     , 'DCG' BU\n     , SUM(zbpc_data) AS zbpc_data\nFROM T  WHERE  SUBSTR(UPPER(zbpc_time),-3,3) <> 'INP' AND SUBSTR(UPPER(zbpc_time),1,4) <> '2015'\nand kpi_name IS NOT NULL\nGROUP BY zbpc_time, kpi_name, zbpc_pgrp\nORDER BY zbpc_time  DESC",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288718_0_0_data_0",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_sdi",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_sdi",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:31:28",
          "job_end_time": "2019-05-22 12:32:13",
          "job_start_unix_time": 1558499488,
          "job_end_unix_time": 1558499533,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288718,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_sdi",
          "sqlText": null,
          "datasetId": 4656120,
          "srl_no": "0",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288729_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_PCSD_GA/T_Transformation_PCSD_GA",
          "job_name": "T_Transformation_PCSD_GA",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:31:27",
          "job_end_time": "2019-05-22 12:32:09",
          "job_start_unix_time": 1558499487,
          "job_end_unix_time": 1558499529,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288729,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16344",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "\n--------DCG Non-device Revenue get Basemember NOT TOTCHANNEL\nWITH TP AS \n( SELECT  base_id, parent_id\n  FROM `dm_finance`.`bpc_fin_dim_hier_odl`\n  WHERE category='PRODGROUP' AND tree IN ('PARENTH6') AND parent_id ='PCSD'\n)\n,TG AS\n(SELECT base_id,parent_id as parent_id_1\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='GEOGRAPHY' AND tree='PARENTH1' AND parent_id  in ('WW2013','PRCG','AP','EMEANEW','NAG','LAR','HQ')\n)\n,TL AS\n(SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='LAYERS' AND tree='PARENTH1' AND parent_id='ALLLAYERS'\n)\n\n, T AS ( \nSELECT zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, parent_id_1\n, SUM(zbpc_data) AS zbpc_data\n, MAX(update_timestamp) AS update_timestamp\nFROM (SELECT * FROM (SELECT TG.parent_id_1,*\n      FROM (SELECT *\n                 ,'Global Accounts PCSD_GA' as kpi_name\n            FROM `cdl_finance`.`bw_fin_coobps02l_cdl` AS F\n            LEFT OUTER JOIN TP ON F.zbpc_pgrp=TP.base_id\n            WHERE zbpc_acct='TOTREV' \n            AND zbpc_case= CASE WHEN  UPPER(zbpc_time) in ('2016.APR','2016.MAY','2016.JUN','2016.JUL','2016.AUG','2016.SEP','2016.OCT','2016.NOV','2016.DEC','2017.JAN','2017.FEB','2017.MAR') THEN 'RACT'\n                                     WHEN UPPER(zbpc_time) in ('2017.APR','2017.MAY','2017.JUN','2017.JUL','2017.AUG','2017.SEP','2017.OCT','2017.NOV','2017.DEC','2018.JAN','2018.FEB','2018.MAR') THEN 'RACT'\n                                     ELSE CASE WHEN UPPER(zbpc_time) LIKE '%.MAR' OR UPPER(zbpc_time) LIKE '%.JUN' OR UPPER(zbpc_time) LIKE '%.SEP' OR UPPER(zbpc_time) LIKE '%.DEC' THEN 'ACTQ'\n                                               ELSE 'ACT' END\n                                     END    \n            -------AND zbpc_lays='ALLLAYERS'\n            AND zbpc_sgmt='GA' \n            AND zbpc_chan='TOTCHANNEL'\n            AND TP.parent_id IS NOT NULL\n            ) AS T1\n      LEFT  JOIN TG ON T1.zbpc_geo = TG.base_id  where T1.zbpc_geo is not null\n      )AS T2\n   LEFT SEMI JOIN TL ON T2.zbpc_lays = TL.base_id \n ) AS T3\n \n\nGROUP BY zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, parent_id_1\n)\n-- insert middle table \ninsert overwrite table proj_tx_kpi_prd.T_Transformation_PCSD_GA_Middle\n\nselect zbpc_time,kpi_name,geo,bu,sum(zbpc_data) as zbpc_data from (\n\nSELECT \ncase when substr(zbpc_time,6,3) in ('JAN','FEB','MAR') then concat((cast ((cast(substr(zbpc_time,1,4) as int) -1) as string)),'.Q4')\n     when substr(zbpc_time,6,3) in ('APR','MAY','JUN') then concat(substr(zbpc_time,1,4),'.Q1')\n     when substr(zbpc_time,6,3) in ('JUL','AUG','SEP') then concat(substr(zbpc_time,1,4),'.Q2')\n     when substr(zbpc_time,6,3) in ('OCT','NOV','DEC') then concat(substr(zbpc_time,1,4),'.Q3')\n   end as zbpc_time\n     , zbpc_pgrp\n     , kpi_name\n     , case when parent_id_1 ='LAR' then 'LAS'\n            else parent_id_1\n           end as geo\n     , 'PCSD' BU\n     , SUM(zbpc_data) AS zbpc_data\nFROM T\nWHERE  kpi_name IS NOT NULL AND SUBSTR(UPPER(zbpc_time),-3,3) <>'INP' AND SUBSTR(UPPER(zbpc_time),1,4) <>'2015'\nGROUP BY case when parent_id_1 ='LAR' then 'LAS'\n            else parent_id_1\n           end\n           ,zbpc_time, kpi_name, zbpc_pgrp\nORDER BY zbpc_time  DESC\n) A\ngroup by\nzbpc_time,kpi_name,geo,bu\norder by\nzbpc_time\n",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288729_0_0_data_6",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_pcsd_ga_middle",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_pcsd_ga_middle",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:31:27",
          "job_end_time": "2019-05-22 12:32:09",
          "job_start_unix_time": 1558499487,
          "job_end_unix_time": 1558499529,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288729,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_pcsd_ga_middle",
          "sqlText": null,
          "datasetId": 4656103,
          "srl_no": "6",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288739_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Global_Accounts_and_Relationship/T_Transformation_DCG_GA_M",
          "job_name": "T_Transformation_DCG_GA_M",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:30:59",
          "job_end_time": "2019-05-22 12:32:21",
          "job_start_unix_time": 1558499459,
          "job_end_unix_time": 1558499541,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288739,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16393",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "--------DCG Non-device Revenue get Basemember NOT TOTCHANNEL\nWITH TP AS \n( SELECT  base_id, parent_id\n  FROM `dm_finance`.`bpc_fin_dim_hier_odl`\n  WHERE category='PRODGROUP' AND tree IN ('PARENTH6') AND parent_id ='EBG'\n)\n,TG AS\n(SELECT base_id,parent_id as parent_id_1\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='GEOGRAPHY' AND tree='PARENTH1' AND parent_id in ('WW2013','PRCG','AP','EMEANEW','NAG','LAR','HQ')\n)\n,TL AS\n(SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='LAYERS' AND tree='PARENTH1' AND parent_id='ALLLAYERS'\n)\n\n, T AS ( \nSELECT zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, parent_id_1\n, SUM(zbpc_data) AS zbpc_data\n, MAX(update_timestamp) AS update_timestamp\nFROM (SELECT * FROM (SELECT TG.parent_id_1,*\n      FROM (SELECT *\n                 ,'Global Accounts DCG_GA' as kpi_name\n            FROM `cdl_finance`.`bw_fin_coobps02l_cdl` AS F\n            LEFT OUTER JOIN TP ON F.zbpc_pgrp=TP.base_id\n            WHERE zbpc_acct='TOTREV' \n            AND zbpc_case= CASE WHEN  UPPER(zbpc_time) in ('2016.APR','2016.MAY','2016.JUN','2016.JUL','2016.AUG','2016.SEP','2016.OCT','2016.NOV','2016.DEC','2017.JAN','2017.FEB','2017.MAR') THEN 'RACT'\n                                     WHEN UPPER(zbpc_time) in ('2017.APR','2017.MAY','2017.JUN','2017.JUL','2017.AUG','2017.SEP','2017.OCT','2017.NOV','2017.DEC','2018.JAN','2018.FEB','2018.MAR') THEN 'RACT'\n                                     ELSE CASE WHEN UPPER(zbpc_time) LIKE '%.MAR' OR UPPER(zbpc_time) LIKE '%.JUN' OR UPPER(zbpc_time) LIKE '%.SEP' OR UPPER(zbpc_time) LIKE '%.DEC' THEN 'ACTQ'\n                                               ELSE 'ACT' END\n                                     END    \n            -------AND zbpc_lays='ALLLAYERS'\n            AND zbpc_sgmt='GA' \n            AND zbpc_chan='TOTCHANNEL'\n            AND TP.parent_id IS NOT NULL\n            ) AS T1\n      LEFT join  TG ON T1.zbpc_geo = TG.base_id where T1.zbpc_geo is not null\n      )AS T2\n   LEFT SEMI JOIN TL ON T2.zbpc_lays = TL.base_id \n ) AS T3\n \n\nGROUP BY zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, parent_id_1\n)\n\n\ninsert overwrite table proj_tx_kpi_prd.t_transformation_dcg_ga_middle_m\n\nselect zbpc_time,kpi_name,geo,bu,sum(zbpc_data) as zbpc_data from (\n\nSELECT \ncase when upper(substring(zbpc_time,6,3))='AUG' then concat(substring(zbpc_time,1,4),'-08')\n     when upper(substring(zbpc_time,6,3))='DEC' then concat(substring(zbpc_time,1,4),'-12')\n     when upper(substring(zbpc_time,6,3))='JUN' then concat(substring(zbpc_time,1,4),'-06')\n     when upper(substring(zbpc_time,6,3))='MAR' then concat(substring(zbpc_time,1,4),'-03')\n     when upper(substring(zbpc_time,6,3))='APR' then concat(substring(zbpc_time,1,4),'-04')\n     when upper(substring(zbpc_time,6,3))='FEB' then concat(substring(zbpc_time,1,4),'-02')\n     when upper(substring(zbpc_time,6,3))='JAN' then concat(substring(zbpc_time,1,4),'-01')\n     when upper(substring(zbpc_time,6,3))='NOV' then concat(substring(zbpc_time,1,4),'-11')\n     when upper(substring(zbpc_time,6,3))='JUL' then concat(substring(zbpc_time,1,4),'-07')\n     when upper(substring(zbpc_time,6,3))='OCT' then concat(substring(zbpc_time,1,4),'-10')\n     when upper(substring(zbpc_time,6,3))='SEP' then concat(substring(zbpc_time,1,4),'-09')\n     when upper(substring(zbpc_time,6,3))='MAY' then concat(substring(zbpc_time,1,4),'-05')\n    end as zbpc_time\n     , zbpc_pgrp\n     , kpi_name\n     , case when parent_id_1 ='LAR' then 'LAS'\n            else parent_id_1\n           end as geo\n     , 'DCG' BU\n     , SUM(zbpc_data) AS zbpc_data\nFROM T\nWHERE  kpi_name IS NOT NULL AND SUBSTR(UPPER(zbpc_time),-3,3) <>'INP' AND SUBSTR(UPPER(zbpc_time),1,4) <>'2015'\nGROUP BY case when parent_id_1 ='LAR' then 'LAS'\n            else parent_id_1\n           end\n           ,zbpc_time, kpi_name, zbpc_pgrp\nORDER BY zbpc_time  DESC\n) A\ngroup by\nzbpc_time,kpi_name,geo,bu\norder by\nzbpc_time\n",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288739_0_0_data_3",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_dcg_ga_middle_m",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_dcg_ga_middle_m",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:30:59",
          "job_end_time": "2019-05-22 12:32:21",
          "job_start_unix_time": 1558499459,
          "job_end_unix_time": 1558499541,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288739,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_dcg_ga_middle_m",
          "sqlText": null,
          "datasetId": 4655992,
          "srl_no": "3",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288728_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_DCG_GA/T_Transformation_DCG_GA",
          "job_name": "T_Transformation_DCG_GA",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:31:26",
          "job_end_time": "2019-05-22 12:32:21",
          "job_start_unix_time": 1558499486,
          "job_end_unix_time": 1558499541,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288728,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16343",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "\n--------DCG Non-device Revenue get Basemember NOT TOTCHANNEL\nWITH TP AS \n( SELECT  base_id, parent_id\n  FROM `dm_finance`.`bpc_fin_dim_hier_odl`\n  WHERE category='PRODGROUP' AND tree IN ('PARENTH6') AND parent_id ='EBG'\n)\n,TG AS\n(SELECT base_id,parent_id as parent_id_1\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='GEOGRAPHY' AND tree='PARENTH1' AND parent_id in ('WW2013','PRCG','AP','EMEANEW','NAG','LAR','HQ')\n)\n,TL AS\n(SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='LAYERS' AND tree='PARENTH1' AND parent_id='ALLLAYERS'\n)\n\n, T AS ( \nSELECT zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, parent_id_1\n, SUM(zbpc_data) AS zbpc_data\n, MAX(update_timestamp) AS update_timestamp\nFROM (SELECT * FROM (SELECT TG.parent_id_1,*\n      FROM (SELECT *\n                 ,'Global Accounts DCG_GA' as kpi_name\n            FROM `cdl_finance`.`bw_fin_coobps02l_cdl` AS F\n            LEFT OUTER JOIN TP ON F.zbpc_pgrp=TP.base_id\n            WHERE zbpc_acct='TOTREV' \n            AND zbpc_case= CASE WHEN  UPPER(zbpc_time) in ('2016.APR','2016.MAY','2016.JUN','2016.JUL','2016.AUG','2016.SEP','2016.OCT','2016.NOV','2016.DEC','2017.JAN','2017.FEB','2017.MAR') THEN 'RACT'\n                                     WHEN UPPER(zbpc_time) in ('2017.APR','2017.MAY','2017.JUN','2017.JUL','2017.AUG','2017.SEP','2017.OCT','2017.NOV','2017.DEC','2018.JAN','2018.FEB','2018.MAR') THEN 'RACT'\n                                     ELSE CASE WHEN UPPER(zbpc_time) LIKE '%.MAR' OR UPPER(zbpc_time) LIKE '%.JUN' OR UPPER(zbpc_time) LIKE '%.SEP' OR UPPER(zbpc_time) LIKE '%.DEC' THEN 'ACTQ'\n                                               ELSE 'ACT' END\n                                     END   \n            -------AND zbpc_lays='ALLLAYERS'\n            AND zbpc_sgmt='GA' \n            AND zbpc_chan='TOTCHANNEL'\n            AND TP.parent_id IS NOT NULL\n            ) AS T1\n      LEFT join  TG ON T1.zbpc_geo = TG.base_id where T1.zbpc_geo is not null\n      )AS T2\n   LEFT SEMI JOIN TL ON T2.zbpc_lays = TL.base_id \n ) AS T3\n \n\nGROUP BY zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, parent_id_1\n)\n\n\ninsert overwrite table proj_tx_kpi_prd.t_transformation_dcg_ga_middle\n\nselect zbpc_time,kpi_name,geo,bu,sum(zbpc_data) as zbpc_data from (\n\nSELECT \ncase when substr(zbpc_time,6,3) in ('JAN','FEB','MAR') then concat((cast ((cast(substr(zbpc_time,1,4) as int) -1) as string)),'.Q4')\n     when substr(zbpc_time,6,3) in ('APR','MAY','JUN') then concat(substr(zbpc_time,1,4),'.Q1')\n     when substr(zbpc_time,6,3) in ('JUL','AUG','SEP') then concat(substr(zbpc_time,1,4),'.Q2')\n     when substr(zbpc_time,6,3) in ('OCT','NOV','DEC') then concat(substr(zbpc_time,1,4),'.Q3')\n   end as zbpc_time\n     , zbpc_pgrp\n     , kpi_name\n     , case when parent_id_1 ='LAR' then 'LAS'\n            else parent_id_1\n           end as geo\n     , 'DCG' BU\n     , SUM(zbpc_data) AS zbpc_data\nFROM T\nWHERE  kpi_name IS NOT NULL AND SUBSTR(UPPER(zbpc_time),-3,3) <>'INP' AND SUBSTR(UPPER(zbpc_time),1,4) <>'2015'\nGROUP BY case when parent_id_1 ='LAR' then 'LAS'\n            else parent_id_1\n           end\n           ,zbpc_time, kpi_name, zbpc_pgrp\nORDER BY zbpc_time  DESC\n) A\ngroup by\nzbpc_time,kpi_name,geo,bu\norder by\nzbpc_time\n",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288728_0_0_data_1",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_dcg_ga_middle",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_dcg_ga_middle",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:31:26",
          "job_end_time": "2019-05-22 12:32:21",
          "job_start_unix_time": 1558499486,
          "job_end_unix_time": 1558499541,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288728,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_dcg_ga_middle",
          "sqlText": null,
          "datasetId": 4655991,
          "srl_no": "1",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288730_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_PCSD_Relationship/T_Transformation_PCSD_Relationship",
          "job_name": "T_Transformation_PCSD_Relationship",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:31:35",
          "job_end_time": "2019-05-22 12:32:37",
          "job_start_unix_time": 1558499495,
          "job_end_unix_time": 1558499557,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288730,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16346",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "\n--------DCG Non-device Revenue get Basemember NOT TOTCHANNEL\nWITH TP AS \n( SELECT  base_id, parent_id\n  FROM `dm_finance`.`bpc_fin_dim_hier_odl`\n  WHERE category='PRODGROUP' AND tree IN ('PARENTH6') AND parent_id ='PCSD'\n)\n,TG AS\n(SELECT base_id,parent_id as parent_id_1\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='GEOGRAPHY' AND tree='PARENTH1' AND parent_id in ('WW2013','PRCG','AP','EMEANEW','NAG','LAR','HQ')\n)\n,TL AS\n(SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='LAYERS' AND tree='PARENTH1' AND parent_id='ALLLAYERS'\n)\n,TS AS\n(SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='CUSTOMER' AND tree='PARENTH1' AND parent_id='RS'\n)\n\n, T AS ( \nSELECT zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, parent_id_1\n, SUM(zbpc_data) AS zbpc_data\n, MAX(update_timestamp) AS update_timestamp\nFROM (SELECT * FROM (SELECT TG.parent_id_1,*\n      FROM (SELECT *\n                 ,'PCSD REL(PCSD Relationship)' as kpi_name\n            FROM `cdl_finance`.`bw_fin_coobps02l_cdl` AS F\n            LEFT OUTER JOIN TP ON F.zbpc_pgrp=TP.base_id\n            WHERE zbpc_acct='TOTREV' \n            AND zbpc_case= CASE WHEN  UPPER(zbpc_time) in ('2016.APR','2016.MAY','2016.JUN','2016.JUL','2016.AUG','2016.SEP','2016.OCT','2016.NOV','2016.DEC','2017.JAN','2017.FEB','2017.MAR') THEN 'RACT'\n                                     WHEN UPPER(zbpc_time) in ('2017.APR','2017.MAY','2017.JUN','2017.JUL','2017.AUG','2017.SEP','2017.OCT','2017.NOV','2017.DEC','2018.JAN','2018.FEB','2018.MAR') THEN 'RACT'\n                                     ELSE CASE WHEN UPPER(zbpc_time) LIKE '%.MAR' OR UPPER(zbpc_time) LIKE '%.JUN' OR UPPER(zbpc_time) LIKE '%.SEP' OR UPPER(zbpc_time) LIKE '%.DEC' THEN 'ACTQ'\n                                               ELSE 'ACT' END\n                                     END \n            -------AND zbpc_lays='ALLLAYERS'\n          --  AND zbpc_sgmt='RS' \n            AND zbpc_chan='TOTCHANNEL'\n            AND TP.parent_id IS NOT NULL\n            ) AS T1\n      LEFT  JOIN TG ON T1.zbpc_geo = TG.base_id  where T1.zbpc_geo is not null\n      )AS T2\n   LEFT SEMI JOIN TL ON T2.zbpc_lays = TL.base_id \n ) AS T3\n LEFT SEMI join TS ON T3.zbpc_sgmt = TS.base_id\n\nGROUP BY zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, parent_id_1\n)\n\n\n-- insert middle table \ninsert overwrite table proj_tx_kpi_prd.T_Transformation_PCSD_Relationship_Middle\n\nselect zbpc_time,kpi_name,geo,bu,sum(zbpc_data) as zbpc_data from (\n\nSELECT \ncase when substr(zbpc_time,6,3) in ('JAN','FEB','MAR') then concat((cast ((cast(substr(zbpc_time,1,4) as int) -1) as string)),'.Q4')\n     when substr(zbpc_time,6,3) in ('APR','MAY','JUN') then concat(substr(zbpc_time,1,4),'.Q1')\n     when substr(zbpc_time,6,3) in ('JUL','AUG','SEP') then concat(substr(zbpc_time,1,4),'.Q2')\n     when substr(zbpc_time,6,3) in ('OCT','NOV','DEC') then concat(substr(zbpc_time,1,4),'.Q3')\n   end as zbpc_time\n     , zbpc_pgrp\n     , kpi_name\n     , case when parent_id_1 ='LAR' then 'LAS'\n            else parent_id_1\n           end as geo\n     , 'PCSD' BU\n     , SUM(zbpc_data) AS zbpc_data\nFROM T\nWHERE  kpi_name IS NOT NULL AND  SUBSTR(UPPER(zbpc_time),-3,3) <>'INP' AND SUBSTR(UPPER(zbpc_time),1,4) <>'2015'\nGROUP BY case when parent_id_1 ='LAR' then 'LAS'\n            else parent_id_1\n           end\n           ,zbpc_time, kpi_name, zbpc_pgrp\nORDER BY zbpc_time  DESC\n) A\ngroup by\nzbpc_time,kpi_name,geo,bu\norder by\nzbpc_time\n",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288730_0_0_data_7",
          "node_type": "data",
          "abstracted_path": "/default/ts",
          "storage_type": "spark",
          "urn": "spark://default/ts",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:31:35",
          "job_end_time": "2019-05-22 12:32:37",
          "job_start_unix_time": 1558499495,
          "job_end_unix_time": 1558499557,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20288730,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "default",
          "tbl_name": "ts",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "7",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288730_0_0_data_1",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_pcsd_relationship_middle",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_pcsd_relationship_middle",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:31:35",
          "job_end_time": "2019-05-22 12:32:37",
          "job_start_unix_time": 1558499495,
          "job_end_unix_time": 1558499557,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288730,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_pcsd_relationship_middle",
          "sqlText": null,
          "datasetId": 4656117,
          "srl_no": "1",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288740_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Global_Accounts_and_Relationship/T_Transformation_PCSD_GA_Middle_M",
          "job_name": "T_Transformation_PCSD_GA_Middle_M",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:32:21",
          "job_end_time": "2019-05-22 12:34:14",
          "job_start_unix_time": 1558499541,
          "job_end_unix_time": 1558499654,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288740,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16393",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "--------DCG Non-device Revenue get Basemember NOT TOTCHANNEL\nWITH TP AS \n( SELECT  base_id, parent_id\n  FROM `dm_finance`.`bpc_fin_dim_hier_odl`\n  WHERE category='PRODGROUP' AND tree IN ('PARENTH6') AND parent_id ='PCSD'\n)\n,TG AS\n(SELECT base_id,parent_id as parent_id_1\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='GEOGRAPHY' AND tree='PARENTH1' AND parent_id  in ('WW2013','PRCG','AP','EMEANEW','NAG','LAR','HQ')\n)\n,TL AS\n(SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='LAYERS' AND tree='PARENTH1' AND parent_id='ALLLAYERS'\n)\n\n, T AS ( \nSELECT zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, parent_id_1\n, SUM(zbpc_data) AS zbpc_data\n, MAX(update_timestamp) AS update_timestamp\nFROM (SELECT * FROM (SELECT TG.parent_id_1,*\n      FROM (SELECT *\n                 ,'Global Accounts PCSD_GA' as kpi_name\n            FROM `cdl_finance`.`bw_fin_coobps02l_cdl` AS F\n            LEFT OUTER JOIN TP ON F.zbpc_pgrp=TP.base_id\n            WHERE zbpc_acct='TOTREV' \n            AND zbpc_case= CASE WHEN  UPPER(zbpc_time) in ('2016.APR','2016.MAY','2016.JUN','2016.JUL','2016.AUG','2016.SEP','2016.OCT','2016.NOV','2016.DEC','2017.JAN','2017.FEB','2017.MAR') THEN 'RACT'\n                                     WHEN UPPER(zbpc_time) in ('2017.APR','2017.MAY','2017.JUN','2017.JUL','2017.AUG','2017.SEP','2017.OCT','2017.NOV','2017.DEC','2018.JAN','2018.FEB','2018.MAR') THEN 'RACT'\n                                     ELSE CASE WHEN UPPER(zbpc_time) LIKE '%.MAR' OR UPPER(zbpc_time) LIKE '%.JUN' OR UPPER(zbpc_time) LIKE '%.SEP' OR UPPER(zbpc_time) LIKE '%.DEC' THEN 'ACTQ'\n                                               ELSE 'ACT' END\n                                     END \n            -------AND zbpc_lays='ALLLAYERS'\n            AND zbpc_sgmt='GA' \n            AND zbpc_chan='TOTCHANNEL'\n            AND TP.parent_id IS NOT NULL\n            ) AS T1\n      LEFT  JOIN TG ON T1.zbpc_geo = TG.base_id  where T1.zbpc_geo is not null\n      )AS T2\n   LEFT SEMI JOIN TL ON T2.zbpc_lays = TL.base_id \n ) AS T3\n \n\nGROUP BY zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, parent_id_1\n)\n-- insert middle table \ninsert overwrite table proj_tx_kpi_prd.T_Transformation_PCSD_GA_Middle_M\n\nselect zbpc_time,kpi_name,geo,bu,sum(zbpc_data) as zbpc_data from (\n\nSELECT \ncase when upper(substring(zbpc_time,6,3))='AUG' then concat(substring(zbpc_time,1,4),'-08')\n     when upper(substring(zbpc_time,6,3))='DEC' then concat(substring(zbpc_time,1,4),'-12')\n     when upper(substring(zbpc_time,6,3))='JUN' then concat(substring(zbpc_time,1,4),'-06')\n     when upper(substring(zbpc_time,6,3))='MAR' then concat(substring(zbpc_time,1,4),'-03')\n     when upper(substring(zbpc_time,6,3))='APR' then concat(substring(zbpc_time,1,4),'-04')\n     when upper(substring(zbpc_time,6,3))='FEB' then concat(substring(zbpc_time,1,4),'-02')\n     when upper(substring(zbpc_time,6,3))='JAN' then concat(substring(zbpc_time,1,4),'-01')\n     when upper(substring(zbpc_time,6,3))='NOV' then concat(substring(zbpc_time,1,4),'-11')\n     when upper(substring(zbpc_time,6,3))='JUL' then concat(substring(zbpc_time,1,4),'-07')\n     when upper(substring(zbpc_time,6,3))='OCT' then concat(substring(zbpc_time,1,4),'-10')\n     when upper(substring(zbpc_time,6,3))='SEP' then concat(substring(zbpc_time,1,4),'-09')\n     when upper(substring(zbpc_time,6,3))='MAY' then concat(substring(zbpc_time,1,4),'-05')\n    end as zbpc_time\n     , zbpc_pgrp\n     , kpi_name\n     , case when parent_id_1 ='LAR' then 'LAS'\n            else parent_id_1\n           end as geo\n     , 'PCSD' BU\n     , SUM(zbpc_data) AS zbpc_data\nFROM T\nWHERE  kpi_name IS NOT NULL AND SUBSTR(UPPER(zbpc_time),-3,3) <>'INP' AND SUBSTR(UPPER(zbpc_time),1,4) <>'2015'\nGROUP BY case when parent_id_1 ='LAR' then 'LAS'\n            else parent_id_1\n           end\n           ,zbpc_time, kpi_name, zbpc_pgrp\nORDER BY zbpc_time  DESC\n) A\ngroup by\nzbpc_time,kpi_name,geo,bu\norder by\nzbpc_time\n",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288740_0_0_data_0",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_pcsd_ga_middle_m",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_pcsd_ga_middle_m",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:32:21",
          "job_end_time": "2019-05-22 12:34:14",
          "job_start_unix_time": 1558499541,
          "job_end_unix_time": 1558499654,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288740,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_pcsd_ga_middle_m",
          "sqlText": null,
          "datasetId": 4656104,
          "srl_no": "0",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288741_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Global_Accounts_and_Relationship/T_Transformation_PCSD_Relationship_Middle_M",
          "job_name": "T_Transformation_PCSD_Relationship_Middle_M",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:34:14",
          "job_end_time": "2019-05-22 12:36:03",
          "job_start_unix_time": 1558499654,
          "job_end_unix_time": 1558499763,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288741,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16393",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "--------DCG Non-device Revenue get Basemember NOT TOTCHANNEL\nWITH TP AS \n( SELECT  base_id, parent_id\n  FROM `dm_finance`.`bpc_fin_dim_hier_odl`\n  WHERE category='PRODGROUP' AND tree IN ('PARENTH6') AND parent_id ='PCSD'\n)\n,TG AS\n(SELECT base_id,parent_id as parent_id_1\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='GEOGRAPHY' AND tree='PARENTH1' AND parent_id in ('WW2013','PRCG','AP','EMEANEW','NAG','LAR','HQ')\n)\n,TL AS\n(SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='LAYERS' AND tree='PARENTH1' AND parent_id='ALLLAYERS'\n)\n,TS AS\n(SELECT *\nFROM `dm_finance`.`bpc_fin_dim_hier_odl`\nWHERE category='CUSTOMER' AND tree='PARENTH1' AND parent_id='RS'\n)\n\n, T AS ( \nSELECT zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, parent_id_1\n, SUM(zbpc_data) AS zbpc_data\n, MAX(update_timestamp) AS update_timestamp\nFROM (SELECT * FROM (SELECT TG.parent_id_1,*\n      FROM (SELECT *\n                 ,'PCSD REL(PCSD Relationship)' as kpi_name\n            FROM `cdl_finance`.`bw_fin_coobps02l_cdl` AS F\n            LEFT OUTER JOIN TP ON F.zbpc_pgrp=TP.base_id\n            WHERE zbpc_acct='TOTREV' \n            AND zbpc_case= CASE WHEN  UPPER(zbpc_time) in ('2016.APR','2016.MAY','2016.JUN','2016.JUL','2016.AUG','2016.SEP','2016.OCT','2016.NOV','2016.DEC','2017.JAN','2017.FEB','2017.MAR') THEN 'RACT'\n                                     WHEN UPPER(zbpc_time) in ('2017.APR','2017.MAY','2017.JUN','2017.JUL','2017.AUG','2017.SEP','2017.OCT','2017.NOV','2017.DEC','2018.JAN','2018.FEB','2018.MAR') THEN 'RACT'\n                                     ELSE CASE WHEN UPPER(zbpc_time) LIKE '%.MAR' OR UPPER(zbpc_time) LIKE '%.JUN' OR UPPER(zbpc_time) LIKE '%.SEP' OR UPPER(zbpc_time) LIKE '%.DEC' THEN 'ACTQ'\n                                               ELSE 'ACT' END\n                                     END    \n            -------AND zbpc_lays='ALLLAYERS'\n          --  AND zbpc_sgmt='RS' \n            AND zbpc_chan='TOTCHANNEL'\n            AND TP.parent_id IS NOT NULL\n            ) AS T1\n      LEFT  JOIN TG ON T1.zbpc_geo = TG.base_id  where T1.zbpc_geo is not null\n      )AS T2\n   LEFT SEMI JOIN TL ON T2.zbpc_lays = TL.base_id \n ) AS T3\n LEFT SEMI join TS ON T3.zbpc_sgmt = TS.base_id\n\nGROUP BY zbpc_time\n, zbpc_acct\n, zbpc_geo\n, zbpc_case\n, zbpc_lays\n, zbpc_chan\n, zbpc_sgmt\n, zbpc_pgrp\n, kpi_name\n, parent_id_1\n)\n\n\n-- insert middle table \ninsert overwrite table proj_tx_kpi_prd.T_Transformation_PCSD_Relationship_Middle_M\n\nselect zbpc_time,kpi_name,geo,bu,sum(zbpc_data) as zbpc_data from (\n\nSELECT \ncase when upper(substring(zbpc_time,6,3))='AUG' then concat(substring(zbpc_time,1,4),'-08')\n     when upper(substring(zbpc_time,6,3))='DEC' then concat(substring(zbpc_time,1,4),'-12')\n     when upper(substring(zbpc_time,6,3))='JUN' then concat(substring(zbpc_time,1,4),'-06')\n     when upper(substring(zbpc_time,6,3))='MAR' then concat(substring(zbpc_time,1,4),'-03')\n     when upper(substring(zbpc_time,6,3))='APR' then concat(substring(zbpc_time,1,4),'-04')\n     when upper(substring(zbpc_time,6,3))='FEB' then concat(substring(zbpc_time,1,4),'-02')\n     when upper(substring(zbpc_time,6,3))='JAN' then concat(substring(zbpc_time,1,4),'-01')\n     when upper(substring(zbpc_time,6,3))='NOV' then concat(substring(zbpc_time,1,4),'-11')\n     when upper(substring(zbpc_time,6,3))='JUL' then concat(substring(zbpc_time,1,4),'-07')\n     when upper(substring(zbpc_time,6,3))='OCT' then concat(substring(zbpc_time,1,4),'-10')\n     when upper(substring(zbpc_time,6,3))='SEP' then concat(substring(zbpc_time,1,4),'-09')\n     when upper(substring(zbpc_time,6,3))='MAY' then concat(substring(zbpc_time,1,4),'-05')\n    end as zbpc_time\n     , zbpc_pgrp\n     , kpi_name\n     , case when parent_id_1 ='LAR' then 'LAS'\n            else parent_id_1\n           end as geo\n     , 'PCSD' BU\n     , SUM(zbpc_data) AS zbpc_data\nFROM T\nWHERE  kpi_name IS NOT NULL AND SUBSTR(UPPER(zbpc_time),-3,3) <>'INP' AND SUBSTR(UPPER(zbpc_time),1,4) <>'2015'\nGROUP BY case when parent_id_1 ='LAR' then 'LAS'\n            else parent_id_1\n           end\n           ,zbpc_time, kpi_name, zbpc_pgrp\nORDER BY zbpc_time  DESC\n) A\ngroup by\nzbpc_time,kpi_name,geo,bu\norder by\nzbpc_time\n",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288741_0_0_data_5",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_pcsd_relationship_middle_m",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_pcsd_relationship_middle_m",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:34:14",
          "job_end_time": "2019-05-22 12:36:03",
          "job_start_unix_time": 1558499654,
          "job_end_unix_time": 1558499763,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288741,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_pcsd_relationship_middle_m",
          "sqlText": null,
          "datasetId": 4656118,
          "srl_no": "5",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20242551_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PRJ_FR:T_Attach_Rate_Tracking/bw_fin_coobps02l_arate_odlnew",
          "job_name": "bw_fin_coobps02l_arate_odlnew",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-21 18:32:05",
          "job_end_time": "2019-05-21 18:34:05",
          "job_start_unix_time": 1558434725,
          "job_end_unix_time": 1558434845,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20242551,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_FR",
          "owner_id": "xuliu",
          "ref_id": "6679",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "insert overwrite table `dm_finance`.`bw_fin_coobps02l_arate_odlnew`\nselect \n `base`.`zbpc_time`, \n `base`.`zbpc_acct`, \n `base`.`zbpc_geo`, \n `base`.`zbpc_case`, \n `base`.`zbpc_lays`, \n `base`.`zbpc_chan`, \n `base`.`zbpc_sgmt`, \n `base`.`zbpc_pgrp`, \n `base`.`zbpc_data`, \n `base`.`update_timestamp` \nfrom \n `cdl_finance`.`bw_fin_coobps02l_cdl` `base` \nINNER JOIN \n ( \n select \n `bw_fin_coobps02l_cdl`.`zbpc_time`, \n `bw_fin_coobps02l_cdl`.`zbpc_acct`, \n `bw_fin_coobps02l_cdl`.`zbpc_geo`, \n `bw_fin_coobps02l_cdl`.`zbpc_case`, \n `bw_fin_coobps02l_cdl`.`zbpc_lays`, \n `bw_fin_coobps02l_cdl`.`zbpc_chan`, \n `bw_fin_coobps02l_cdl`.`zbpc_sgmt`, \n `bw_fin_coobps02l_cdl`.`zbpc_pgrp`, \n max(`bw_fin_coobps02l_cdl`.`update_timestamp`) `update_timestamp` \n from \n `cdl_finance`.`bw_fin_coobps02l_cdl` \n group by `bw_fin_coobps02l_cdl`.`zbpc_time`, \n `bw_fin_coobps02l_cdl`.`zbpc_acct`, \n `bw_fin_coobps02l_cdl`.`zbpc_geo`, \n `bw_fin_coobps02l_cdl`.`zbpc_case`, \n `bw_fin_coobps02l_cdl`.`zbpc_lays`, \n `bw_fin_coobps02l_cdl`.`zbpc_chan`, \n `bw_fin_coobps02l_cdl`.`zbpc_sgmt`, \n `bw_fin_coobps02l_cdl`.`zbpc_pgrp` \n ) `maxsource` \n on `base`.`zbpc_time` = `maxsource`.`zbpc_time` \n and `base`.`zbpc_acct` = `maxsource`.`zbpc_acct` \n and `base`.`zbpc_geo` = `maxsource`.`zbpc_geo` \n and `base`.`zbpc_case` = `maxsource`.`zbpc_case` \n and `base`.`zbpc_lays` = `maxsource`.`zbpc_lays` \n and `base`.`zbpc_chan` = `maxsource`.`zbpc_chan` \n and `base`.`zbpc_sgmt` = `maxsource`.`zbpc_sgmt` \n and `base`.`zbpc_pgrp` = `maxsource`.`zbpc_pgrp` \n and `base`.`update_timestamp` = `maxsource`.`update_timestamp` \nwhere `base`.`recordmode` not in ('R','D','X') \nand `base`.`zbpc_acct` = 'TOTREV' \nand `base`.`zbpc_sgmt` = 'INDUSTRY' \nand `base`.`zbpc_chan` = 'TOTCHANNEL'",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20242551_0_0_data_1",
          "node_type": "data",
          "abstracted_path": "/dm_finance/bw_fin_coobps02l_arate_odlnew",
          "storage_type": "spark",
          "urn": "spark://dm_finance/bw_fin_coobps02l_arate_odlnew",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-21 18:32:05",
          "job_end_time": "2019-05-21 18:34:05",
          "job_start_unix_time": 1558434725,
          "job_end_unix_time": 1558434845,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20242551,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "dm_finance",
          "tbl_name": "bw_fin_coobps02l_arate_odlnew",
          "sqlText": null,
          "datasetId": 4584886,
          "srl_no": "1",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18807706_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "leap_182:Optimus_BPC_Calculate_copy_03/IDC",
          "job_name": "IDC",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-24 15:17:42",
          "job_end_time": "2019-04-24 15:19:36",
          "job_start_unix_time": 1556090262,
          "job_end_unix_time": 1556090376,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 18807706,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_Optimus",
          "owner_id": "houqn1",
          "ref_id": "18560",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "Insert overwrite table prj_optimus_qas.BPC_DETAIL_TMP20190424 partition(partition_case='IDC')\nselect \nt.quarter,\nt.fiscper,\nt.zbpc_case as bpc_item,\nt.zbpc_case as bpc_case,\nc.geo,\nc.region_or_market,\nt.zbpc_geo as bpc_country,\nc.country,\nt.zbpc_sgmt as ww_bpc_segment,\ns.segment,\ns.sub_segment_l1,\ns.sub_segment_l2,\nt.zbpc_pgrp as bpc_pgrp,\nop.biz_group,\nop.biz_unit_l1,\nop.biz_unit_l2,\nop.high_growth_l1, \nop.high_growth_l2,\nt.acct_parents as bpc_parents,\nt.account_kpi,\nt.kpi_value,\n0 AS Last_Year_kpi_value\nfrom  \n(SELECT p.quarter,p.fiscper,zbpc_geo,zbpc_sgmt,zbpc_pgrp,zbpc_case,a.acct_parents,a.account_kpi,\nsum(a.value*zbpc_data) as kpi_value\nFROM cdl_finance.bw_fin_coobps02l_cdl bpc\njoin  prj_optimus_prd.mt_optimus_fiscal_period p\non  bpc.zbpc_time=p.bpc_time_mth \njoin prj_optimus_prd.mt_optimus_account_mapping a\non  bpc.zbpc_acct=a.bpc_acct\nwhere  p.quarter>'FY1617Q4'  and zbpc_case='IDC' and  length(zbpc_time)=8 and zbpc_chan = 'TOTCHANNEL'  \ngroup by p.quarter,p.fiscper,zbpc_geo,zbpc_sgmt,zbpc_pgrp,zbpc_case,a.acct_parents,a.account_kpi) t\njoin (select zbpc_geo,max(geo) as geo,max(region_or_market) as region_or_market,max(country) as country \nfrom  prj_optimus_prd.mt_optimus_country group by zbpc_geo )c\non t.zbpc_geo=c.zbpc_geo\njoin (select zbpc_sgmt,max(segment)as segment,max(sub_segment_l1) as  sub_segment_l1,max(sub_segment_l2) as sub_segment_l2 \nfrom prj_optimus_prd.mt_optimus_customer_segment_hierarchy\ngroup by zbpc_sgmt) s\non t.zbpc_sgmt=s.zbpc_sgmt \njoin prj_optimus_prd.mt_optimus_product_bpc as op\non t.zbpc_pgrp=op.zbpc_pgrp",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18807706_0_0_data_0",
          "node_type": "data",
          "abstracted_path": "/prj_optimus_prd/mt_optimus_product_bpc",
          "storage_type": "spark",
          "urn": "spark://prj_optimus_prd/mt_optimus_product_bpc",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-24 15:17:42",
          "job_end_time": "2019-04-24 15:19:36",
          "job_start_unix_time": 1556090262,
          "job_end_unix_time": 1556090376,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 18807706,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "prj_optimus_prd",
          "tbl_name": "mt_optimus_product_bpc",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "0",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18807706_0_0_data_1",
          "node_type": "data",
          "abstracted_path": "/prj_optimus_qas/bpc_detail_tmp20190424",
          "storage_type": "spark",
          "urn": "spark://prj_optimus_qas/bpc_detail_tmp20190424",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-24 15:17:42",
          "job_end_time": "2019-04-24 15:19:36",
          "job_start_unix_time": 1556090262,
          "job_end_unix_time": 1556090376,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 18807706,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "prj_optimus_qas",
          "tbl_name": "bpc_detail_tmp20190424",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "1",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18807708_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "leap_182:Optimus_BPC_Calculate_copy_03/ACT",
          "job_name": "ACT",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-24 15:20:09",
          "job_end_time": "2019-04-24 15:21:02",
          "job_start_unix_time": 1556090409,
          "job_end_unix_time": 1556090462,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 18807708,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_Optimus",
          "owner_id": "houqn1",
          "ref_id": "18560",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "Insert overwrite table prj_optimus_qas.BPC_DETAIL_TMP20190424 partition(partition_case='ACT')\nselect \nt.quarter,\nt.fiscper,\n'ACT' as bpc_item,\nt.zbpc_case as bpc_case,\nc.geo,\nc.region_or_market,\nt.zbpc_geo as bpc_country,\nc.country,\nt.zbpc_sgmt as ww_bpc_segment,\ns.segment,\ns.sub_segment_l1,\ns.sub_segment_l2,\nt.zbpc_pgrp as bpc_pgrp,\nop.biz_group,\nop.biz_unit_l1,\nop.biz_unit_l2,\nop.high_growth_l1, \nop.high_growth_l2,\nt.acct_parents as bpc_parents,\nt.account_kpi,\nt.kpi_value,\n0 AS Last_Year_kpi_value\nfrom  \n(SELECT p.quarter,p.fiscper,zbpc_geo,zbpc_sgmt,zbpc_pgrp,zbpc_case,a.acct_parents,a.account_kpi,\nsum(a.value*zbpc_data) as kpi_value\nFROM cdl_finance.bw_fin_coobps02l_cdl bpc\njoin  prj_optimus_prd.mt_optimus_fiscal_period p\non  bpc.zbpc_time=p.bpc_time_mth \njoin prj_optimus_prd.mt_optimus_account_mapping a\non  bpc.zbpc_acct=a.bpc_acct\nwhere  p.quarter>'FY1617Q4' and ((zbpc_case='ACTQ' and substr(p.quarter,1,6)='${cur_fy}' ) \nOR (zbpc_case='RACT' and substr(p.quarter,1,6)<'${cur_fy}'))    \nand  length(zbpc_time)=8 and zbpc_chan = 'TOTCHANNEL'  \ngroup by p.quarter,p.fiscper,zbpc_geo,zbpc_sgmt,zbpc_pgrp,zbpc_case,a.acct_parents,a.account_kpi) t\njoin (select zbpc_geo,max(geo) as geo,max(region_or_market) as region_or_market,max(country) as country \nfrom  prj_optimus_prd.mt_optimus_country group by zbpc_geo )c\non t.zbpc_geo=c.zbpc_geo\njoin (select zbpc_sgmt,max(segment)as segment,max(sub_segment_l1) as  sub_segment_l1,max(sub_segment_l2) as sub_segment_l2 \nfrom prj_optimus_prd.mt_optimus_customer_segment_hierarchy\ngroup by zbpc_sgmt) s\non t.zbpc_sgmt=s.zbpc_sgmt \njoin prj_optimus_prd.mt_optimus_product_bpc as op\non t.zbpc_pgrp=op.zbpc_pgrp",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18856565_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "leap_182:Optimus_BPC_Calculate_copy_03/IDC",
          "job_name": "IDC",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-25 10:19:43",
          "job_end_time": "2019-04-25 10:20:13",
          "job_start_unix_time": 1556158783,
          "job_end_unix_time": 1556158813,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 18856565,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_Optimus",
          "owner_id": "houqn1",
          "ref_id": "18560",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "Insert overwrite table prj_optimus_qas.BPC_DETAIL_TMP20190424 partition(partition_case='IDC')\nselect \nt.quarter,\nt.fiscper,\nt.zbpc_case as bpc_item,\nt.zbpc_case as bpc_case,\nc.geo,\nc.region_or_market,\nt.zbpc_geo as bpc_country,\nc.country,\nt.zbpc_sgmt as ww_bpc_segment,\ns.segment,\ns.sub_segment_l1,\ns.sub_segment_l2,\nt.zbpc_pgrp as bpc_pgrp,\nop.biz_group,\nop.biz_unit_l1,\nop.biz_unit_l2,\nop.high_growth_l1, \nop.high_growth_l2,\nt.acct_parents as bpc_parents,\nt.account_kpi,\nt.kpi_value,\n0 AS Last_Year_kpi_value\nfrom  \n(SELECT p.quarter,p.fiscper,zbpc_geo,zbpc_sgmt,zbpc_pgrp,zbpc_case,a.acct_parents,a.account_kpi,\nsum(a.value*zbpc_data) as kpi_value\nFROM cdl_finance.bw_fin_coobps02l_cdl bpc\njoin  prj_optimus_prd.mt_optimus_fiscal_period p\non  bpc.zbpc_time=p.bpc_time_mth \njoin prj_optimus_prd.mt_optimus_account_mapping a\non  bpc.zbpc_acct=a.bpc_acct\nwhere  p.quarter>'FY1617Q4'  and zbpc_case='IDC' and  length(zbpc_time)=8 and zbpc_chan = 'TOTCHANNEL'  \ngroup by p.quarter,p.fiscper,zbpc_geo,zbpc_sgmt,zbpc_pgrp,zbpc_case,a.acct_parents,a.account_kpi) t\njoin (select zbpc_geo,max(geo) as geo,max(region_or_market) as region_or_market,max(country) as country \nfrom  prj_optimus_prd.mt_optimus_country group by zbpc_geo )c\non t.zbpc_geo=c.zbpc_geo\njoin (select zbpc_sgmt,max(segment)as segment,max(sub_segment_l1) as  sub_segment_l1,max(sub_segment_l2) as sub_segment_l2 \nfrom prj_optimus_prd.mt_optimus_customer_segment_hierarchy\ngroup by zbpc_sgmt) s\non t.zbpc_sgmt=s.zbpc_sgmt \njoin prj_optimus_prd.mt_optimus_product as op\non t.zbpc_pgrp=op.bpc_code",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18856565_0_0_data_5",
          "node_type": "data",
          "abstracted_path": "/prj_optimus_prd/mt_optimus_product",
          "storage_type": "spark",
          "urn": "spark://prj_optimus_prd/mt_optimus_product",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-25 10:19:43",
          "job_end_time": "2019-04-25 10:20:13",
          "job_start_unix_time": 1556158783,
          "job_end_unix_time": 1556158813,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 18856565,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "prj_optimus_prd",
          "tbl_name": "mt_optimus_product",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "5",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18856567_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "leap_182:Optimus_BPC_Calculate_copy_03/ACT",
          "job_name": "ACT",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-25 10:20:39",
          "job_end_time": "2019-04-25 10:21:37",
          "job_start_unix_time": 1556158839,
          "job_end_unix_time": 1556158897,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 18856567,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_Optimus",
          "owner_id": "houqn1",
          "ref_id": "18560",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "Insert overwrite table prj_optimus_qas.BPC_DETAIL_TMP20190424 partition(partition_case='ACT')\nselect \nt.quarter,\nt.fiscper,\n'ACT' as bpc_item,\nt.zbpc_case as bpc_case,\nc.geo,\nc.region_or_market,\nt.zbpc_geo as bpc_country,\nc.country,\nt.zbpc_sgmt as ww_bpc_segment,\ns.segment,\ns.sub_segment_l1,\ns.sub_segment_l2,\nt.zbpc_pgrp as bpc_pgrp,\nop.biz_group,\nop.biz_unit_l1,\nop.biz_unit_l2,\nop.high_growth_l1, \nop.high_growth_l2,\nt.acct_parents as bpc_parents,\nt.account_kpi,\nt.kpi_value,\n0 AS Last_Year_kpi_value\nfrom  \n(SELECT p.quarter,p.fiscper,zbpc_geo,zbpc_sgmt,zbpc_pgrp,zbpc_case,a.acct_parents,a.account_kpi,\nsum(a.value*zbpc_data) as kpi_value\nFROM cdl_finance.bw_fin_coobps02l_cdl bpc\njoin  prj_optimus_prd.mt_optimus_fiscal_period p\non  bpc.zbpc_time=p.bpc_time_mth \njoin prj_optimus_prd.mt_optimus_account_mapping a\non  bpc.zbpc_acct=a.bpc_acct\nwhere  p.quarter>'FY1617Q4' and ((zbpc_case='ACTQ' and substr(p.quarter,1,6)='${cur_fy}' ) \nOR (zbpc_case='RACT' and substr(p.quarter,1,6)<'${cur_fy}'))    \nand  length(zbpc_time)=8 and zbpc_chan = 'TOTCHANNEL'  \ngroup by p.quarter,p.fiscper,zbpc_geo,zbpc_sgmt,zbpc_pgrp,zbpc_case,a.acct_parents,a.account_kpi) t\njoin (select zbpc_geo,max(geo) as geo,max(region_or_market) as region_or_market,max(country) as country \nfrom  prj_optimus_prd.mt_optimus_country group by zbpc_geo )c\non t.zbpc_geo=c.zbpc_geo\njoin (select zbpc_sgmt,max(segment)as segment,max(sub_segment_l1) as  sub_segment_l1,max(sub_segment_l2) as sub_segment_l2 \nfrom prj_optimus_prd.mt_optimus_customer_segment_hierarchy\ngroup by zbpc_sgmt) s\non t.zbpc_sgmt=s.zbpc_sgmt \njoin prj_optimus_prd.mt_optimus_product as op\non t.zbpc_pgrp=op.bpc_code",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18900947_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "leap_182:Optimus_BPC_Calculate_new20190425/IDC",
          "job_name": "IDC",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-26 05:21:45",
          "job_end_time": "2019-04-26 05:22:24",
          "job_start_unix_time": 1556227305,
          "job_end_unix_time": 1556227344,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 18900947,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_Optimus",
          "owner_id": "houqn1",
          "ref_id": "18560",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "Insert overwrite table prj_optimus_prd.optimus_bpc_detail partition(partition_case='IDC')\nselect \nt.quarter,\nt.fiscper,\nt.zbpc_case as bpc_item,\nt.zbpc_case as bpc_case,\nc.geo,\nc.region_or_market,\nt.zbpc_geo as bpc_country,\nc.country,\nt.zbpc_sgmt as ww_bpc_segment,\ns.segment,\ns.sub_segment_l1,\ns.sub_segment_l2,\nt.zbpc_pgrp as bpc_pgrp,\nop.biz_group,\nop.biz_unit_l1,\nop.biz_unit_l2,\nop.high_growth_l1, \nop.high_growth_l2,\nt.acct_parents as bpc_parents,\nt.account_kpi,\nt.kpi_value,\n0 AS Last_Year_kpi_value\nfrom  \n(SELECT p.quarter,p.fiscper,zbpc_geo,zbpc_sgmt,zbpc_pgrp,zbpc_case,a.acct_parents,a.account_kpi,\nsum(a.value*zbpc_data) as kpi_value\nFROM cdl_finance.bw_fin_coobps02l_cdl bpc\njoin  prj_optimus_prd.mt_optimus_fiscal_period p\non  bpc.zbpc_time=p.bpc_time_mth \njoin prj_optimus_prd.mt_optimus_account_mapping a\non  bpc.zbpc_acct=a.bpc_acct\nwhere  p.quarter>'FY1617Q4'  and zbpc_case='IDC' and  length(zbpc_time)=8 and zbpc_chan = 'TOTCHANNEL'  \ngroup by p.quarter,p.fiscper,zbpc_geo,zbpc_sgmt,zbpc_pgrp,zbpc_case,a.acct_parents,a.account_kpi) t\njoin (select zbpc_geo,max(geo) as geo,max(region_or_market) as region_or_market,max(country) as country \nfrom  prj_optimus_prd.mt_optimus_country group by zbpc_geo )c\non t.zbpc_geo=c.zbpc_geo\njoin (select zbpc_sgmt,max(segment)as segment,max(sub_segment_l1) as  sub_segment_l1,max(sub_segment_l2) as sub_segment_l2 \nfrom prj_optimus_prd.mt_optimus_customer_segment_hierarchy\ngroup by zbpc_sgmt) s\non t.zbpc_sgmt=s.zbpc_sgmt \njoin prj_optimus_prd.mt_optimus_product as op\non t.zbpc_pgrp=op.bpc_code",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18900949_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "leap_182:Optimus_BPC_Calculate_new20190425/ACT",
          "job_name": "ACT",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-26 05:23:05",
          "job_end_time": "2019-04-26 05:24:05",
          "job_start_unix_time": 1556227385,
          "job_end_unix_time": 1556227445,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 18900949,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_Optimus",
          "owner_id": "houqn1",
          "ref_id": "18560",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "with fc_period as (\nselect zbpc_case,zbpc_time from \n(select  zbpc_case,zbpc_time,\nrow_number() over(partition by zbpc_time order by zbpc_case desc ) as rn\nfrom (SELECT distinct zbpc_case,zbpc_time FROM cdl_finance.bw_fin_coobps02l_cdl\nwhere length(zbpc_time)=8 and  zbpc_chan = 'TOTCHANNEL' ) t\nwhere t.zbpc_case in ('RACT','ACTQ','ACT') ) t1\nwhere   t1.rn=1\n)\nInsert overwrite table prj_optimus_prd.optimus_bpc_detail\npartition(partition_case='ACT')\nselect \nt.quarter,\nt.fiscper,\n'ACT' as bpc_item,\nt.zbpc_case as bpc_case,\nc.geo,\nc.region_or_market,\nt.zbpc_geo as bpc_country,\nc.country,\nt.zbpc_sgmt as ww_bpc_segment,\ns.segment,\ns.sub_segment_l1,\ns.sub_segment_l2,\nt.zbpc_pgrp as bpc_pgrp,\nop.biz_group,\nop.biz_unit_l1,\nop.biz_unit_l2,\nop.high_growth_l1, \nop.high_growth_l2,\nt.acct_parents as bpc_parents,\nt.account_kpi,\nt.kpi_value,\n0 AS Last_Year_kpi_value\nfrom  \n(SELECT p.quarter,p.fiscper,zbpc_geo,zbpc_sgmt,zbpc_pgrp,bpc.zbpc_case,a.acct_parents,a.account_kpi,\nsum(a.value*zbpc_data) as kpi_value\nFROM cdl_finance.bw_fin_coobps02l_cdl bpc\njoin fc_period\non bpc.zbpc_time=fc_period.zbpc_time and bpc.zbpc_case=fc_period.zbpc_case\njoin  prj_optimus_prd.mt_optimus_fiscal_period p\non  bpc.zbpc_time=p.bpc_time_mth \njoin prj_optimus_prd.mt_optimus_account_mapping a\non  bpc.zbpc_acct=a.bpc_acct\nwhere  p.quarter>'FY1617Q4' and zbpc_chan = 'TOTCHANNEL'  \ngroup by p.quarter,p.fiscper,zbpc_geo,zbpc_sgmt,zbpc_pgrp,bpc.zbpc_case,a.acct_parents,a.account_kpi) t\njoin (select zbpc_geo,max(geo) as geo,max(region_or_market) as region_or_market,max(country) as country \nfrom  prj_optimus_prd.mt_optimus_country group by zbpc_geo )c\non t.zbpc_geo=c.zbpc_geo\njoin (select zbpc_sgmt,max(segment)as segment,max(sub_segment_l1) as  sub_segment_l1,max(sub_segment_l2) as sub_segment_l2 \nfrom prj_optimus_prd.mt_optimus_customer_segment_hierarchy\ngroup by zbpc_sgmt) s\non t.zbpc_sgmt=s.zbpc_sgmt \njoin prj_optimus_prd.mt_optimus_product as op\non t.zbpc_pgrp=op.bpc_code",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "19554665_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "leap_182:Optimus_BPC_Calculate/IDC",
          "job_name": "IDC",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-08 05:03:20",
          "job_end_time": "2019-05-08 05:03:55",
          "job_start_unix_time": 1557263000,
          "job_end_unix_time": 1557263035,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 19554665,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_Optimus",
          "owner_id": "houqn1",
          "ref_id": "18560",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "Insert overwrite table prj_optimus_prd.optimus_bpc_detail partition(partition_case='IDC')\nselect \nt.quarter,\nt.fiscper,\nt.zbpc_case as bpc_item,\nt.zbpc_case as bpc_case,\nc.geo,\nc.region_or_market,\nt.zbpc_geo as bpc_country,\nc.country,\nt.zbpc_sgmt as ww_bpc_segment,\ns.segment,\ns.sub_segment_l1,\ns.sub_segment_l2,\nt.zbpc_pgrp as bpc_pgrp,\nop.biz_group,\nop.biz_unit_l1,\nop.biz_unit_l2,\nop.high_growth_l1, \nop.high_growth_l2,\nt.acct_parents as bpc_parents,\nt.account_kpi,\nt.kpi_value,\n0 AS Last_Year_kpi_value\nfrom  \n(SELECT p.quarter,p.fiscper,zbpc_geo,zbpc_sgmt,zbpc_pgrp,zbpc_case,a.acct_parents,a.account_kpi,\nsum(a.value*zbpc_data) as kpi_value\nFROM cdl_finance.bw_fin_coobps02l_cdl bpc\njoin  prj_optimus_prd.mt_optimus_fiscal_period p\non  bpc.zbpc_time=p.bpc_time_mth \njoin prj_optimus_prd.mt_optimus_account_mapping a\non  bpc.zbpc_acct=a.bpc_acct\nwhere  p.quarter>'FY1617Q4'  and zbpc_case='IDC' and  length(zbpc_time)=8 and zbpc_chan = 'TOTCHANNEL'  \ngroup by p.quarter,p.fiscper,zbpc_geo,zbpc_sgmt,zbpc_pgrp,zbpc_case,a.acct_parents,a.account_kpi) t\njoin (select zbpc_geo,max(geo) as geo,max(region_or_market) as region_or_market,max(country) as country \nfrom  prj_optimus_prd.mt_optimus_country group by zbpc_geo )c\non t.zbpc_geo=c.zbpc_geo\njoin (select zbpc_sgmt,max(segment)as segment,max(sub_segment_l1) as  sub_segment_l1,max(sub_segment_l2) as sub_segment_l2 \nfrom prj_optimus_prd.mt_optimus_customer_segment_hierarchy\ngroup by zbpc_sgmt) s\non t.zbpc_sgmt=s.zbpc_sgmt \njoin prj_optimus_prd.mt_optimus_product as op\non t.zbpc_pgrp=op.bpc_code",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "19554667_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "leap_182:Optimus_BPC_Calculate/ACT",
          "job_name": "ACT",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-08 05:04:45",
          "job_end_time": "2019-05-08 05:05:48",
          "job_start_unix_time": 1557263085,
          "job_end_unix_time": 1557263148,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 19554667,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_Optimus",
          "owner_id": "houqn1",
          "ref_id": "18560",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "with fc_period as (\nselect zbpc_case,zbpc_time from \n(select  zbpc_case,zbpc_time,\nrow_number() over(partition by zbpc_time order by zbpc_case desc ) as rn\nfrom (SELECT distinct zbpc_case,zbpc_time FROM cdl_finance.bw_fin_coobps02l_cdl\nwhere length(zbpc_time)=8 and  zbpc_chan = 'TOTCHANNEL' ) t\nwhere t.zbpc_case in ('RACT','ACTQ','ACT') ) t1\nwhere   t1.rn=1\n)\nInsert overwrite table prj_optimus_prd.optimus_bpc_detail\npartition(partition_case='ACT')\nselect \nt.quarter,\nt.fiscper,\n'ACT' as bpc_item,\nt.zbpc_case as bpc_case,\nc.geo,\nc.region_or_market,\nt.zbpc_geo as bpc_country,\nc.country,\nt.zbpc_sgmt as ww_bpc_segment,\ns.segment,\ns.sub_segment_l1,\ns.sub_segment_l2,\nt.zbpc_pgrp as bpc_pgrp,\nop.biz_group,\nop.biz_unit_l1,\nop.biz_unit_l2,\nop.high_growth_l1, \nop.high_growth_l2,\nt.acct_parents as bpc_parents,\nt.account_kpi,\nt.kpi_value,\n0 AS Last_Year_kpi_value\nfrom  \n(SELECT p.quarter,p.fiscper,zbpc_geo,zbpc_sgmt,zbpc_pgrp,bpc.zbpc_case,a.acct_parents,a.account_kpi,\nsum(a.value*zbpc_data) as kpi_value\nFROM cdl_finance.bw_fin_coobps02l_cdl bpc\njoin fc_period\non bpc.zbpc_time=fc_period.zbpc_time and bpc.zbpc_case=fc_period.zbpc_case\njoin  prj_optimus_prd.mt_optimus_fiscal_period p\non  bpc.zbpc_time=p.bpc_time_mth \njoin prj_optimus_prd.mt_optimus_account_mapping a\non  bpc.zbpc_acct=a.bpc_acct\nwhere  p.quarter>'FY1617Q4' and zbpc_chan = 'TOTCHANNEL'  \ngroup by p.quarter,p.fiscper,zbpc_geo,zbpc_sgmt,zbpc_pgrp,bpc.zbpc_case,a.acct_parents,a.account_kpi) t\njoin (select zbpc_geo,max(geo) as geo,max(region_or_market) as region_or_market,max(country) as country \nfrom  prj_optimus_prd.mt_optimus_country group by zbpc_geo )c\non t.zbpc_geo=c.zbpc_geo\njoin (select zbpc_sgmt,max(segment)as segment,max(sub_segment_l1) as  sub_segment_l1,max(sub_segment_l2) as sub_segment_l2 \nfrom prj_optimus_prd.mt_optimus_customer_segment_hierarchy\ngroup by zbpc_sgmt) s\non t.zbpc_sgmt=s.zbpc_sgmt \njoin prj_optimus_prd.mt_optimus_product as op\non t.zbpc_pgrp=op.bpc_code",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "19466510_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "hive",
          "cluster": null,
          "project_name": null,
          "job_path": "leap_182:Optimus_BPC_Calculate_MR_Test/IDC",
          "job_name": "IDC",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-06 14:57:14",
          "job_end_time": "2019-05-06 15:01:23",
          "job_start_unix_time": 1557125834,
          "job_end_unix_time": 1557126083,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 19466510,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_Optimus",
          "owner_id": "wuth3",
          "ref_id": "18727",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "Insert overwrite table prj_optimus_prd.optimus_bpc_detail partition(partition_case='IDC')\nselect \nt.quarter,\nt.fiscper,\nt.zbpc_case as bpc_item,\nt.zbpc_case as bpc_case,\nc.geo,\nc.region_or_market,\nt.zbpc_geo as bpc_country,\nc.country,\nt.zbpc_sgmt as ww_bpc_segment,\ns.segment,\ns.sub_segment_l1,\ns.sub_segment_l2,\nt.zbpc_pgrp as bpc_pgrp,\nop.biz_group,\nop.biz_unit_l1,\nop.biz_unit_l2,\nop.high_growth_l1, \nop.high_growth_l2,\nt.acct_parents as bpc_parents,\nt.account_kpi,\nt.kpi_value,\n0 AS Last_Year_kpi_value\nfrom  \n(SELECT p.quarter,p.fiscper,zbpc_geo,zbpc_sgmt,zbpc_pgrp,zbpc_case,a.acct_parents,a.account_kpi,\nsum(a.value*zbpc_data) as kpi_value\nFROM cdl_finance.bw_fin_coobps02l_cdl bpc\njoin  prj_optimus_prd.mt_optimus_fiscal_period p\non  bpc.zbpc_time=p.bpc_time_mth \njoin prj_optimus_prd.mt_optimus_account_mapping a\non  bpc.zbpc_acct=a.bpc_acct\nwhere  p.quarter>'FY1617Q4'  and zbpc_case='IDC' and  length(zbpc_time)=8 and zbpc_chan = 'TOTCHANNEL'  \ngroup by p.quarter,p.fiscper,zbpc_geo,zbpc_sgmt,zbpc_pgrp,zbpc_case,a.acct_parents,a.account_kpi) t\njoin (select zbpc_geo,max(geo) as geo,max(region_or_market) as region_or_market,max(country) as country \nfrom  prj_optimus_prd.mt_optimus_country group by zbpc_geo )c\non t.zbpc_geo=c.zbpc_geo\njoin (select zbpc_sgmt,max(segment)as segment,max(sub_segment_l1) as  sub_segment_l1,max(sub_segment_l2) as sub_segment_l2 \nfrom prj_optimus_prd.mt_optimus_customer_segment_hierarchy\ngroup by zbpc_sgmt) s\non t.zbpc_sgmt=s.zbpc_sgmt \njoin prj_optimus_prd.mt_optimus_product as op\non t.zbpc_pgrp=op.bpc_code",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "19466514_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "hive",
          "cluster": null,
          "project_name": null,
          "job_path": "leap_182:Optimus_BPC_Calculate_MR_Test/ACT",
          "job_name": "ACT",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-06 15:02:06",
          "job_end_time": "2019-05-06 15:17:42",
          "job_start_unix_time": 1557126126,
          "job_end_unix_time": 1557127062,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 19466514,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_Optimus",
          "owner_id": "wuth3",
          "ref_id": "18727",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "with fc_period as (\nselect zbpc_case,zbpc_time from \n(select  zbpc_case,zbpc_time,\nrow_number() over(partition by zbpc_time order by zbpc_case desc ) as rn\nfrom (SELECT distinct zbpc_case,zbpc_time FROM cdl_finance.bw_fin_coobps02l_cdl\nwhere length(zbpc_time)=8 and  zbpc_chan = 'TOTCHANNEL' ) t\nwhere t.zbpc_case in ('RACT','ACTQ','ACT') ) t1\nwhere   t1.rn=1\n)\nInsert overwrite table prj_optimus_prd.optimus_bpc_detail\npartition(partition_case='ACT')\nselect \nt.quarter,\nt.fiscper,\n'ACT' as bpc_item,\nt.zbpc_case as bpc_case,\nc.geo,\nc.region_or_market,\nt.zbpc_geo as bpc_country,\nc.country,\nt.zbpc_sgmt as ww_bpc_segment,\ns.segment,\ns.sub_segment_l1,\ns.sub_segment_l2,\nt.zbpc_pgrp as bpc_pgrp,\nop.biz_group,\nop.biz_unit_l1,\nop.biz_unit_l2,\nop.high_growth_l1, \nop.high_growth_l2,\nt.acct_parents as bpc_parents,\nt.account_kpi,\nt.kpi_value,\n0 AS Last_Year_kpi_value\nfrom  \n(SELECT p.quarter,p.fiscper,zbpc_geo,zbpc_sgmt,zbpc_pgrp,bpc.zbpc_case,a.acct_parents,a.account_kpi,\nsum(a.value*zbpc_data) as kpi_value\nFROM cdl_finance.bw_fin_coobps02l_cdl bpc\njoin fc_period\non bpc.zbpc_time=fc_period.zbpc_time and bpc.zbpc_case=fc_period.zbpc_case\njoin  prj_optimus_prd.mt_optimus_fiscal_period p\non  bpc.zbpc_time=p.bpc_time_mth \njoin prj_optimus_prd.mt_optimus_account_mapping a\non  bpc.zbpc_acct=a.bpc_acct\nwhere  p.quarter>'FY1617Q4' and zbpc_chan = 'TOTCHANNEL'  \ngroup by p.quarter,p.fiscper,zbpc_geo,zbpc_sgmt,zbpc_pgrp,bpc.zbpc_case,a.acct_parents,a.account_kpi) t\njoin (select zbpc_geo,max(geo) as geo,max(region_or_market) as region_or_market,max(country) as country \nfrom  prj_optimus_prd.mt_optimus_country group by zbpc_geo )c\non t.zbpc_geo=c.zbpc_geo\njoin (select zbpc_sgmt,max(segment)as segment,max(sub_segment_l1) as  sub_segment_l1,max(sub_segment_l2) as sub_segment_l2 \nfrom prj_optimus_prd.mt_optimus_customer_segment_hierarchy\ngroup by zbpc_sgmt) s\non t.zbpc_sgmt=s.zbpc_sgmt \njoin prj_optimus_prd.mt_optimus_product as op\non t.zbpc_pgrp=op.bpc_code",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20267187_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PRJ_Optimus:Optimus_BPC_Calculate/IDC",
          "job_name": "IDC",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 05:10:56",
          "job_end_time": "2019-05-22 05:11:31",
          "job_start_unix_time": 1558473056,
          "job_end_unix_time": 1558473091,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20267187,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_Optimus",
          "owner_id": "houqn1",
          "ref_id": "18560",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "Insert overwrite table prj_optimus_prd.optimus_bpc_detail partition(partition_case='IDC')\nselect \nt.quarter,\nt.fiscper,\nt.zbpc_case as bpc_item,\nt.zbpc_case as bpc_case,\nc.geo,\nc.region_or_market,\nt.zbpc_geo as bpc_country,\nc.country,\nt.zbpc_sgmt as ww_bpc_segment,\ns.segment,\ns.sub_segment_l1,\ns.sub_segment_l2,\nt.zbpc_pgrp as bpc_pgrp,\nop.biz_group,\nop.biz_unit_l1,\nop.biz_unit_l2,\nop.high_growth_l1, \nop.high_growth_l2,\nt.acct_parents as bpc_parents,\nt.account_kpi,\nt.kpi_value,\n0 AS Last_Year_kpi_value\nfrom  \n(SELECT p.quarter,p.fiscper,zbpc_geo,zbpc_sgmt,zbpc_pgrp,zbpc_case,a.acct_parents,a.account_kpi,\nsum(a.value*zbpc_data) as kpi_value\nFROM cdl_finance.bw_fin_coobps02l_cdl bpc\njoin  prj_optimus_prd.mt_optimus_fiscal_period p\non  bpc.zbpc_time=p.bpc_time_mth \njoin prj_optimus_prd.mt_optimus_account_mapping a\non  bpc.zbpc_acct=a.bpc_acct\nwhere  p.quarter>'FY1617Q4'  and zbpc_case='IDC' and  length(zbpc_time)=8 and zbpc_chan = 'TOTCHANNEL'  \ngroup by p.quarter,p.fiscper,zbpc_geo,zbpc_sgmt,zbpc_pgrp,zbpc_case,a.acct_parents,a.account_kpi) t\njoin (select zbpc_geo,max(geo) as geo,max(region_or_market) as region_or_market,max(country) as country \nfrom  prj_optimus_prd.mt_optimus_country group by zbpc_geo )c\non t.zbpc_geo=c.zbpc_geo\njoin (select zbpc_sgmt,max(segment)as segment,max(sub_segment_l1) as  sub_segment_l1,max(sub_segment_l2) as sub_segment_l2 \nfrom prj_optimus_prd.mt_optimus_customer_segment_hierarchy\ngroup by zbpc_sgmt) s\non t.zbpc_sgmt=s.zbpc_sgmt \njoin prj_optimus_prd.mt_optimus_product as op\non t.zbpc_pgrp=op.bpc_code",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20267189_0_0_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PRJ_Optimus:Optimus_BPC_Calculate/ACT",
          "job_name": "ACT",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 05:11:46",
          "job_end_time": "2019-05-22 05:12:54",
          "job_start_unix_time": 1558473106,
          "job_end_unix_time": 1558473174,
          "level": 0,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20267189,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_Optimus",
          "owner_id": "houqn1",
          "ref_id": "18560",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "with fc_period as (\nselect zbpc_case,zbpc_time from \n(select  zbpc_case,zbpc_time,\nrow_number() over(partition by zbpc_time order by zbpc_case desc ) as rn\nfrom (SELECT distinct zbpc_case,zbpc_time FROM cdl_finance.bw_fin_coobps02l_cdl\nwhere length(zbpc_time)=8 and  zbpc_chan = 'TOTCHANNEL' ) t\nwhere t.zbpc_case in ('RACT','ACTQ','ACT') ) t1\nwhere   t1.rn=1\n)\nInsert overwrite table prj_optimus_prd.optimus_bpc_detail\npartition(partition_case='ACT')\nselect \nt.quarter,\nt.fiscper,\n'ACT' as bpc_item,\nt.zbpc_case as bpc_case,\nc.geo,\nc.region_or_market,\nt.zbpc_geo as bpc_country,\nc.country,\nt.zbpc_sgmt as ww_bpc_segment,\ns.segment,\ns.sub_segment_l1,\ns.sub_segment_l2,\nt.zbpc_pgrp as bpc_pgrp,\nop.biz_group,\nop.biz_unit_l1,\nop.biz_unit_l2,\nop.high_growth_l1, \nop.high_growth_l2,\nt.acct_parents as bpc_parents,\nt.account_kpi,\nt.kpi_value,\n0 AS Last_Year_kpi_value\nfrom  \n(SELECT p.quarter,p.fiscper,zbpc_geo,zbpc_sgmt,zbpc_pgrp,bpc.zbpc_case,a.acct_parents,a.account_kpi,\nsum(a.value*zbpc_data) as kpi_value\nFROM cdl_finance.bw_fin_coobps02l_cdl bpc\njoin fc_period\non bpc.zbpc_time=fc_period.zbpc_time and bpc.zbpc_case=fc_period.zbpc_case\njoin  prj_optimus_prd.mt_optimus_fiscal_period p\non  bpc.zbpc_time=p.bpc_time_mth \njoin prj_optimus_prd.mt_optimus_account_mapping a\non  bpc.zbpc_acct=a.bpc_acct\nwhere  p.quarter>'FY1617Q4' and zbpc_chan = 'TOTCHANNEL'  \ngroup by p.quarter,p.fiscper,zbpc_geo,zbpc_sgmt,zbpc_pgrp,bpc.zbpc_case,a.acct_parents,a.account_kpi) t\njoin (select zbpc_geo,max(geo) as geo,max(region_or_market) as region_or_market,max(country) as country \nfrom  prj_optimus_prd.mt_optimus_country group by zbpc_geo )c\non t.zbpc_geo=c.zbpc_geo\njoin (select zbpc_sgmt,max(segment)as segment,max(sub_segment_l1) as  sub_segment_l1,max(sub_segment_l2) as sub_segment_l2 \nfrom prj_optimus_prd.mt_optimus_customer_segment_hierarchy\ngroup by zbpc_sgmt) s\non t.zbpc_sgmt=s.zbpc_sgmt \njoin prj_optimus_prd.mt_optimus_product as op\non t.zbpc_pgrp=op.bpc_code",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18856566_0_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "leap_182:Optimus_BPC_Calculate_copy_03/IDC_YOY",
          "job_name": "IDC_YOY",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-25 10:20:13",
          "job_end_time": "2019-04-25 10:20:39",
          "job_start_unix_time": 1556158813,
          "job_end_unix_time": 1556158839,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 18856566,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_Optimus",
          "owner_id": "houqn1",
          "ref_id": "18560",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "Insert overwrite table prj_optimus_qas.BPC_DETAIL_TMP20190424 partition(partition_case='IDC')\nselect \n    quarter,\n    fiscper,\n    bpc_item,\n    bpc_case,\n    geo,\n    region_or_market,\n    bpc_country,\n    country,\n    ww_bpc_segment,\n    segment,\n    sub_segment_l1,\n    sub_segment_l2,\n    bpc_pgrp,\n    biz_group,\n    biz_unit_l1,\n    biz_unit_l2,\n    high_growth_l1, \n    high_growth_l2,\n    bpc_parents,\n    account_kpi,\n    sum(kpi_value) as kpi_value,\n    sum(Last_Year_kpi_value) as Last_Year_kpi_value\nfrom (select \n        t.quarter,\n        t.fiscper,\n        t.bpc_item,\n        t.bpc_case,\n        t.geo,\n        t.region_or_market,\n        t.bpc_country,\n        t.country,\n        t.ww_bpc_segment,\n        t.segment,\n        t.sub_segment_l1,\n        t.sub_segment_l2,\n        t.bpc_pgrp,\n        t.biz_group,\n        t.biz_unit_l1,\n        t.biz_unit_l2,\n        t.high_growth_l1, \n        t.high_growth_l2, \n        t.bpc_parents,\n        t.account_kpi,\n        t.kpi_value,\n        0 as Last_Year_kpi_value\n       from prj_optimus_qas.BPC_DETAIL_TMP20190424 as t\n      WHERE partition_case='IDC' and quarter>='${pre_y_qtr}'\n        union all\n      select \n        CONCAT('FY',CAST(substr(t.quarter,3,2)+1 AS INT),cast(substr(t.quarter,5,2)+1 AS INT),substr(t.quarter,7,2)) AS quarter,\n        concat(cast(substr(t.fiscper,1,4)+1 as int),substr(t.fiscper,5,3)) as fiscper,\n        t.bpc_item,\n        t.bpc_case,\n        t.geo,\n        t.region_or_market,\n        t.bpc_country,\n        t.country,\n        t.ww_bpc_segment,\n        t.segment,\n        t.sub_segment_l1,\n        t.sub_segment_l2,\n        t.bpc_pgrp,\n        t.biz_group,\n        t.biz_unit_l1,\n        t.biz_unit_l2,\n        t.high_growth_l1, \n        t.high_growth_l2, \n        t.bpc_parents,\n        t.account_kpi,\n        0 as kpi_value,\n        t.kpi_value as Last_Year_kpi_value\n       from prj_optimus_qas.BPC_DETAIL_TMP20190424 as t\n      WHERE partition_case='IDC' and  quarter<='${pre_y_qtr}') as a \ngroup by \n    quarter,\n    fiscper,\n    bpc_item,\n    bpc_case,\n    geo,\n    region_or_market,\n    bpc_country,\n    country,\n    ww_bpc_segment,\n    segment,\n    sub_segment_l1,\n    sub_segment_l2,\n    bpc_pgrp,\n    biz_group,\n    biz_unit_l1,\n    biz_unit_l2,\n    high_growth_l1, \n    high_growth_l2, \n    bpc_parents,\n    account_kpi",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18856566_0_-1_data_0",
          "node_type": "data",
          "abstracted_path": "/prj_optimus_qas/bpc_detail_tmp20190424",
          "storage_type": "spark",
          "urn": "spark://prj_optimus_qas/bpc_detail_tmp20190424",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-25 10:20:13",
          "job_end_time": "2019-04-25 10:20:39",
          "job_start_unix_time": 1556158813,
          "job_end_unix_time": 1556158839,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 18856566,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "prj_optimus_qas",
          "tbl_name": "bpc_detail_tmp20190424",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "0",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18856572_0_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "leap_182:Optimus_BPC_Calculate_copy_03/ACT_YOY",
          "job_name": "ACT_YOY",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-25 10:21:37",
          "job_end_time": "2019-04-25 10:22:14",
          "job_start_unix_time": 1556158897,
          "job_end_unix_time": 1556158934,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 18856572,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_Optimus",
          "owner_id": "houqn1",
          "ref_id": "18560",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "Insert overwrite table prj_optimus_qas.BPC_DETAIL_TMP20190424 partition(partition_case='ACT')\nselect \n    quarter,\n    fiscper,\n    bpc_item,\n    max(bpc_case),\n    geo,\n    region_or_market,\n    bpc_country,\n    country,\n    ww_bpc_segment,\n    segment,\n    sub_segment_l1,\n    sub_segment_l2,\n    bpc_pgrp,\n    biz_group,\n    biz_unit_l1,\n    biz_unit_l2,\n    high_growth_l1, \n    high_growth_l2,\n    bpc_parents,\n    account_kpi,\n    sum(kpi_value) as kpi_value,\n    sum(Last_Year_kpi_value) as Last_Year_kpi_value\nfrom (select \n        t.quarter,\n        t.fiscper,\n        t.bpc_item,\n        t.bpc_case,\n        t.geo,\n        t.region_or_market,\n        t.bpc_country,\n        t.country,\n        t.ww_bpc_segment,\n        t.segment,\n        t.sub_segment_l1,\n        t.sub_segment_l2,\n        t.bpc_pgrp,\n        t.biz_group,\n        t.biz_unit_l1,\n        t.biz_unit_l2,\n        t.high_growth_l1, \n        t.high_growth_l2, \n        t.bpc_parents,\n        t.account_kpi,\n        t.kpi_value,\n        0 as Last_Year_kpi_value\n       from prj_optimus_qas.BPC_DETAIL_TMP20190424 as t\n      WHERE partition_case='ACT' and  quarter>='${pre_y_qtr}' \n        union all\n      select \n        CONCAT('FY',CAST(substr(t.quarter,3,2)+1 AS INT),cast(substr(t.quarter,5,2)+1 AS INT),substr(t.quarter,7,2)) AS quarter,\n        concat(cast(substr(t.fiscper,1,4)+1 as int),substr(t.fiscper,5,3)) as fiscper,\n        t.bpc_item,\n        t.bpc_case,\n        t.geo,\n        t.region_or_market,\n        t.bpc_country,\n        t.country,\n        t.ww_bpc_segment,\n        t.segment,\n        t.sub_segment_l1,\n        t.sub_segment_l2,\n        t.bpc_pgrp,\n        t.biz_group,\n        t.biz_unit_l1,\n        t.biz_unit_l2,\n        t.high_growth_l1, \n        t.high_growth_l2, \n        t.bpc_parents,\n        t.account_kpi,\n        0 as kpi_value,\n        t.kpi_value as Last_Year_kpi_value\n       from prj_optimus_qas.BPC_DETAIL_TMP20190424 as t\n      WHERE partition_case='ACT' and  quarter<='${pre_y_qtr}' ) as a\ngroup by \n    quarter,\n    fiscper,\n    bpc_item,\n    geo,\n    region_or_market,\n    bpc_country,\n    country,\n    ww_bpc_segment,\n    segment,\n    sub_segment_l1,\n    sub_segment_l2,\n    bpc_pgrp,\n    biz_group,\n    biz_unit_l1,\n    biz_unit_l2,\n    high_growth_l1, \n    high_growth_l2, \n    bpc_parents,\n    account_kpi",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18856572_0_-1_data_0",
          "node_type": "data",
          "abstracted_path": "/prj_optimus_qas/bpc_detail_tmp20190424",
          "storage_type": "spark",
          "urn": "spark://prj_optimus_qas/bpc_detail_tmp20190424",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-25 10:21:37",
          "job_end_time": "2019-04-25 10:22:14",
          "job_start_unix_time": 1556158897,
          "job_end_unix_time": 1556158934,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 18856572,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "prj_optimus_qas",
          "tbl_name": "bpc_detail_tmp20190424",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "0",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18856568_0_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "leap_182:Optimus_BPC_Calculate_copy_03/Final_BPC",
          "job_name": "Final_BPC",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-25 10:22:14",
          "job_end_time": "2019-04-25 10:25:11",
          "job_start_unix_time": 1556158934,
          "job_end_unix_time": 1556159111,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 18856568,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_Optimus",
          "owner_id": "houqn1",
          "ref_id": "18560",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "insert overwrite table prj_optimus_qas.optimus_final_bpc_tmp20190424\nselect\n  concat(substr(t.quarter,1,4),'/',substr(t.quarter,5,2)) as Fiscal_year,\n  substr(t.quarter,-2,2) as Q_no, \n  p.m_no,\n  t.quarter,\n  t.fiscper,\n  p2.quarter_no,\n  p.month_no,\n  bpc_item,\n  bpc_case,\n  geo,\n  region_or_market,\n  bpc_country,\n  t.country,\n  segment,\n  sub_segment_l1,\n  sub_segment_l2,\n  t.biz_group,\n  biz_unit_l1,\n  biz_unit_l2,\n  t.high_growth_l1,\n  t.high_growth_l2,\n  bpc_parents,\n  account_kpi,\n  sum(case when nvl(biz_unit_l1,'') != '' AND nvl(biz_unit_l2,'') != '' then nvl(kpi_value,0) else 0 end) as kpi_value,\n  SUM(Last_Year_kpi_value) AS Last_Year_kpi_value,\n  sum( case when bpc_parents='TOTCA' AND nvl(biz_unit_l1,'') != '' AND nvl(biz_unit_l2,'') != '' then nvl(kpi_value, 0) else 0 end )*1000 as BPC_CA,\n  sum( case when bpc_parents='TOTREV' AND nvl(biz_unit_l1,'') != '' AND nvl(biz_unit_l2,'') != '' then nvl(kpi_value, 0) else 0 end )*1000000 as BPC_Revenue,\n  sum( case when bpc_parents='BMC' AND nvl(biz_unit_l1,'') != '' AND nvl(biz_unit_l2,'') != '' then nvl(kpi_value, 0) else 0 end )*1000000 as BPC_BMC,\n  sum( case when bpc_parents='BMCGP' AND nvl(biz_unit_l1,'') != '' AND nvl(biz_unit_l2,'') != '' then nvl(kpi_value, 0) else 0 end )*1000000 as BPC_BMCGP,\n  sum( case when (bpc_parents='BMC' OR bpc_parents='TOTNBMC') AND nvl(biz_unit_l1,'') != '' AND nvl(biz_unit_l2,'') != '' then nvl(kpi_value, 0) else 0 end )*1000000 as BPC_TMC,\n  sum( case when bpc_parents='TOTGP' AND nvl(biz_unit_l1,'') != '' AND nvl(biz_unit_l2,'') != '' then nvl(kpi_value, 0) else 0 end )*1000000 as BPC_TMCGP,\n  sum( case when bpc_parents='TOTCA' and bpc_item='IDC' then nvl(Last_Year_kpi_value, 0) else 0 end )*1000 as Last_Year_IDC_CA,\n  sum( case when bpc_parents='TOTREV' and bpc_item='IDC' then nvl(Last_Year_kpi_value, 0) else 0 end )*1000000 as Last_Year_IDC_Revenue,\n  0 as track_ca,\n  0 as track_revenue,\n  0 as track_bmcgp,\n  0 as track_tmcgp,\n  0 as hg_track_ca,\n  0 as hg_track_revenue,\n  0 as hg_track_bmcgp,\n  0 as hg_track_tmcgp,\n  0 as track_pts,\n  0 as track_pts,\n  \n  sum( case when bpc_parents='TOTCA' and nvl(high_growth_l1,'') != '' and nvl(high_growth_l1,'') != '' then nvl(kpi_value, 0) else 0 end )*1000 as HG_BPC_CA,\n  sum( case when bpc_parents='TOTREV' and nvl(high_growth_l1,'') != '' and nvl(high_growth_l1,'') != '' then nvl(kpi_value, 0) else 0 end )*1000000 as HG_BPC_Revenue,\n  sum( case when bpc_parents='BMC' and nvl(high_growth_l1,'') != '' and nvl(high_growth_l1,'') != '' then nvl(kpi_value, 0) else 0 end )*1000000 as HG_BPC_BMC,\n  sum( case when bpc_parents='BMCGP' and nvl(high_growth_l1,'') != '' and nvl(high_growth_l1,'') != '' then nvl(kpi_value, 0) else 0 end )*1000000 as HG_BPC_BMCGP,\n  sum( case when (bpc_parents='BMC' OR bpc_parents='TOTNBMC')  and nvl(high_growth_l1,'') != '' and nvl(high_growth_l1,'') != '' then nvl(kpi_value, 0) else 0 end )*1000000 as HG_BPC_TMC,\n  sum( case when bpc_parents='TOTGP' and nvl(high_growth_l1,'') != '' and nvl(high_growth_l1,'') != '' then nvl(kpi_value, 0) else 0 end )*1000000 as HG_BPC_TMCGP,\n  sum(case when nvl(high_growth_l1,'') != '' and nvl(high_growth_l1,'') != '' then nvl(kpi_value,0) else 0 end) as hg_kpi_value\nfrom prj_optimus_qas.BPC_DETAIL_TMP20190424 t\nleft join prj_optimus_prd.mt_optimus_fiscal_period p\n  on p.fiscper=t.fiscper\nleft join(SELECT DISTINCT quarter,quarter_no FROM  prj_optimus_prd.mt_optimus_fiscal_period ) p2\n  on p2.quarter=t.quarter\nwhere t.quarter<='${cur_qtr}'\ngroup by\n  t.quarter,t.fiscper,p.m_no,p2.quarter_no,p.month_no,\n  bpc_item,bpc_case,\n  geo,region_or_market,bpc_country,t.country,\n  segment,sub_segment_l1,sub_segment_l2,\n  t.biz_group,biz_unit_l1,biz_unit_l2,t.high_growth_l1,t.high_growth_l2,\n  bpc_parents,account_kpi",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18856568_0_-1_data_2",
          "node_type": "data",
          "abstracted_path": "/prj_optimus_prd/mt_optimus_fiscal_period",
          "storage_type": "spark",
          "urn": "spark://prj_optimus_prd/mt_optimus_fiscal_period",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-25 10:22:14",
          "job_end_time": "2019-04-25 10:25:11",
          "job_start_unix_time": 1556158934,
          "job_end_unix_time": 1556159111,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 18856568,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "prj_optimus_prd",
          "tbl_name": "mt_optimus_fiscal_period",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "2",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18856568_0_-1_data_0",
          "node_type": "data",
          "abstracted_path": "/prj_optimus_qas/optimus_final_bpc_tmp20190424",
          "storage_type": "spark",
          "urn": "spark://prj_optimus_qas/optimus_final_bpc_tmp20190424",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-25 10:22:14",
          "job_end_time": "2019-04-25 10:25:11",
          "job_start_unix_time": 1556158934,
          "job_end_unix_time": 1556159111,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 18856568,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "prj_optimus_qas",
          "tbl_name": "optimus_final_bpc_tmp20190424",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "0",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288698_0_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Non_device_Revenue_all_DCG_Fact_Geo/T_Transformation_Non_device_Revenue_all_DCG_Fact_Geo",
          "job_name": "T_Transformation_Non_device_Revenue_all_DCG_Fact_Geo",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:41:03",
          "job_end_time": "2019-05-22 12:41:59",
          "job_start_unix_time": 1558500063,
          "job_end_unix_time": 1558500119,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288698,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16220",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "insert overwrite table proj_tx_kpi_prd.T_Transformation_Non_device_Revenue_all_DCG_Fact_Geo\n\nselect * from proj_tx_kpi_prd.T_Transformation_Non_device_Revenue_get_NOT_TOTCHANNEL_DCG_Fact_Geo\nunion all\nselect * from proj_tx_kpi_prd.T_Transformation_Non_device_Revenue_get_TOTCHANNEL_DCG_Fact_Geo\nunion all\nselect * from proj_tx_kpi_prd.T_Transformation_Non_device_Revenue_is_DCG_Fact_Geo\nunion all\nselect * from  proj_tx_kpi_prd.Hyperconverged_Adjustment_part_Fact_Geo\nunion all\nselect * from proj_tx_kpi_prd.SDS_Adjustment_part_Fact_Geo",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288698_0_-1_data_1",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_non_device_revenue_get_totchannel_dcg_fact_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_non_device_revenue_get_totchannel_dcg_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:41:03",
          "job_end_time": "2019-05-22 12:41:59",
          "job_start_unix_time": 1558500063,
          "job_end_unix_time": 1558500119,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20288698,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_non_device_revenue_get_totchannel_dcg_fact_geo",
          "sqlText": null,
          "datasetId": 4656065,
          "srl_no": "1",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288698_0_-1_data_2",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_non_device_revenue_is_dcg_fact_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_non_device_revenue_is_dcg_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:41:03",
          "job_end_time": "2019-05-22 12:41:59",
          "job_start_unix_time": 1558500063,
          "job_end_unix_time": 1558500119,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20288698,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_non_device_revenue_is_dcg_fact_geo",
          "sqlText": null,
          "datasetId": 4656069,
          "srl_no": "2",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288698_0_-1_data_4",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/hyperconverged_adjustment_part_fact_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/hyperconverged_adjustment_part_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:41:03",
          "job_end_time": "2019-05-22 12:41:59",
          "job_start_unix_time": 1558500063,
          "job_end_unix_time": 1558500119,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20288698,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "hyperconverged_adjustment_part_fact_geo",
          "sqlText": null,
          "datasetId": 4655906,
          "srl_no": "4",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288698_0_-1_data_5",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/sds_adjustment_part_fact_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/sds_adjustment_part_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:41:03",
          "job_end_time": "2019-05-22 12:41:59",
          "job_start_unix_time": 1558500063,
          "job_end_unix_time": 1558500119,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20288698,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "sds_adjustment_part_fact_geo",
          "sqlText": null,
          "datasetId": 4655960,
          "srl_no": "5",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288698_0_-1_data_0",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_non_device_revenue_all_dcg_fact_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_non_device_revenue_all_dcg_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:41:03",
          "job_end_time": "2019-05-22 12:41:59",
          "job_start_unix_time": 1558500063,
          "job_end_unix_time": 1558500119,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288698,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_non_device_revenue_all_dcg_fact_geo",
          "sqlText": null,
          "datasetId": 4656053,
          "srl_no": "0",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288723_0_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Bigdata_All/T_Transformation_Bigdata_All",
          "job_name": "T_Transformation_Bigdata_All",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:33:37",
          "job_end_time": "2019-05-22 12:34:14",
          "job_start_unix_time": 1558499617,
          "job_end_unix_time": 1558499654,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288723,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16340",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "insert overwrite table proj_tx_kpi_prd.T_Transformation_Bigdata_All_Middle\n\nselect \nzbpc_time\n,zbpc_Q\n,kpi_name\n,geo\n,bu\n, zbpc_data\n\nfrom\n(\n---------------------------------------------------------Big Data\nselect\nA.zbpc_time\n,A.zbpc_Q\n,'Big Data' as kpi_name\n,B.geo\n,B.bu\n,B.zbpc_data\nfrom\n(\nselect \nzbpc_time \n,case when substr(zbpc_time,6,2) in ('04','05','06') then concat(substr(zbpc_time,1,4),'.Q1')\n     when substr(zbpc_time,6,2) in ('07','08','09') then concat(substr(zbpc_time,1,4),'.Q2')\n     when substr(zbpc_time,6,2) in ('10','11','12') then concat(substr(zbpc_time,1,4),'.Q3')\n     when substr(zbpc_time,6,2) in ('01','02','03') then concat(cast((cast(substr(zbpc_time,1,4) as int) -1) as string),'.Q4')\n   end as zbpc_Q\nfrom proj_tx_kpi_prd.T_Transformation_Bigdata\ngroup by zbpc_time\norder by zbpc_time\ndesc \n)A\n\nleft join\n(\nselect \nzbpc_Q\n,kpi_name\n,geo\n,bu\n,sum(zbpc_data) as zbpc_data\nfrom\n(\nselect \ncase when substr(zbpc_time,6,2) in ('04','05','06') then concat(substr(zbpc_time,1,4),'.Q1')\n     when substr(zbpc_time,6,2) in ('07','08','09') then concat(substr(zbpc_time,1,4),'.Q2')\n     when substr(zbpc_time,6,2) in ('10','11','12') then concat(substr(zbpc_time,1,4),'.Q3')\n     when substr(zbpc_time,6,2) in ('01','02','03') then concat(cast((cast(substr(zbpc_time,1,4) as int) -1) as string),'.Q4')\n   end as zbpc_Q\n,kpi_name\n,geo\n,bu\n,zbpc_data\nfrom proj_tx_kpi_prd.T_Transformation_Bigdata \n)c\ngroup by\nzbpc_Q\n,kpi_name\n,geo\n,bu\norder by zbpc_Q\ndesc \n)B\non A.zbpc_Q=B.zbpc_Q\n\nunion all\n--------------------------------------------------------China GEO PCSD solution\nselect\nA.zbpc_time\n,A.zbpc_Q\n,'China GEO PCSD solution' as kpi_name\n,B.geo\n,B.bu\n,B.zbpc_data\nfrom\n(\nselect \nzbpc_time \n,case when substr(zbpc_time,6,2) in ('04','05','06') then concat(substr(zbpc_time,1,4),'.Q1')\n     when substr(zbpc_time,6,2) in ('07','08','09') then concat(substr(zbpc_time,1,4),'.Q2')\n     when substr(zbpc_time,6,2) in ('10','11','12') then concat(substr(zbpc_time,1,4),'.Q3')\n     when substr(zbpc_time,6,2) in ('01','02','03') then concat(cast((cast(substr(zbpc_time,1,4) as int) -1) as string),'.Q4')\n   end as zbpc_Q\nfrom proj_tx_kpi_prd.T_Transformation_China_geo\ngroup by zbpc_time\norder by zbpc_time\ndesc \n)A\n\nleft join\n(\nselect \nzbpc_Q\n,kpi_name\n,geo\n,bu\n,sum(zbpc_data) as zbpc_data\nfrom\n(\nselect \ncase when substr(zbpc_time,6,2) in ('04','05','06') then concat(substr(zbpc_time,1,4),'.Q1')\n     when substr(zbpc_time,6,2) in ('07','08','09') then concat(substr(zbpc_time,1,4),'.Q2')\n     when substr(zbpc_time,6,2) in ('10','11','12') then concat(substr(zbpc_time,1,4),'.Q3')\n     when substr(zbpc_time,6,2) in ('01','02','03') then concat(cast((cast(substr(zbpc_time,1,4) as int) -1) as string),'.Q4')\n   end as zbpc_Q\n,kpi_name\n,geo\n,bu\n,zbpc_data\nfrom proj_tx_kpi_prd.T_Transformation_China_geo \n)c\ngroup by\nzbpc_Q\n,kpi_name\n,geo\n,bu\norder by zbpc_Q\ndesc \n)B\non A.zbpc_Q=B.zbpc_Q\n\nunion all\n---------------------------------------------------Vertical Solution\nselect\nA.zbpc_time\n,A.zbpc_Q\n,'Vertical Solution' as kpi_name\n,B.geo\n,B.bu\n,B.zbpc_data\nfrom\n(\nselect \nzbpc_time \n,case when substr(zbpc_time,6,2) in ('04','05','06') then concat(substr(zbpc_time,1,4),'.Q1')\n     when substr(zbpc_time,6,2) in ('07','08','09') then concat(substr(zbpc_time,1,4),'.Q2')\n     when substr(zbpc_time,6,2) in ('10','11','12') then concat(substr(zbpc_time,1,4),'.Q3')\n     when substr(zbpc_time,6,2) in ('01','02','03') then concat(cast((cast(substr(zbpc_time,1,4) as int) -1) as string),'.Q4')\n   end as zbpc_Q\nfrom proj_tx_kpi_prd.T_Transformation_Bigdata where zbpc_time <='${max_date}' and zbpc_time >='${min}'\ngroup by zbpc_time\norder by zbpc_time\ndesc \n)A\n\nleft join\n(\nselect \nzbpc_Q\n,kpi_name\n,geo\n,bu\n,sum(zbpc_data) as zbpc_data\nfrom\n(\nselect \ncase when substr(zbpc_time,6,2) in ('04','05','06') then concat(substr(zbpc_time,1,4),'.Q1')\n     when substr(zbpc_time,6,2) in ('07','08','09') then concat(substr(zbpc_time,1,4),'.Q2')\n     when substr(zbpc_time,6,2) in ('10','11','12') then concat(substr(zbpc_time,1,4),'.Q3')\n     when substr(zbpc_time,6,2) in ('01','02','03') then concat(cast((cast(substr(zbpc_time,1,4) as int) -1) as string),'.Q4')\n   end as zbpc_Q\n,kpi_name\n,geo\n,bu\n,zbpc_data\nfrom proj_tx_kpi_prd.T_Transformation_Vertical_Solution \n)c\ngroup by\nzbpc_Q\n,kpi_name\n,geo\n,bu\norder by zbpc_Q\ndesc \n)B\non A.zbpc_Q=B.zbpc_Q\n) D",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288723_0_-1_data_0",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_china_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_china_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:33:37",
          "job_end_time": "2019-05-22 12:34:14",
          "job_start_unix_time": 1558499617,
          "job_end_unix_time": 1558499654,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20288723,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_china_geo",
          "sqlText": null,
          "datasetId": 4655987,
          "srl_no": "0",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288723_0_-1_data_3",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_vertical_solution",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_vertical_solution",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:33:37",
          "job_end_time": "2019-05-22 12:34:14",
          "job_start_unix_time": 1558499617,
          "job_end_unix_time": 1558499654,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20288723,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_vertical_solution",
          "sqlText": null,
          "datasetId": 4656122,
          "srl_no": "3",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288723_0_-1_data_1",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_bigdata_all_middle",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_bigdata_all_middle",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:33:37",
          "job_end_time": "2019-05-22 12:34:14",
          "job_start_unix_time": 1558499617,
          "job_end_unix_time": 1558499654,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288723,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_bigdata_all_middle",
          "sqlText": null,
          "datasetId": 4655986,
          "srl_no": "1",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288739_1_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Global_Accounts_and_Relationship/T_Transformation_DCG_GA_M",
          "job_name": "T_Transformation_DCG_GA_M",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:30:59",
          "job_end_time": "2019-05-22 12:32:21",
          "job_start_unix_time": 1558499459,
          "job_end_unix_time": 1558499541,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288739,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16393",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "\n\n\n---落地table\ninsert overwrite table proj_tx_kpi_prd.T_Transformation_DCG_GA_M\n\n\n\nselect \nzbpc_time \n,kpi_name\n,geo\n,bu\n,sum(zbpc_data) as zbpc_data \n--,sum(sum(zbpc_data)) OVER (PARTITION BY kpi_name,geo,bu ORDER BY zbpc_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS cumulative_amount\nfrom\nproj_tx_kpi_prd.t_transformation_dcg_ga_middle_m\ngroup by\nzbpc_time,kpi_name,geo,bu\n",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 1,
          "rootNode": false
        },
        {
          "id": "20288739_1_-1_data_7",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_dcg_ga_m",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_dcg_ga_m",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:30:59",
          "job_end_time": "2019-05-22 12:32:21",
          "job_start_unix_time": 1558499459,
          "job_end_unix_time": 1558499541,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288739,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_dcg_ga_m",
          "sqlText": null,
          "datasetId": 4655990,
          "srl_no": "7",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 1,
          "rootNode": false
        },
        {
          "id": "20288704_1_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Non_device_Revenue_MBG_Fact_Geo/T_Transformation_Non_device_Revenue_MBG_Fact_Geo",
          "job_name": "T_Transformation_Non_device_Revenue_MBG_Fact_Geo",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:39:23",
          "job_end_time": "2019-05-22 12:40:48",
          "job_start_unix_time": 1558499963,
          "job_end_unix_time": 1558500048,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288704,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16222",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "\n--deleted data from BPC automatio according to the manual data ,and after do manual data union into the BPC automation \ninsert overwrite table proj_tx_kpi_prd.T_Transformation_Non_device_Revenue_MBG_Fact_Geo\n\nselect A.* from \nproj_tx_kpi_prd.T_Transformation_Non_device_Revenue_MBG_Middle_Fact_Geo  A\nleft join\nproj_tx_kpi_prd.manual_load_three_kpi_Fact_Geo B\non upper(A.zbpc_time) = upper(B.zbpc_time) and A.kpi_name = B.kpi_name\nwhere B.zbpc_time is null and B.kpi_name is null\n\nunion all\nselect * from \nproj_tx_kpi_prd.manual_load_three_kpi_Fact_Geo\n",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 1,
          "rootNode": false
        },
        {
          "id": "20288704_1_-1_data_6",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/manual_load_three_kpi_fact_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/manual_load_three_kpi_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:39:23",
          "job_end_time": "2019-05-22 12:40:48",
          "job_start_unix_time": 1558499963,
          "job_end_unix_time": 1558500048,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20288704,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "manual_load_three_kpi_fact_geo",
          "sqlText": null,
          "datasetId": 4655930,
          "srl_no": "6",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 1,
          "rootNode": false
        },
        {
          "id": "20288704_1_-1_data_5",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_non_device_revenue_mbg_fact_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_non_device_revenue_mbg_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:39:23",
          "job_end_time": "2019-05-22 12:40:48",
          "job_start_unix_time": 1558499963,
          "job_end_unix_time": 1558500048,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288704,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_non_device_revenue_mbg_fact_geo",
          "sqlText": null,
          "datasetId": 4656081,
          "srl_no": "5",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 1,
          "rootNode": false
        },
        {
          "id": "20288735_1_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Five_Part_PcServicePenRate_denominator/分母",
          "job_name": "分母",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:32:05",
          "job_end_time": "2019-05-22 12:35:22",
          "job_start_unix_time": 1558499525,
          "job_end_unix_time": 1558499722,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288735,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16360",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "\n\n--分母中所有的 子项 geo\ninsert overwrite table proj_tx_kpi_prd.T_Transformation_Five_denominator\nselect \nzbpc_month,\nzbpc_time,\ngeo,\nkpi_name,\nzbpc_data\nfrom \nproj_tx_kpi_prd.T_Transformation_Five_denominator_middle where geo <> 'MEDION'\n",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 1,
          "rootNode": false
        },
        {
          "id": "20288735_1_-1_data_8",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_five_denominator",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_five_denominator",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:32:05",
          "job_end_time": "2019-05-22 12:35:22",
          "job_start_unix_time": 1558499525,
          "job_end_unix_time": 1558499722,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288735,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_five_denominator",
          "sqlText": null,
          "datasetId": 4656004,
          "srl_no": "8",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 1,
          "rootNode": false
        },
        {
          "id": "20288735_2_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Five_Part_PcServicePenRate_denominator/分母",
          "job_name": "分母",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:32:05",
          "job_end_time": "2019-05-22 12:35:22",
          "job_start_unix_time": 1558499525,
          "job_end_unix_time": 1558499722,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288735,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16360",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "\n\n--单独拉出 medion geo的 进行后面的计算\ninsert overwrite table proj_tx_kpi_prd.T_Transformation_Five_Medion\nselect \nzbpc_month,\nzbpc_time,\ngeo,\nkpi_name,\nzbpc_data\nfrom \nproj_tx_kpi_prd.T_Transformation_Five_denominator_middle where geo = 'MEDION'",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 2,
          "rootNode": false
        },
        {
          "id": "20288735_2_-1_data_10",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_five_medion",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_five_medion",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:32:05",
          "job_end_time": "2019-05-22 12:35:22",
          "job_start_unix_time": 1558499525,
          "job_end_unix_time": 1558499722,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288735,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_five_medion",
          "sqlText": null,
          "datasetId": 4656007,
          "srl_no": "10",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 2,
          "rootNode": false
        },
        {
          "id": "20288715_0_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Non_device_and_Emerging_Revenue_all_PCSD_Fact_Geo/T_Transformation_Non_device_and_Emerging_Revenue_all_PCSD_Fact_Geo",
          "job_name": "T_Transformation_Non_device_and_Emerging_Revenue_all_PCSD_Fact_Geo",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:44:55",
          "job_end_time": "2019-05-22 12:58:35",
          "job_start_unix_time": 1558500295,
          "job_end_unix_time": 1558501115,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288715,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16226",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "insert overwrite table proj_tx_kpi_prd.T_Transformation_Non_device_and_Emerging_Revenue_all_PCSD_Fact_Geo\n\nselect * from (select  A.* from\n\nproj_tx_kpi_prd.T_Transformation_Non_device_Revenue_get_PCSD_Fact_Geo  A\nleft join\n(select * from (\nselect * from proj_tx_kpi_prd.Service_NEC_Upsell_Fact_Geo\nunion all\nselect * from proj_tx_kpi_prd.dass_Fact_Geo)c) B\non A.zbpc_time = B.zbpc_time and A.kpi_name = B.kpi_name\nwhere B.zbpc_time is null and B.kpi_name is null ) aa\n\n\nunion all\nselect * from\nproj_tx_kpi_prd.T_Transformation_Non_device_Revenue_is_PCSD_Fact_Geo\nunion all\nselect * from\nproj_tx_kpi_prd.T_Transformation_pcsd_is_Emerging_Fact_Geo\nunion all\nselect * from \nproj_tx_kpi_prd.T_Transformation_pcsd_get_Emerging_Fact_Geo\nunion all\nselect * from  proj_tx_kpi_prd.Service_NEC_Upsell_Fact_Geo\nunion all\nselect * from proj_tx_kpi_prd.dass_Fact_Geo\n\n--below is depend on kpi_medion,After modified medion part was added to the PCSD service(a) part,so below code from medion part(we can depend the medion`s process is =15896)\nunion all\nselect * from proj_tx_kpi_prd.idg_medion_non_pc_all_kpi_name_Fact_Geo",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288715_0_-1_data_0",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_non_device_revenue_is_pcsd_fact_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_non_device_revenue_is_pcsd_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:44:55",
          "job_end_time": "2019-05-22 12:58:35",
          "job_start_unix_time": 1558500295,
          "job_end_unix_time": 1558501115,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20288715,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_non_device_revenue_is_pcsd_fact_geo",
          "sqlText": null,
          "datasetId": 4656073,
          "srl_no": "0",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288715_0_-1_data_1",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/service_nec_upsell_fact_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/service_nec_upsell_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:44:55",
          "job_end_time": "2019-05-22 12:58:35",
          "job_start_unix_time": 1558500295,
          "job_end_unix_time": 1558501115,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20288715,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "service_nec_upsell_fact_geo",
          "sqlText": null,
          "datasetId": 4655964,
          "srl_no": "1",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288715_0_-1_data_3",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/idg_medion_non_pc_all_kpi_name_fact_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/idg_medion_non_pc_all_kpi_name_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:44:55",
          "job_end_time": "2019-05-22 12:58:35",
          "job_start_unix_time": 1558500295,
          "job_end_unix_time": 1558501115,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20288715,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "idg_medion_non_pc_all_kpi_name_fact_geo",
          "sqlText": null,
          "datasetId": 4655910,
          "srl_no": "3",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288715_0_-1_data_4",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/dass_fact_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/dass_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:44:55",
          "job_end_time": "2019-05-22 12:58:35",
          "job_start_unix_time": 1558500295,
          "job_end_unix_time": 1558501115,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20288715,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "dass_fact_geo",
          "sqlText": null,
          "datasetId": 4655893,
          "srl_no": "4",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288715_0_-1_data_6",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_pcsd_is_emerging_fact_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_pcsd_is_emerging_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:44:55",
          "job_end_time": "2019-05-22 12:58:35",
          "job_start_unix_time": 1558500295,
          "job_end_unix_time": 1558501115,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20288715,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_pcsd_is_emerging_fact_geo",
          "sqlText": null,
          "datasetId": 4656111,
          "srl_no": "6",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288715_0_-1_data_7",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_non_device_revenue_get_pcsd_fact_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_non_device_revenue_get_pcsd_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:44:55",
          "job_end_time": "2019-05-22 12:58:35",
          "job_start_unix_time": 1558500295,
          "job_end_unix_time": 1558501115,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20288715,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_non_device_revenue_get_pcsd_fact_geo",
          "sqlText": null,
          "datasetId": 4656061,
          "srl_no": "7",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288715_0_-1_data_5",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_non_device_and_emerging_revenue_all_pcsd_fact_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_non_device_and_emerging_revenue_all_pcsd_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:44:55",
          "job_end_time": "2019-05-22 12:58:35",
          "job_start_unix_time": 1558500295,
          "job_end_unix_time": 1558501115,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288715,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_non_device_and_emerging_revenue_all_pcsd_fact_geo",
          "sqlText": null,
          "datasetId": 4656047,
          "srl_no": "5",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20242552_0_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PRJ_FR:T_Attach_Rate_Tracking/T_Attach_Rate_Tracking_FCST_base",
          "job_name": "T_Attach_Rate_Tracking_FCST_base",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-21 18:34:05",
          "job_end_time": "2019-05-21 18:35:24",
          "job_start_unix_time": 1558434845,
          "job_end_unix_time": 1558434924,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20242552,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_FR",
          "owner_id": "xuliu",
          "ref_id": "6679",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "insert overwrite table `dm_finance`.`T_Attach_Rate_Tracking_FCST_base`\nselect (case when `report`.`geo` is null then 'FY_TARGET' else `report`.`geo` end) `geo` \n , `report`.`item` \n , `report`.`zbpc_time` \n , substring(`report`.`zbpc_time`,1,4) `fyear` \n , concat(substring(`report`.`zbpc_time`,6,2),'FCST') `version` \n ,`report`.`value_server_rev` \n ,`report`.`value_options` \n ,`report`.`value_software` \n ,`report`.`value_storage` \n ,`report`.`value_networking` \n ,`report`.`value_services` \nfrom ( \n select \n `output`.`item` \n ,`output`.`zbpc_time` \n ,`output`.`zbpc_case` \n ,`output`.`zbpc_pgrp` \n ,`mapping_regiongeo`.`zvalue3` AS `GEO` \n ,if(`bu`.`parent_id` = 'SVBG' or `output`.`zbpc_pgrp` = 'SVBG', `output`.`zbpc_data`,0) `value_SERVER_REV` \n ,if(`bu`.`parent_id` in('LPSOT','LPSOX','LPSOSX','LPSOOBT') or `output`.`zbpc_pgrp` in('LPSOT','LPSOX','LPSOSX','LPSOOBT'), `output`.`zbpc_data`,0) `value_Options` \n ,if(`bu`.`parent_id` = 'EMDS' or `output`.`zbpc_pgrp` = 'EMDS', `output`.`zbpc_data`,0) `value_Software` \n ,if(`bu`.`parent_id` = 'STBG' or `output`.`zbpc_pgrp` = 'STBG', `output`.`zbpc_data`,0) `value_Storage` \n ,if(`bu`.`parent_id` = 'NW' or `output`.`zbpc_pgrp` = 'NW', `output`.`zbpc_data`,0) `value_Networking` \n ,if(`bu`.`parent_id` = 'EBGV' or `output`.`zbpc_pgrp` = 'EBGV', `output`.`zbpc_data`,0) `value_Services` \n from( \n select case when `a`.`zbpc_case` = 'CF' then 'FCST' else 'Prior Fcst' end `ITEM`,`a`.`zbpc_time`,`a`.`zbpc_geo`,`a`.`zbpc_case`,`a`.`zbpc_pgrp`,`a`.`zbpc_data` \n from `dm_finance`.`bw_fin_coobps05l_arate_odlnew` `A` \n inner join (select `v_get_attach_rate_verison_fcst`.`p_date` `zbpc_time` from `dm_finance`.`V_Get_Attach_Rate_Verison_FCST`) `b` \n on `a`.`zbpc_time` = `b`.`zbpc_time` \n where `a`.`zbpc_time` >= '2017' and `a`.`zbpc_time` like'%INP' and `a`.`zbpc_case` IN( 'CF','PF') \n union all \n select 'Budget' `ITEM`,`a`.`zbpc_time`,`a`.`zbpc_geo`,`a`.`zbpc_case`,`a`.`zbpc_pgrp`,`a`.`zbpc_data` \n from `dm_finance`.`bw_fin_coobps06l_arate_odlnew` `A` \n inner join (select `v_get_attach_rate_verison_fcst`.`p_date` `zbpc_time` from `dm_finance`.`V_Get_Attach_Rate_Verison_FCST`) `b` \n on `a`.`zbpc_time` = `b`.`zbpc_time` \n where `a`.`zbpc_time` >= '2017' and `a`.`zbpc_time` like'%INP' and `a`.`zbpc_case` = 'BGT' \n union all \n select 'Last Year' `ITEM`,`b`.`zbpc_time`,`a`.`zbpc_geo`,`a`.`zbpc_case`,`a`.`zbpc_pgrp`,`a`.`zbpc_data` \n from `dm_finance`.`bw_fin_coobps02l_arate_odlnew` `A` \n inner join (select `v_get_attach_rate_verison_fcst`.`p_date` `zbpc_time` ,`v_get_attach_rate_verison_fcst`.`last_year` from `dm_finance`.`V_Get_Attach_Rate_Verison_FCST` ) `b` \n on `a`.`zbpc_time` = `b`.`last_year` \n where `a`.`zbpc_time` >= '2016' and `a`.`zbpc_time` like'%INP' and `a`.`zbpc_case` = 'RACT' \n union all \n select 'Prior Qtr' `ITEM`,`b`.`zbpc_time`,`a`.`zbpc_geo`,`a`.`zbpc_case`,`a`.`zbpc_pgrp`,`a`.`zbpc_data` \n from `dm_finance`.`bw_fin_coobps02l_arate_odlnew` `A` \n inner join (select `v_get_attach_rate_verison_fcst`.`p_date` `zbpc_time`,`v_get_attach_rate_verison_fcst`.`prior_q` from `dm_finance`.`V_Get_Attach_Rate_Verison_FCST`) `b` \n ON `a`.`zbpc_time` = `b`.`prior_q` \n where `a`.`zbpc_time` >= '2016' and `a`.`zbpc_time` like'%INP' and `a`.`zbpc_case` = 'ACTQ' \n union all \n select 'Fy Target' `ITEM`, `b`.`zbpc_time`,'FY_TARGET' `zbpc_geo`,`a`.`zbpc_case`,`a`.`zbpc_pgrp`,`a`.`zbpc_data` \n from `dm_finance`.`bw_fin_coobps06l_arate_odlnew` `A` \n inner join (select `v_get_attach_rate_verison_fcst`.`p_date` `zbpc_time` from `dm_finance`.`V_Get_Attach_Rate_Verison_FCST`) `b` \n on substring(`a`.`zbpc_time`,1,4) = substring(`b`.`zbpc_time`,1,4) \n where `a`.`zbpc_time` >= '2016' and `a`.`zbpc_time` like'%INP' and `a`.`zbpc_case` = 'BGT' \n )`output` \n LEFT JOIN `dm_finance`.`bw_fi_zoibps72l_odl` AS `MAPPING_REGIONGEO` \n ON `mapping_regiongeo`.`zcateg` = 'REGGEO' AND `output`.`zbpc_geo` = `mapping_regiongeo`.`zitmecid` \n LEFT JOIN ( \n select distinct `bpc_fin_dim_hier_odl`.`base_id`,`bpc_fin_dim_hier_odl`.`parent_id` \n from `dm_finance`.`bpc_fin_dim_hier_odl` \n where `bpc_fin_dim_hier_odl`.`category` = 'PRODGROUP' AND `bpc_fin_dim_hier_odl`.`parent_id` IN('SVBG','STBG','EMDS','EBGV','LPSOT','LPSOX','LPSOSX','LPSOOBT','NW') \n ) `BU` --mapping bu \n ON `output`.`zbpc_pgrp` = `bu`.`base_id` \n where exists ( \n select 1 from dm_finance.bpc_fin_dim_hier_odl \n where category = 'PRODGROUP' \n and base_id = output.zbpc_pgrp \n AND (parent_id IN('SVBG','STBG','EMDS','EBGV','LPSOT','LPSOX','LPSOSX','LPSOOBT','NW') \n OR base_id IN('SVBG','STBG','EMDS','EBGV','LPSOT','LPSOX','LPSOSX','LPSOOBT','NW'))) \n \n) `report`",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20242552_0_-1_data_1",
          "node_type": "data",
          "abstracted_path": "/dm_finance/bw_fin_coobps05l_arate_odlnew",
          "storage_type": "spark",
          "urn": "spark://dm_finance/bw_fin_coobps05l_arate_odlnew",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-21 18:34:05",
          "job_end_time": "2019-05-21 18:35:24",
          "job_start_unix_time": 1558434845,
          "job_end_unix_time": 1558434924,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20242552,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "dm_finance",
          "tbl_name": "bw_fin_coobps05l_arate_odlnew",
          "sqlText": null,
          "datasetId": 4584889,
          "srl_no": "1",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20242552_0_-1_data_2",
          "node_type": "data",
          "abstracted_path": "/dm_finance/bw_fin_coobps06l_arate_odlnew",
          "storage_type": "spark",
          "urn": "spark://dm_finance/bw_fin_coobps06l_arate_odlnew",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-21 18:34:05",
          "job_end_time": "2019-05-21 18:35:24",
          "job_start_unix_time": 1558434845,
          "job_end_unix_time": 1558434924,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20242552,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "dm_finance",
          "tbl_name": "bw_fin_coobps06l_arate_odlnew",
          "sqlText": null,
          "datasetId": 4584892,
          "srl_no": "2",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20242552_0_-1_data_3",
          "node_type": "data",
          "abstracted_path": "/dm_finance/bw_fi_zoibps72l_odl",
          "storage_type": "spark",
          "urn": "spark://dm_finance/bw_fi_zoibps72l_odl",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-21 18:34:05",
          "job_end_time": "2019-05-21 18:35:24",
          "job_start_unix_time": 1558434845,
          "job_end_unix_time": 1558434924,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20242552,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "dm_finance",
          "tbl_name": "bw_fi_zoibps72l_odl",
          "sqlText": null,
          "datasetId": 4584876,
          "srl_no": "3",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20242552_0_-1_data_4",
          "node_type": "data",
          "abstracted_path": "/dm_finance/v_get_attach_rate_verison_fcst",
          "storage_type": "spark",
          "urn": "spark://dm_finance/v_get_attach_rate_verison_fcst",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-21 18:34:05",
          "job_end_time": "2019-05-21 18:35:24",
          "job_start_unix_time": 1558434845,
          "job_end_unix_time": 1558434924,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20242552,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "dm_finance",
          "tbl_name": "v_get_attach_rate_verison_fcst",
          "sqlText": null,
          "datasetId": 4585135,
          "srl_no": "4",
          "datasetType": "View",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20242552_0_-1_data_5",
          "node_type": "data",
          "abstracted_path": "/dm_finance/bpc_fin_dim_hier_odl",
          "storage_type": "spark",
          "urn": "spark://dm_finance/bpc_fin_dim_hier_odl",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-21 18:34:05",
          "job_end_time": "2019-05-21 18:35:24",
          "job_start_unix_time": 1558434845,
          "job_end_unix_time": 1558434924,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20242552,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "dm_finance",
          "tbl_name": "bpc_fin_dim_hier_odl",
          "sqlText": null,
          "datasetId": 4584863,
          "srl_no": "5",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20242552_0_-1_data_0",
          "node_type": "data",
          "abstracted_path": "/dm_finance/t_attach_rate_tracking_fcst_base",
          "storage_type": "spark",
          "urn": "spark://dm_finance/t_attach_rate_tracking_fcst_base",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-21 18:34:05",
          "job_end_time": "2019-05-21 18:35:24",
          "job_start_unix_time": 1558434845,
          "job_end_unix_time": 1558434924,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20242552,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "dm_finance",
          "tbl_name": "t_attach_rate_tracking_fcst_base",
          "sqlText": null,
          "datasetId": 4585041,
          "srl_no": "0",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20242553_0_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PRJ_FR:T_Attach_Rate_Tracking/T_Attach_Rate_Tracking_ACT_base",
          "job_name": "T_Attach_Rate_Tracking_ACT_base",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-21 18:35:24",
          "job_end_time": "2019-05-21 18:35:57",
          "job_start_unix_time": 1558434924,
          "job_end_unix_time": 1558434957,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20242553,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_FR",
          "owner_id": "xuliu",
          "ref_id": "6679",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "insert overwrite table `dm_finance`.`T_Attach_Rate_Tracking_ACT_base`\n\nselect (case when `report`.`geo` is null then 'FY_TARGET' else `report`.`geo` end) `geo` \n , `report`.`item` \n , `report`.`zbpc_time` \n , substring(`report`.`zbpc_time`,1,4) `fyear` \n , concat(substring(`report`.`zbpc_time`,6,2),'ACT') `version` \n ,`report`.`value_server_rev` \n ,`report`.`value_options` \n ,`report`.`value_software` \n ,`report`.`value_storage` \n ,`report`.`value_networking` \n ,`report`.`value_services` \nfrom ( \n select \n `output`.`item` \n ,(case \n when substring(cast(date_add(from_unixtime(unix_timestamp()),-1) as string),6,5) between '07-01' and '09-30' then concat(year(cast(date_add(from_unixtime(unix_timestamp()),-1) as string)),'.Q1.INP') \n when substring(cast(date_add(from_unixtime(unix_timestamp()),-1) as string),6,5) between '10-01' and '12-31' then concat(year(cast(date_add(from_unixtime(unix_timestamp()),-1) as string)),'.Q2.INP') \n when substring(cast(date_add(from_unixtime(unix_timestamp()),-1) as string),6,5) between '01-01' and '03-31' then concat(year(cast(add_months(cast(date_add(from_unixtime(unix_timestamp()),-1) as string),-12) as string)),'.Q3.INP') \n when substring(cast(date_add(from_unixtime(unix_timestamp()),-1) as string),6,5) between '04-01' and '06-30' then concat(year(cast(add_months(cast(date_add(from_unixtime(unix_timestamp()),-1) as string),-12) as string)),'.Q4.INP') \n end) as `zbpc_time` \n ,`output`.`zbpc_pgrp` \n ,`mapping_regiongeo`.`zvalue3` AS `GEO` \n ,if(`bu`.`parent_id` = 'SVBG' or `output`.`zbpc_pgrp` = 'SVBG', `output`.`zbpc_data`,0) `value_SERVER_REV` \n ,if(`bu`.`parent_id` in('LPSOT','LPSOX','LPSOSX','LPSOOBT') or `output`.`zbpc_pgrp` in('LPSOT','LPSOX','LPSOSX','LPSOOBT'), `output`.`zbpc_data`,0) `value_Options` \n ,if(`bu`.`parent_id` = 'EMDS' or `output`.`zbpc_pgrp` = 'EMDS', `output`.`zbpc_data`,0) `value_Software` \n ,if(`bu`.`parent_id` = 'STBG' or `output`.`zbpc_pgrp` = 'STBG', `output`.`zbpc_data`,0) `value_Storage` \n ,if(`bu`.`parent_id` = 'NW' or `output`.`zbpc_pgrp` = 'NW', `output`.`zbpc_data`,0) `value_Networking` \n ,if(`bu`.`parent_id` = 'EBGV' or `output`.`zbpc_pgrp` = 'EBGV', `output`.`zbpc_data`,0) `value_Services` \n from( \n select 'ACTQ' `ITEM`,`a`.`zbpc_geo`,`a`.`zbpc_pgrp`,`a`.`zbpc_data` \n from `dm_finance`.`bw_fin_coobps02l_arate_odlnew` `A` \n where `a`.`zbpc_time` >= '2017' and `a`.`zbpc_time` like'%INP' and `a`.`zbpc_case` = 'ACTQ' \n and exists (select 1 from dm_finance.V_Get_Attach_Rate_Verison_ACT where p_date = a.zbpc_time ) \n union all \n select 'Budget' `ITEM`,`a`.`zbpc_geo`,`a`.`zbpc_pgrp`,`a`.`zbpc_data` \n from `dm_finance`.`bw_fin_coobps06l_arate_odlnew` `A` \n where `a`.`zbpc_time` >= '2017' and `a`.`zbpc_time` like'%INP' and `a`.`zbpc_case` = 'BGT' \n and exists (select 1 from dm_finance.V_Get_Attach_Rate_Verison_ACT where p_date = a.zbpc_time ) \n union all \n select 'Last Year' `ITEM`,`a`.`zbpc_geo`,`a`.`zbpc_pgrp`,`a`.`zbpc_data` \n from `dm_finance`.`bw_fin_coobps02l_arate_odlnew` `A` \n where `a`.`zbpc_time` >= '2016' and `a`.`zbpc_time` like'%INP' and `a`.`zbpc_case` = 'RACT' \n and exists (select 1 from dm_finance.V_Get_Attach_Rate_Verison_ACT where Last_Year = a.zbpc_time ) \n union all \n select 'Prior Qtr' `ITEM` ,`a`.`zbpc_geo`,`a`.`zbpc_pgrp`,`a`.`zbpc_data` \n from `dm_finance`.`bw_fin_coobps02l_arate_odlnew` `A` \n where `a`.`zbpc_time` >= '2016' and `a`.`zbpc_time` like'%INP' and `a`.`zbpc_case` = 'ACTQ' \n and exists (select 1 from dm_finance.V_Get_Attach_Rate_Verison_ACT where Prior_Q = a.zbpc_time ) \n union all \n select 'Prior Fcst' `ITEM`,`a`.`zbpc_geo`,`a`.`zbpc_pgrp`,`a`.`zbpc_data` \n from `dm_finance`.`bw_fin_coobps05l_arate_odlnew` `A` \n where `a`.`zbpc_time` >= '2017' and `a`.`zbpc_time` like'%INP' and `a`.`zbpc_case` = (case when `a`.`zbpc_time` like'%Q1.INP' then 'FC03' when `a`.`zbpc_time` like'%Q2.INP' then 'FC06' when `a`.`zbpc_time` like'%Q3.INP' then 'FC09' when `a`.`zbpc_time` like'%Q4.INP' then 'FC12' end) \n and exists (select 1 from dm_finance.V_Get_Attach_Rate_Verison_ACT where p_date = a.zbpc_time ) \n union all \n select 'Fy Target' `ITEM`,'FY_TARGET' `zbpc_geo`,`a`.`zbpc_pgrp`,`a`.`zbpc_data` \n from `dm_finance`.`bw_fin_coobps06l_arate_odlnew` `A` \n where `a`.`zbpc_time` >= '2016' and `a`.`zbpc_time` like'%INP' and `a`.`zbpc_case` = 'BGT' \n and exists (select 1 from dm_finance.V_Get_Attach_Rate_Verison_ACT where substring(p_date,1,4) = substring(A.zbpc_time,1,4)) \n )`output` \n LEFT JOIN `dm_finance`.`bw_fi_zoibps72l_odl` AS `MAPPING_REGIONGEO` \n ON `mapping_regiongeo`.`zcateg` = 'REGGEO' AND `output`.`zbpc_geo` = `mapping_regiongeo`.`zitmecid` \n LEFT JOIN ( \n select distinct `bpc_fin_dim_hier_odl`.`base_id`,`bpc_fin_dim_hier_odl`.`parent_id` \n from `dm_finance`.`bpc_fin_dim_hier_odl` \n where `bpc_fin_dim_hier_odl`.`category` = 'PRODGROUP' AND `bpc_fin_dim_hier_odl`.`parent_id` IN('SVBG','STBG','EMDS','EBGV','LPSOT','LPSOX','LPSOSX','LPSOOBT','NW') \n ) `BU` --mapping bu \n ON `output`.`zbpc_pgrp` = `bu`.`base_id` \n where exists ( \n select 1 from dm_finance.bpc_fin_dim_hier_odl \n where category = 'PRODGROUP' \n and base_id = output.zbpc_pgrp \n AND (parent_id IN('SVBG','STBG','EMDS','EBGV','LPSOT','LPSOX','LPSOSX','LPSOOBT','NW') \n OR base_id IN('SVBG','STBG','EMDS','EBGV','LPSOT','LPSOX','LPSOSX','LPSOOBT','NW'))) \n \n) `report`",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20242553_0_-1_data_2",
          "node_type": "data",
          "abstracted_path": "/dm_finance/v_get_attach_rate_verison_act",
          "storage_type": "spark",
          "urn": "spark://dm_finance/v_get_attach_rate_verison_act",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-21 18:35:24",
          "job_end_time": "2019-05-21 18:35:57",
          "job_start_unix_time": 1558434924,
          "job_end_unix_time": 1558434957,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20242553,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "dm_finance",
          "tbl_name": "v_get_attach_rate_verison_act",
          "sqlText": null,
          "datasetId": 4585134,
          "srl_no": "2",
          "datasetType": "View",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20242553_0_-1_data_3",
          "node_type": "data",
          "abstracted_path": "/dm_finance/bw_fi_zoibps72l_odl",
          "storage_type": "spark",
          "urn": "spark://dm_finance/bw_fi_zoibps72l_odl",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-21 18:35:24",
          "job_end_time": "2019-05-21 18:35:57",
          "job_start_unix_time": 1558434924,
          "job_end_unix_time": 1558434957,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20242553,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "dm_finance",
          "tbl_name": "bw_fi_zoibps72l_odl",
          "sqlText": null,
          "datasetId": 4584876,
          "srl_no": "3",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20242553_0_-1_data_5",
          "node_type": "data",
          "abstracted_path": "/dm_finance/t_attach_rate_tracking_act_base",
          "storage_type": "spark",
          "urn": "spark://dm_finance/t_attach_rate_tracking_act_base",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-21 18:35:24",
          "job_end_time": "2019-05-21 18:35:57",
          "job_start_unix_time": 1558434924,
          "job_end_unix_time": 1558434957,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20242553,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "dm_finance",
          "tbl_name": "t_attach_rate_tracking_act_base",
          "sqlText": null,
          "datasetId": 4585038,
          "srl_no": "5",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288692_0_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:t_transformation_all_emerging_Fact_Geo/t_transformation_all_emerging_Fact_Geo",
          "job_name": "t_transformation_all_emerging_Fact_Geo",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:38:44",
          "job_end_time": "2019-05-22 12:39:55",
          "job_start_unix_time": 1558499924,
          "job_end_unix_time": 1558499995,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288692,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16219",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "insert overwrite table proj_tx_kpi_prd.t_transformation_all_emerging_Fact_Geo\nselect * from proj_tx_kpi_prd.t_transformation_get_emerging_Fact_Geo \nunion all\nselect * from proj_tx_kpi_prd.T_Transformation_is_Emerging_Fact_Geo  \nunion all\nselect * from proj_tx_kpi_prd.dcg_emerging_adjustment_included_Fact_Geo \n",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288692_0_-1_data_2",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/dcg_emerging_adjustment_included_fact_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/dcg_emerging_adjustment_included_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:38:44",
          "job_end_time": "2019-05-22 12:39:55",
          "job_start_unix_time": 1558499924,
          "job_end_unix_time": 1558499995,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20288692,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "dcg_emerging_adjustment_included_fact_geo",
          "sqlText": null,
          "datasetId": 4655898,
          "srl_no": "2",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288692_0_-1_data_3",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_get_emerging_fact_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_get_emerging_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:38:44",
          "job_end_time": "2019-05-22 12:39:55",
          "job_start_unix_time": 1558499924,
          "job_end_unix_time": 1558499995,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20288692,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_get_emerging_fact_geo",
          "sqlText": null,
          "datasetId": 4656020,
          "srl_no": "3",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288692_0_-1_data_0",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_all_emerging_fact_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_all_emerging_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:38:44",
          "job_end_time": "2019-05-22 12:39:55",
          "job_start_unix_time": 1558499924,
          "job_end_unix_time": 1558499995,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288692,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_all_emerging_fact_geo",
          "sqlText": null,
          "datasetId": 4655972,
          "srl_no": "0",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288740_1_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Global_Accounts_and_Relationship/T_Transformation_PCSD_GA_Middle_M",
          "job_name": "T_Transformation_PCSD_GA_Middle_M",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:32:21",
          "job_end_time": "2019-05-22 12:34:14",
          "job_start_unix_time": 1558499541,
          "job_end_unix_time": 1558499654,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288740,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16393",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "\n\n----- table 落地 (最终的)\n\ninsert overwrite table proj_tx_kpi_prd.T_Transformation_PCSD_GA_M\n\nselect \nzbpc_time \n,kpi_name\n,geo\n,bu\n,sum(zbpc_data) as zbpc_data \n--,sum(sum(zbpc_data)) OVER (PARTITION BY kpi_name,geo,bu ORDER BY zbpc_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS cumulative_amount\nfrom\nproj_tx_kpi_prd.T_Transformation_PCSD_GA_Middle_M\ngroup by\nzbpc_time,kpi_name,geo,bu\n\n",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 1,
          "rootNode": false
        },
        {
          "id": "20288740_1_-1_data_8",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_pcsd_ga_m",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_pcsd_ga_m",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:32:21",
          "job_end_time": "2019-05-22 12:34:14",
          "job_start_unix_time": 1558499541,
          "job_end_unix_time": 1558499654,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288740,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_pcsd_ga_m",
          "sqlText": null,
          "datasetId": 4656102,
          "srl_no": "8",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 1,
          "rootNode": false
        },
        {
          "id": "20288734_0_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Five_Part_PcServicePenRate_numerator/T_Transformation_Five_Part_PcServicePenRate_numerator",
          "job_name": "T_Transformation_Five_Part_PcServicePenRate_numerator",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:33:11",
          "job_end_time": "2019-05-22 12:35:00",
          "job_start_unix_time": 1558499591,
          "job_end_unix_time": 1558499700,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288734,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16358",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "--all geo 分子\ninsert overwrite table proj_tx_kpi_prd.T_Transformation_Five_part_all_geo\n\nselect * from \nproj_tx_kpi_prd.T_Transformation_Five_part_geo\nunion all\nselect * from proj_tx_kpi_prd.T_Transformation_Five_part_BT\nunion all\nselect * from proj_tx_kpi_prd.T_Transformation_Five_part_LAG\n",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288734_0_-1_data_0",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_five_part_lag",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_five_part_lag",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:33:11",
          "job_end_time": "2019-05-22 12:35:00",
          "job_start_unix_time": 1558499591,
          "job_end_unix_time": 1558499700,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20288734,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_five_part_lag",
          "sqlText": null,
          "datasetId": 4656013,
          "srl_no": "0",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288734_0_-1_data_3",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_five_part_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_five_part_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:33:11",
          "job_end_time": "2019-05-22 12:35:00",
          "job_start_unix_time": 1558499591,
          "job_end_unix_time": 1558499700,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20288734,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_five_part_geo",
          "sqlText": null,
          "datasetId": 4656012,
          "srl_no": "3",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288734_0_-1_data_2",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_five_part_all_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_five_part_all_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:33:11",
          "job_end_time": "2019-05-22 12:35:00",
          "job_start_unix_time": 1558499591,
          "job_end_unix_time": 1558499700,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288734,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_five_part_all_geo",
          "sqlText": null,
          "datasetId": 4656009,
          "srl_no": "2",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20270270_0_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "hive",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:t_transformation_all_kpi_Fact_geo/T_Transformation_Emerging",
          "job_name": "T_Transformation_Emerging",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 05:56:24",
          "job_end_time": "2019-05-22 05:58:18",
          "job_start_unix_time": 1558475784,
          "job_end_unix_time": 1558475898,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20270270,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16228",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "insert overwrite table proj_tx_kpi_prd.t_transformation_all_kpi_Fact_Geo \n\nselect * from proj_tx_kpi_prd.t_transformation_all_emerging_Fact_Geo\nunion all\nselect * from proj_tx_kpi_prd.T_Transformation_Non_device_Revenue_all_DCG_Fact_Geo\nunion all\nselect * from proj_tx_kpi_prd.T_Transformation_Non_device_Revenue_LCIG_Fact_Geo\nunion all\nselect * from proj_tx_kpi_prd.T_Transformation_Non_device_Revenue_MBG_Fact_Geo\n--union all\n--select * from proj_tx_kpi_prd.idg_medion_non_pc_all_kpi_name_Fact\nunion all\nselect * from proj_tx_kpi_prd.T_Transformation_Non_device_and_Emerging_Revenue_all_PCSD_Fact_Geo",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20270270_0_-1_data_0",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_non_device_revenue_mbg_fact_geo",
          "storage_type": "hive",
          "urn": "hive://proj_tx_kpi_prd/t_transformation_non_device_revenue_mbg_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 05:56:24",
          "job_end_time": "2019-05-22 05:58:18",
          "job_start_unix_time": 1558475784,
          "job_end_unix_time": 1558475898,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20270270,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_non_device_revenue_mbg_fact_geo",
          "sqlText": null,
          "datasetId": 4656081,
          "srl_no": "0",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20270270_0_-1_data_2",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_non_device_revenue_all_dcg_fact_geo",
          "storage_type": "hive",
          "urn": "hive://proj_tx_kpi_prd/t_transformation_non_device_revenue_all_dcg_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 05:56:24",
          "job_end_time": "2019-05-22 05:58:18",
          "job_start_unix_time": 1558475784,
          "job_end_unix_time": 1558475898,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20270270,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_non_device_revenue_all_dcg_fact_geo",
          "sqlText": null,
          "datasetId": 4656053,
          "srl_no": "2",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20270270_0_-1_data_3",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_non_device_and_emerging_revenue_all_pcsd_fact_geo",
          "storage_type": "hive",
          "urn": "hive://proj_tx_kpi_prd/t_transformation_non_device_and_emerging_revenue_all_pcsd_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 05:56:24",
          "job_end_time": "2019-05-22 05:58:18",
          "job_start_unix_time": 1558475784,
          "job_end_unix_time": 1558475898,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20270270,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_non_device_and_emerging_revenue_all_pcsd_fact_geo",
          "sqlText": null,
          "datasetId": 4656047,
          "srl_no": "3",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20270270_0_-1_data_5",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_all_emerging_fact_geo",
          "storage_type": "hive",
          "urn": "hive://proj_tx_kpi_prd/t_transformation_all_emerging_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 05:56:24",
          "job_end_time": "2019-05-22 05:58:18",
          "job_start_unix_time": 1558475784,
          "job_end_unix_time": 1558475898,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20270270,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_all_emerging_fact_geo",
          "sqlText": null,
          "datasetId": 4655972,
          "srl_no": "5",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20270270_0_-1_data_4",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_all_kpi_fact_geo",
          "storage_type": "hive",
          "urn": "hive://proj_tx_kpi_prd/t_transformation_all_kpi_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 05:56:24",
          "job_end_time": "2019-05-22 05:58:18",
          "job_start_unix_time": 1558475784,
          "job_end_unix_time": 1558475898,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20270270,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_all_kpi_fact_geo",
          "sqlText": null,
          "datasetId": 4655975,
          "srl_no": "4",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18864936_0_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "leap_182:Optimus_BPC_Calculate/IDC_YOY",
          "job_name": "IDC_YOY",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-25 13:53:58",
          "job_end_time": "2019-04-25 13:54:35",
          "job_start_unix_time": 1556171638,
          "job_end_unix_time": 1556171675,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 18864936,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_Optimus",
          "owner_id": "wuth3",
          "ref_id": "18043",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "Insert overwrite table prj_optimus_prd.optimus_bpc_detail partition(partition_case='IDC')\nselect \n    quarter,\n    fiscper,\n    bpc_item,\n    bpc_case,\n    geo,\n    region_or_market,\n    bpc_country,\n    country,\n    ww_bpc_segment,\n    segment,\n    sub_segment_l1,\n    sub_segment_l2,\n    bpc_pgrp,\n    biz_group,\n    biz_unit_l1,\n    biz_unit_l2,\n    high_growth_l1, \n    high_growth_l2,\n    bpc_parents,\n    account_kpi,\n    sum(kpi_value) as kpi_value,\n    sum(Last_Year_kpi_value) as Last_Year_kpi_value\nfrom (select \n        t.quarter,\n        t.fiscper,\n        t.bpc_item,\n        t.bpc_case,\n        t.geo,\n        t.region_or_market,\n        t.bpc_country,\n        t.country,\n        t.ww_bpc_segment,\n        t.segment,\n        t.sub_segment_l1,\n        t.sub_segment_l2,\n        t.bpc_pgrp,\n        t.biz_group,\n        t.biz_unit_l1,\n        t.biz_unit_l2,\n        t.high_growth_l1, \n        t.high_growth_l2, \n        t.bpc_parents,\n        t.account_kpi,\n        t.kpi_value,\n        0 as Last_Year_kpi_value\n       from prj_optimus_prd.optimus_bpc_detail as t\n      WHERE partition_case='IDC' and quarter>='${pre_y_qtr}'\n        union all\n      select \n        CONCAT('FY',CAST(substr(t.quarter,3,2)+1 AS INT),cast(substr(t.quarter,5,2)+1 AS INT),substr(t.quarter,7,2)) AS quarter,\n        concat(cast(substr(t.fiscper,1,4)+1 as int),substr(t.fiscper,5,3)) as fiscper,\n        t.bpc_item,\n        t.bpc_case,\n        t.geo,\n        t.region_or_market,\n        t.bpc_country,\n        t.country,\n        t.ww_bpc_segment,\n        t.segment,\n        t.sub_segment_l1,\n        t.sub_segment_l2,\n        t.bpc_pgrp,\n        t.biz_group,\n        t.biz_unit_l1,\n        t.biz_unit_l2,\n        t.high_growth_l1, \n        t.high_growth_l2, \n        t.bpc_parents,\n        t.account_kpi,\n        0 as kpi_value,\n        t.kpi_value as Last_Year_kpi_value\n       from prj_optimus_prd.optimus_bpc_detail as t\n      WHERE partition_case='IDC' and  quarter<='${pre_y_qtr}') as a \ngroup by \n    quarter,\n    fiscper,\n    bpc_item,\n    bpc_case,\n    geo,\n    region_or_market,\n    bpc_country,\n    country,\n    ww_bpc_segment,\n    segment,\n    sub_segment_l1,\n    sub_segment_l2,\n    bpc_pgrp,\n    biz_group,\n    biz_unit_l1,\n    biz_unit_l2,\n    high_growth_l1, \n    high_growth_l2, \n    bpc_parents,\n    account_kpi",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18864936_0_-1_data_0",
          "node_type": "data",
          "abstracted_path": "/prj_optimus_prd/optimus_bpc_detail",
          "storage_type": "spark",
          "urn": "spark://prj_optimus_prd/optimus_bpc_detail",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-25 13:53:58",
          "job_end_time": "2019-04-25 13:54:35",
          "job_start_unix_time": 1556171638,
          "job_end_unix_time": 1556171675,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 18864936,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "prj_optimus_prd",
          "tbl_name": "optimus_bpc_detail",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "0",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18864942_0_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "leap_182:Optimus_BPC_Calculate/ACT_YOY",
          "job_name": "ACT_YOY",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-25 13:55:34",
          "job_end_time": "2019-04-25 13:56:55",
          "job_start_unix_time": 1556171734,
          "job_end_unix_time": 1556171815,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 18864942,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_Optimus",
          "owner_id": "wuth3",
          "ref_id": "18043",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "Insert overwrite table prj_optimus_prd.optimus_bpc_detail partition(partition_case='ACT')\nselect \n    quarter,\n    fiscper,\n    bpc_item,\n    max(bpc_case),\n    geo,\n    region_or_market,\n    bpc_country,\n    country,\n    ww_bpc_segment,\n    segment,\n    sub_segment_l1,\n    sub_segment_l2,\n    bpc_pgrp,\n    biz_group,\n    biz_unit_l1,\n    biz_unit_l2,\n    high_growth_l1, \n    high_growth_l2,\n    bpc_parents,\n    account_kpi,\n    sum(kpi_value) as kpi_value,\n    sum(Last_Year_kpi_value) as Last_Year_kpi_value\nfrom (select \n        t.quarter,\n        t.fiscper,\n        t.bpc_item,\n        t.bpc_case,\n        t.geo,\n        t.region_or_market,\n        t.bpc_country,\n        t.country,\n        t.ww_bpc_segment,\n        t.segment,\n        t.sub_segment_l1,\n        t.sub_segment_l2,\n        t.bpc_pgrp,\n        t.biz_group,\n        t.biz_unit_l1,\n        t.biz_unit_l2,\n        t.high_growth_l1, \n        t.high_growth_l2, \n        t.bpc_parents,\n        t.account_kpi,\n        t.kpi_value,\n        0 as Last_Year_kpi_value\n       from prj_optimus_prd.optimus_bpc_detail as t\n      WHERE partition_case='ACT' and  quarter>='${pre_y_qtr}' \n        union all\n      select \n        CONCAT('FY',CAST(substr(t.quarter,3,2)+1 AS INT),cast(substr(t.quarter,5,2)+1 AS INT),substr(t.quarter,7,2)) AS quarter,\n        concat(cast(substr(t.fiscper,1,4)+1 as int),substr(t.fiscper,5,3)) as fiscper,\n        t.bpc_item,\n        t.bpc_case,\n        t.geo,\n        t.region_or_market,\n        t.bpc_country,\n        t.country,\n        t.ww_bpc_segment,\n        t.segment,\n        t.sub_segment_l1,\n        t.sub_segment_l2,\n        t.bpc_pgrp,\n        t.biz_group,\n        t.biz_unit_l1,\n        t.biz_unit_l2,\n        t.high_growth_l1, \n        t.high_growth_l2, \n        t.bpc_parents,\n        t.account_kpi,\n        0 as kpi_value,\n        t.kpi_value as Last_Year_kpi_value\n       from prj_optimus_prd.optimus_bpc_detail as t\n      WHERE partition_case='ACT' and  quarter<='${pre_y_qtr}' ) as a\ngroup by \n    quarter,\n    fiscper,\n    bpc_item,\n    geo,\n    region_or_market,\n    bpc_country,\n    country,\n    ww_bpc_segment,\n    segment,\n    sub_segment_l1,\n    sub_segment_l2,\n    bpc_pgrp,\n    biz_group,\n    biz_unit_l1,\n    biz_unit_l2,\n    high_growth_l1, \n    high_growth_l2, \n    bpc_parents,\n    account_kpi",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18864942_0_-1_data_0",
          "node_type": "data",
          "abstracted_path": "/prj_optimus_prd/optimus_bpc_detail",
          "storage_type": "spark",
          "urn": "spark://prj_optimus_prd/optimus_bpc_detail",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-25 13:55:34",
          "job_end_time": "2019-04-25 13:56:55",
          "job_start_unix_time": 1556171734,
          "job_end_unix_time": 1556171815,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 18864942,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "prj_optimus_prd",
          "tbl_name": "optimus_bpc_detail",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "0",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18864938_0_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "leap_182:Optimus_BPC_Calculate/Final_BPC",
          "job_name": "Final_BPC",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-25 13:56:55",
          "job_end_time": "2019-04-25 13:59:09",
          "job_start_unix_time": 1556171815,
          "job_end_unix_time": 1556171949,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 18864938,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_Optimus",
          "owner_id": "wuth3",
          "ref_id": "18043",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "insert overwrite table prj_optimus_prd.optimus_final_bpc\n  select\n  concat(substr(t.quarter,1,4),'/',substr(t.quarter,5,2)) as Fiscal_year,\n  substr(t.quarter,-2,2) as Q_no, \n  p.m_no,\n  t.quarter,\n  t.fiscper,\n  p2.quarter_no,\n  p.month_no,\n  bpc_item,\n  bpc_case,\n  geo,\n  region_or_market,\n  bpc_country,\n  t.country,\n  segment,\n  sub_segment_l1,\n  sub_segment_l2,\n  t.biz_group,\n  biz_unit_l1,\n  biz_unit_l2,\n  t.high_growth_l1,\n  t.high_growth_l2,\n  bpc_parents,\n  account_kpi,\n  sum(kpi_value) as kpi_value,\n  SUM(Last_Year_kpi_value) AS Last_Year_kpi_value,\n  sum( case when bpc_parents='TOTCA' then nvl(kpi_value, 0) else 0 end )*1000 as BPC_CA,\n  sum( case when bpc_parents='TOTREV' then nvl(kpi_value, 0) else 0 end )*1000000 as BPC_Revenue,\n  sum( case when bpc_parents='BMC' then nvl(kpi_value, 0) else 0 end )*1000000 as BPC_BMC,\n  sum( case when bpc_parents='BMCGP' then nvl(kpi_value, 0) else 0 end )*1000000 as BPC_BMCGP,\n  sum( case when bpc_parents='BMC' OR bpc_parents='TOTNBMC' then nvl(kpi_value, 0) else 0 end )*1000000 as BPC_TMC,\n  sum( case when bpc_parents='TOTGP'  then nvl(kpi_value, 0) else 0 end )*1000000 as BPC_TMCGP,\n  sum( case when bpc_parents='TOTCA' and bpc_item='IDC' then nvl(Last_Year_kpi_value, 0) else 0 end )*1000 as Last_Year_IDC_CA,\n  sum( case when bpc_parents='TOTREV' and bpc_item='IDC' then nvl(Last_Year_kpi_value, 0) else 0 end )*1000000 as Last_Year_IDC_Revenue,\n  0 as track_ca,\n  0 as track_revenue,\n  0 as track_bmcgp,\n  0 as track_tmcgp,\n  0 as hg_track_ca,\n  0 as hg_track_revenue,\n  0 as hg_track_bmcgp,\n  0 as hg_track_tmcgp,\n  0 as track_pts,\n  0 as track_pts \nfrom prj_optimus_prd.optimus_bpc_detail t\n  left  join prj_optimus_prd.mt_optimus_fiscal_period p\n  on p.fiscper=t.fiscper\n  left  join(SELECT DISTINCT quarter,quarter_no FROM  prj_optimus_prd.mt_optimus_fiscal_period ) p2\n  on p2.quarter=t.quarter\n  where t.quarter<='${cur_qtr}'\n  group by \n  t.quarter,t.fiscper,p.m_no,p2.quarter_no,p.month_no,\n  bpc_item,bpc_case,\n  geo,region_or_market,bpc_country,t.country,\n  segment,sub_segment_l1,sub_segment_l2,\n  t.biz_group,biz_unit_l1,biz_unit_l2,t.high_growth_l1,t.high_growth_l2,\n  bpc_parents,account_kpi",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18864938_0_-1_data_0",
          "node_type": "data",
          "abstracted_path": "/prj_optimus_prd/mt_optimus_fiscal_period",
          "storage_type": "spark",
          "urn": "spark://prj_optimus_prd/mt_optimus_fiscal_period",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-25 13:56:55",
          "job_end_time": "2019-04-25 13:59:09",
          "job_start_unix_time": 1556171815,
          "job_end_unix_time": 1556171949,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 18864938,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "prj_optimus_prd",
          "tbl_name": "mt_optimus_fiscal_period",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "0",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18864938_0_-1_data_2",
          "node_type": "data",
          "abstracted_path": "/prj_optimus_prd/optimus_final_bpc",
          "storage_type": "spark",
          "urn": "spark://prj_optimus_prd/optimus_final_bpc",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-25 13:56:55",
          "job_end_time": "2019-04-25 13:59:09",
          "job_start_unix_time": 1556171815,
          "job_end_unix_time": 1556171949,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 18864938,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "prj_optimus_prd",
          "tbl_name": "optimus_final_bpc",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "2",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18900948_0_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "leap_182:Optimus_BPC_Calculate_new20190425/IDC_YOY",
          "job_name": "IDC_YOY",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-26 05:22:24",
          "job_end_time": "2019-04-26 05:23:05",
          "job_start_unix_time": 1556227344,
          "job_end_unix_time": 1556227385,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 18900948,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_Optimus",
          "owner_id": "houqn1",
          "ref_id": "18560",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "Insert overwrite table prj_optimus_prd.optimus_bpc_detail partition(partition_case='IDC')\nselect \n    quarter,\n    fiscper,\n    bpc_item,\n    bpc_case,\n    geo,\n    region_or_market,\n    bpc_country,\n    country,\n    ww_bpc_segment,\n    segment,\n    sub_segment_l1,\n    sub_segment_l2,\n    bpc_pgrp,\n    biz_group,\n    biz_unit_l1,\n    biz_unit_l2,\n    high_growth_l1, \n    high_growth_l2,\n    bpc_parents,\n    account_kpi,\n    sum(kpi_value) as kpi_value,\n    sum(Last_Year_kpi_value) as Last_Year_kpi_value\nfrom (select \n        t.quarter,\n        t.fiscper,\n        t.bpc_item,\n        t.bpc_case,\n        t.geo,\n        t.region_or_market,\n        t.bpc_country,\n        t.country,\n        t.ww_bpc_segment,\n        t.segment,\n        t.sub_segment_l1,\n        t.sub_segment_l2,\n        t.bpc_pgrp,\n        t.biz_group,\n        t.biz_unit_l1,\n        t.biz_unit_l2,\n        t.high_growth_l1, \n        t.high_growth_l2, \n        t.bpc_parents,\n        t.account_kpi,\n        t.kpi_value,\n        0 as Last_Year_kpi_value\n       from prj_optimus_prd.optimus_bpc_detail as t\n      WHERE partition_case='IDC' and quarter>='${pre_y_qtr}'\n        union all\n      select \n        CONCAT('FY',CAST(substr(t.quarter,3,2)+1 AS INT),cast(substr(t.quarter,5,2)+1 AS INT),substr(t.quarter,7,2)) AS quarter,\n        concat(cast(substr(t.fiscper,1,4)+1 as int),substr(t.fiscper,5,3)) as fiscper,\n        t.bpc_item,\n        t.bpc_case,\n        t.geo,\n        t.region_or_market,\n        t.bpc_country,\n        t.country,\n        t.ww_bpc_segment,\n        t.segment,\n        t.sub_segment_l1,\n        t.sub_segment_l2,\n        t.bpc_pgrp,\n        t.biz_group,\n        t.biz_unit_l1,\n        t.biz_unit_l2,\n        t.high_growth_l1, \n        t.high_growth_l2, \n        t.bpc_parents,\n        t.account_kpi,\n        0 as kpi_value,\n        t.kpi_value as Last_Year_kpi_value\n       from prj_optimus_prd.optimus_bpc_detail as t\n      WHERE partition_case='IDC' and  quarter<='${pre_y_qtr}') as a \ngroup by \n    quarter,\n    fiscper,\n    bpc_item,\n    bpc_case,\n    geo,\n    region_or_market,\n    bpc_country,\n    country,\n    ww_bpc_segment,\n    segment,\n    sub_segment_l1,\n    sub_segment_l2,\n    bpc_pgrp,\n    biz_group,\n    biz_unit_l1,\n    biz_unit_l2,\n    high_growth_l1, \n    high_growth_l2, \n    bpc_parents,\n    account_kpi",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18900948_0_-1_data_0",
          "node_type": "data",
          "abstracted_path": "/prj_optimus_prd/optimus_bpc_detail",
          "storage_type": "spark",
          "urn": "spark://prj_optimus_prd/optimus_bpc_detail",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-26 05:22:24",
          "job_end_time": "2019-04-26 05:23:05",
          "job_start_unix_time": 1556227344,
          "job_end_unix_time": 1556227385,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 18900948,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "prj_optimus_prd",
          "tbl_name": "optimus_bpc_detail",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "0",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18900951_0_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "leap_182:Optimus_BPC_Calculate_new20190425/ACT_YOY",
          "job_name": "ACT_YOY",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-26 05:24:05",
          "job_end_time": "2019-04-26 05:25:09",
          "job_start_unix_time": 1556227445,
          "job_end_unix_time": 1556227509,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 18900951,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_Optimus",
          "owner_id": "houqn1",
          "ref_id": "18560",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "Insert overwrite table prj_optimus_prd.optimus_bpc_detail partition(partition_case='ACT')\nselect \n    quarter,\n    fiscper,\n    bpc_item,\n    max(bpc_case),\n    geo,\n    region_or_market,\n    bpc_country,\n    country,\n    ww_bpc_segment,\n    segment,\n    sub_segment_l1,\n    sub_segment_l2,\n    bpc_pgrp,\n    biz_group,\n    biz_unit_l1,\n    biz_unit_l2,\n    high_growth_l1, \n    high_growth_l2,\n    bpc_parents,\n    account_kpi,\n    sum(kpi_value) as kpi_value,\n    sum(Last_Year_kpi_value) as Last_Year_kpi_value\nfrom (select \n        t.quarter,\n        t.fiscper,\n        t.bpc_item,\n        t.bpc_case,\n        t.geo,\n        t.region_or_market,\n        t.bpc_country,\n        t.country,\n        t.ww_bpc_segment,\n        t.segment,\n        t.sub_segment_l1,\n        t.sub_segment_l2,\n        t.bpc_pgrp,\n        t.biz_group,\n        t.biz_unit_l1,\n        t.biz_unit_l2,\n        t.high_growth_l1, \n        t.high_growth_l2, \n        t.bpc_parents,\n        t.account_kpi,\n        t.kpi_value,\n        0 as Last_Year_kpi_value\n       from prj_optimus_prd.optimus_bpc_detail as t\n      WHERE partition_case='ACT' and  quarter>='${pre_y_qtr}' \n        union all\n      select \n        CONCAT('FY',CAST(substr(t.quarter,3,2)+1 AS INT),cast(substr(t.quarter,5,2)+1 AS INT),substr(t.quarter,7,2)) AS quarter,\n        concat(cast(substr(t.fiscper,1,4)+1 as int),substr(t.fiscper,5,3)) as fiscper,\n        t.bpc_item,\n        t.bpc_case,\n        t.geo,\n        t.region_or_market,\n        t.bpc_country,\n        t.country,\n        t.ww_bpc_segment,\n        t.segment,\n        t.sub_segment_l1,\n        t.sub_segment_l2,\n        t.bpc_pgrp,\n        t.biz_group,\n        t.biz_unit_l1,\n        t.biz_unit_l2,\n        t.high_growth_l1, \n        t.high_growth_l2, \n        t.bpc_parents,\n        t.account_kpi,\n        0 as kpi_value,\n        t.kpi_value as Last_Year_kpi_value\n       from prj_optimus_prd.optimus_bpc_detail as t\n      WHERE partition_case='ACT' and  quarter<='${pre_y_qtr}' ) as a\ngroup by \n    quarter,\n    fiscper,\n    bpc_item,\n    geo,\n    region_or_market,\n    bpc_country,\n    country,\n    ww_bpc_segment,\n    segment,\n    sub_segment_l1,\n    sub_segment_l2,\n    bpc_pgrp,\n    biz_group,\n    biz_unit_l1,\n    biz_unit_l2,\n    high_growth_l1, \n    high_growth_l2, \n    bpc_parents,\n    account_kpi",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18900951_0_-1_data_0",
          "node_type": "data",
          "abstracted_path": "/prj_optimus_prd/optimus_bpc_detail",
          "storage_type": "spark",
          "urn": "spark://prj_optimus_prd/optimus_bpc_detail",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-26 05:24:05",
          "job_end_time": "2019-04-26 05:25:09",
          "job_start_unix_time": 1556227445,
          "job_end_unix_time": 1556227509,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 18900951,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "prj_optimus_prd",
          "tbl_name": "optimus_bpc_detail",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "0",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "18902516_0_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "leap_182:Optimus_BPC_Calculate_new20190425/Final_BPC",
          "job_name": "Final_BPC",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-04-26 05:25:09",
          "job_end_time": "2019-04-26 05:27:54",
          "job_start_unix_time": 1556227509,
          "job_end_unix_time": 1556227674,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 18902516,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_Optimus",
          "owner_id": "houqn1",
          "ref_id": "18560",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "insert overwrite table prj_optimus_prd.optimus_final_bpc\nselect\n  concat(substr(t.quarter,1,4),'/',substr(t.quarter,5,2)) as Fiscal_year,\n  substr(t.quarter,-2,2) as Q_no, \n  p.m_no,\n  t.quarter,\n  t.fiscper,\n  p2.quarter_no,\n  p.month_no,\n  bpc_item,\n  bpc_case,\n  geo,\n  region_or_market,\n  bpc_country,\n  t.country,\n  segment,\n  sub_segment_l1,\n  sub_segment_l2,\n  t.biz_group,\n  biz_unit_l1,\n  biz_unit_l2,\n  t.high_growth_l1,\n  t.high_growth_l2,\n  bpc_parents,\n  account_kpi,\n  sum(case when nvl(biz_unit_l1,'') <> '' then nvl(kpi_value,0) else 0 end) as kpi_value,\n  SUM(case when nvl(biz_unit_l1,'') <> '' then nvl(Last_Year_kpi_value,0) else 0 end ) AS Last_Year_kpi_value,\n  sum( case when bpc_parents='TOTCA' AND nvl(biz_unit_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000 as BPC_CA,\n  sum( case when bpc_parents='TOTREV' AND nvl(biz_unit_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000000 as BPC_Revenue,\n  sum( case when bpc_parents='BMC' AND nvl(biz_unit_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000000 as BPC_BMC,\n  sum( case when bpc_parents='BMCGP' AND nvl(biz_unit_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000000 as BPC_BMCGP,\n  sum( case when (bpc_parents='BMC' OR bpc_parents='TOTNBMC') AND nvl(biz_unit_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000000 as BPC_TMC,\n  sum( case when bpc_parents='TOTGP' AND nvl(biz_unit_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000000 as BPC_TMCGP,\n  sum( case when bpc_parents='TOTCA' AND nvl(biz_unit_l1,'') <> '' and bpc_item='IDC' then nvl(Last_Year_kpi_value, 0) else 0 end )*1000 as Last_Year_IDC_CA,\n  sum( case when bpc_parents='TOTREV' AND nvl(biz_unit_l1,'') <> '' and bpc_item='IDC' then nvl(Last_Year_kpi_value, 0) else 0 end )*1000000 as Last_Year_IDC_Revenue,\n  0 as track_ca,\n  0 as track_revenue,\n  0 as track_bmcgp,\n  0 as track_tmcgp,\n  0 as hg_track_ca,\n  0 as hg_track_revenue,\n  0 as hg_track_bmcgp,\n  0 as hg_track_tmcgp,\n  0 as track_pts,\n  0 as track_pts,\n  \n  sum( case when bpc_parents='TOTCA' and nvl(high_growth_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000 as HG_BPC_CA,\n  sum( case when bpc_parents='TOTREV' and nvl(high_growth_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000000 as HG_BPC_Revenue,\n  sum( case when bpc_parents='BMCGP' and nvl(high_growth_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000000 as HG_BPC_BMCGP,\n  sum( case when bpc_parents='TOTGP' and nvl(high_growth_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000000 as HG_BPC_TMCGP,\n  sum( case when nvl(high_growth_l1,'') <> '' then nvl(kpi_value,0) else 0 end) as hg_kpi_value\nfrom prj_optimus_prd.optimus_bpc_detail t\nleft join prj_optimus_prd.mt_optimus_fiscal_period p\n  on p.fiscper=t.fiscper\nleft join(SELECT DISTINCT quarter,quarter_no FROM  prj_optimus_prd.mt_optimus_fiscal_period ) p2\n  on p2.quarter=t.quarter\nwhere t.quarter<='${cur_qtr}'\ngroup by\n  t.quarter,t.fiscper,p.m_no,p2.quarter_no,p.month_no,\n  bpc_item,bpc_case,\n  geo,region_or_market,bpc_country,t.country,\n  segment,sub_segment_l1,sub_segment_l2,\n  t.biz_group,biz_unit_l1,biz_unit_l2,t.high_growth_l1,t.high_growth_l2,\n  bpc_parents,account_kpi",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "19554666_0_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "leap_182:Optimus_BPC_Calculate/IDC_YOY",
          "job_name": "IDC_YOY",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-08 05:03:55",
          "job_end_time": "2019-05-08 05:04:45",
          "job_start_unix_time": 1557263035,
          "job_end_unix_time": 1557263085,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 19554666,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_Optimus",
          "owner_id": "houqn1",
          "ref_id": "18560",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "Insert overwrite table prj_optimus_prd.optimus_bpc_detail partition(partition_case='IDC')\nselect \n    quarter,\n    fiscper,\n    bpc_item,\n    bpc_case,\n    geo,\n    region_or_market,\n    bpc_country,\n    country,\n    ww_bpc_segment,\n    segment,\n    sub_segment_l1,\n    sub_segment_l2,\n    bpc_pgrp,\n    biz_group,\n    biz_unit_l1,\n    biz_unit_l2,\n    high_growth_l1, \n    high_growth_l2,\n    bpc_parents,\n    account_kpi,\n    sum(kpi_value) as kpi_value,\n    sum(Last_Year_kpi_value) as Last_Year_kpi_value\nfrom (select \n        t.quarter,\n        t.fiscper,\n        t.bpc_item,\n        t.bpc_case,\n        t.geo,\n        t.region_or_market,\n        t.bpc_country,\n        t.country,\n        t.ww_bpc_segment,\n        t.segment,\n        t.sub_segment_l1,\n        t.sub_segment_l2,\n        t.bpc_pgrp,\n        t.biz_group,\n        t.biz_unit_l1,\n        t.biz_unit_l2,\n        t.high_growth_l1, \n        t.high_growth_l2, \n        t.bpc_parents,\n        t.account_kpi,\n        t.kpi_value,\n        0 as Last_Year_kpi_value\n       from prj_optimus_prd.optimus_bpc_detail as t\n      WHERE partition_case='IDC' and quarter>='${pre_y_qtr}'\n        union all\n      select \n        CONCAT('FY',CAST(substr(t.quarter,3,2)+1 AS INT),cast(substr(t.quarter,5,2)+1 AS INT),substr(t.quarter,7,2)) AS quarter,\n        concat(cast(substr(t.fiscper,1,4)+1 as int),substr(t.fiscper,5,3)) as fiscper,\n        t.bpc_item,\n        t.bpc_case,\n        t.geo,\n        t.region_or_market,\n        t.bpc_country,\n        t.country,\n        t.ww_bpc_segment,\n        t.segment,\n        t.sub_segment_l1,\n        t.sub_segment_l2,\n        t.bpc_pgrp,\n        t.biz_group,\n        t.biz_unit_l1,\n        t.biz_unit_l2,\n        t.high_growth_l1, \n        t.high_growth_l2, \n        t.bpc_parents,\n        t.account_kpi,\n        0 as kpi_value,\n        t.kpi_value as Last_Year_kpi_value\n       from prj_optimus_prd.optimus_bpc_detail as t\n      WHERE partition_case='IDC' and  quarter<='${pre_y_qtr}') as a \ngroup by \n    quarter,\n    fiscper,\n    bpc_item,\n    bpc_case,\n    geo,\n    region_or_market,\n    bpc_country,\n    country,\n    ww_bpc_segment,\n    segment,\n    sub_segment_l1,\n    sub_segment_l2,\n    bpc_pgrp,\n    biz_group,\n    biz_unit_l1,\n    biz_unit_l2,\n    high_growth_l1, \n    high_growth_l2, \n    bpc_parents,\n    account_kpi",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "19554666_0_-1_data_0",
          "node_type": "data",
          "abstracted_path": "/prj_optimus_prd/optimus_bpc_detail",
          "storage_type": "spark",
          "urn": "spark://prj_optimus_prd/optimus_bpc_detail",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-08 05:03:55",
          "job_end_time": "2019-05-08 05:04:45",
          "job_start_unix_time": 1557263035,
          "job_end_unix_time": 1557263085,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 19554666,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "prj_optimus_prd",
          "tbl_name": "optimus_bpc_detail",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "0",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "19554672_0_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "leap_182:Optimus_BPC_Calculate/ACT_YOY",
          "job_name": "ACT_YOY",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-08 05:05:48",
          "job_end_time": "2019-05-08 05:06:49",
          "job_start_unix_time": 1557263148,
          "job_end_unix_time": 1557263209,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 19554672,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_Optimus",
          "owner_id": "houqn1",
          "ref_id": "18560",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "Insert overwrite table prj_optimus_prd.optimus_bpc_detail partition(partition_case='ACT')\nselect \n    quarter,\n    fiscper,\n    bpc_item,\n    max(bpc_case),\n    geo,\n    region_or_market,\n    bpc_country,\n    country,\n    ww_bpc_segment,\n    segment,\n    sub_segment_l1,\n    sub_segment_l2,\n    bpc_pgrp,\n    biz_group,\n    biz_unit_l1,\n    biz_unit_l2,\n    high_growth_l1, \n    high_growth_l2,\n    bpc_parents,\n    account_kpi,\n    sum(kpi_value) as kpi_value,\n    sum(Last_Year_kpi_value) as Last_Year_kpi_value\nfrom (select \n        t.quarter,\n        t.fiscper,\n        t.bpc_item,\n        t.bpc_case,\n        t.geo,\n        t.region_or_market,\n        t.bpc_country,\n        t.country,\n        t.ww_bpc_segment,\n        t.segment,\n        t.sub_segment_l1,\n        t.sub_segment_l2,\n        t.bpc_pgrp,\n        t.biz_group,\n        t.biz_unit_l1,\n        t.biz_unit_l2,\n        t.high_growth_l1, \n        t.high_growth_l2, \n        t.bpc_parents,\n        t.account_kpi,\n        t.kpi_value,\n        0 as Last_Year_kpi_value\n       from prj_optimus_prd.optimus_bpc_detail as t\n      WHERE partition_case='ACT' and  quarter>='${pre_y_qtr}' \n        union all\n      select \n        CONCAT('FY',CAST(substr(t.quarter,3,2)+1 AS INT),cast(substr(t.quarter,5,2)+1 AS INT),substr(t.quarter,7,2)) AS quarter,\n        concat(cast(substr(t.fiscper,1,4)+1 as int),substr(t.fiscper,5,3)) as fiscper,\n        t.bpc_item,\n        t.bpc_case,\n        t.geo,\n        t.region_or_market,\n        t.bpc_country,\n        t.country,\n        t.ww_bpc_segment,\n        t.segment,\n        t.sub_segment_l1,\n        t.sub_segment_l2,\n        t.bpc_pgrp,\n        t.biz_group,\n        t.biz_unit_l1,\n        t.biz_unit_l2,\n        t.high_growth_l1, \n        t.high_growth_l2, \n        t.bpc_parents,\n        t.account_kpi,\n        0 as kpi_value,\n        t.kpi_value as Last_Year_kpi_value\n       from prj_optimus_prd.optimus_bpc_detail as t\n      WHERE partition_case='ACT' and  quarter<='${pre_y_qtr}' ) as a\ngroup by \n    quarter,\n    fiscper,\n    bpc_item,\n    geo,\n    region_or_market,\n    bpc_country,\n    country,\n    ww_bpc_segment,\n    segment,\n    sub_segment_l1,\n    sub_segment_l2,\n    bpc_pgrp,\n    biz_group,\n    biz_unit_l1,\n    biz_unit_l2,\n    high_growth_l1, \n    high_growth_l2, \n    bpc_parents,\n    account_kpi",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "19554672_0_-1_data_0",
          "node_type": "data",
          "abstracted_path": "/prj_optimus_prd/optimus_bpc_detail",
          "storage_type": "spark",
          "urn": "spark://prj_optimus_prd/optimus_bpc_detail",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-08 05:05:48",
          "job_end_time": "2019-05-08 05:06:49",
          "job_start_unix_time": 1557263148,
          "job_end_unix_time": 1557263209,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 19554672,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "prj_optimus_prd",
          "tbl_name": "optimus_bpc_detail",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "0",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "19554668_0_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "leap_182:Optimus_BPC_Calculate/Final_BPC",
          "job_name": "Final_BPC",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-08 05:06:49",
          "job_end_time": "2019-05-08 05:09:55",
          "job_start_unix_time": 1557263209,
          "job_end_unix_time": 1557263395,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 19554668,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_Optimus",
          "owner_id": "houqn1",
          "ref_id": "18560",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "insert overwrite table prj_optimus_prd.optimus_final_bpc\nselect\n  concat(substr(t.quarter,1,4),'/',substr(t.quarter,5,2)) as Fiscal_year,\n  substr(t.quarter,-2,2) as Q_no, \n  p.m_no,\n  t.quarter,\n  t.fiscper,\n  p2.quarter_no,\n  p.month_no,\n  bpc_item,\n  bpc_case,\n  geo,\n  region_or_market,\n  bpc_country,\n  t.country,\n  segment,\n  sub_segment_l1,\n  sub_segment_l2,\n  t.biz_group,\n  biz_unit_l1,\n  biz_unit_l2,\n  t.high_growth_l1,\n  t.high_growth_l2,\n  bpc_parents,\n  account_kpi,\n  sum(case when nvl(biz_unit_l1,'') <> '' then nvl(kpi_value,0) else 0 end) as kpi_value,\n  SUM(case when nvl(biz_unit_l1,'') <> '' then nvl(Last_Year_kpi_value,0) else 0 end ) AS Last_Year_kpi_value,\n  sum( case when bpc_parents='TOTCA' AND nvl(biz_unit_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000 as BPC_CA,\n  sum( case when bpc_parents='TOTREV' AND nvl(biz_unit_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000000 as BPC_Revenue,\n  sum( case when bpc_parents='BMC' AND nvl(biz_unit_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000000 as BPC_BMC,\n  sum( case when bpc_parents='BMCGP' AND nvl(biz_unit_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000000 as BPC_BMCGP,\n  sum( case when (bpc_parents='BMC' OR bpc_parents='TOTNBMC') AND nvl(biz_unit_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000000 as BPC_TMC,\n  sum( case when bpc_parents='TOTGP' AND nvl(biz_unit_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000000 as BPC_TMCGP,\n  sum( case when bpc_parents='TOTCA' AND nvl(biz_unit_l1,'') <> '' and bpc_item='IDC' then nvl(Last_Year_kpi_value, 0) else 0 end )*1000 as Last_Year_IDC_CA,\n  sum( case when bpc_parents='TOTREV' AND nvl(biz_unit_l1,'') <> '' and bpc_item='IDC' then nvl(Last_Year_kpi_value, 0) else 0 end )*1000000 as Last_Year_IDC_Revenue,\n  0 as track_ca,\n  0 as track_revenue,\n  0 as track_bmcgp,\n  0 as track_tmcgp,\n  0 as hg_track_ca,\n  0 as hg_track_revenue,\n  0 as hg_track_bmcgp,\n  0 as hg_track_tmcgp,\n  0 as track_pts,\n  0 as track_pts,\n  \n  sum( case when bpc_parents='TOTCA' and nvl(high_growth_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000 as HG_BPC_CA,\n  sum( case when bpc_parents='TOTREV' and nvl(high_growth_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000000 as HG_BPC_Revenue,\n  sum( case when bpc_parents='BMCGP' and nvl(high_growth_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000000 as HG_BPC_BMCGP,\n  sum( case when bpc_parents='TOTGP' and nvl(high_growth_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000000 as HG_BPC_TMCGP,\n  sum( case when nvl(high_growth_l1,'') <> '' then nvl(kpi_value,0) else 0 end) as hg_kpi_value\nfrom prj_optimus_prd.optimus_bpc_detail t\nleft join prj_optimus_prd.mt_optimus_fiscal_period p\n  on p.fiscper=t.fiscper\nleft join(SELECT DISTINCT quarter,quarter_no FROM  prj_optimus_prd.mt_optimus_fiscal_period ) p2\n  on p2.quarter=t.quarter\nwhere t.quarter<='${cur_qtr}'\ngroup by\n  t.quarter,t.fiscper,p.m_no,p2.quarter_no,p.month_no,\n  bpc_item,bpc_case,\n  geo,region_or_market,bpc_country,t.country,\n  segment,sub_segment_l1,sub_segment_l2,\n  t.biz_group,biz_unit_l1,biz_unit_l2,t.high_growth_l1,t.high_growth_l2,\n  bpc_parents,account_kpi",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "19466513_0_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "hive",
          "cluster": null,
          "project_name": null,
          "job_path": "leap_182:Optimus_BPC_Calculate_MR_Test/IDC_YOY",
          "job_name": "IDC_YOY",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-06 15:01:23",
          "job_end_time": "2019-05-06 15:02:06",
          "job_start_unix_time": 1557126083,
          "job_end_unix_time": 1557126126,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 19466513,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_Optimus",
          "owner_id": "wuth3",
          "ref_id": "18727",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "Insert overwrite table prj_optimus_prd.optimus_bpc_detail partition(partition_case='IDC')\nselect \n    quarter,\n    fiscper,\n    bpc_item,\n    bpc_case,\n    geo,\n    region_or_market,\n    bpc_country,\n    country,\n    ww_bpc_segment,\n    segment,\n    sub_segment_l1,\n    sub_segment_l2,\n    bpc_pgrp,\n    biz_group,\n    biz_unit_l1,\n    biz_unit_l2,\n    high_growth_l1, \n    high_growth_l2,\n    bpc_parents,\n    account_kpi,\n    sum(kpi_value) as kpi_value,\n    sum(Last_Year_kpi_value) as Last_Year_kpi_value\nfrom (select \n        t.quarter,\n        t.fiscper,\n        t.bpc_item,\n        t.bpc_case,\n        t.geo,\n        t.region_or_market,\n        t.bpc_country,\n        t.country,\n        t.ww_bpc_segment,\n        t.segment,\n        t.sub_segment_l1,\n        t.sub_segment_l2,\n        t.bpc_pgrp,\n        t.biz_group,\n        t.biz_unit_l1,\n        t.biz_unit_l2,\n        t.high_growth_l1, \n        t.high_growth_l2, \n        t.bpc_parents,\n        t.account_kpi,\n        t.kpi_value,\n        0 as Last_Year_kpi_value\n       from prj_optimus_prd.optimus_bpc_detail as t\n      WHERE partition_case='IDC' and quarter>='${pre_y_qtr}'\n        union all\n      select \n        CONCAT('FY',CAST(substr(t.quarter,3,2)+1 AS INT),cast(substr(t.quarter,5,2)+1 AS INT),substr(t.quarter,7,2)) AS quarter,\n        concat(cast(substr(t.fiscper,1,4)+1 as int),substr(t.fiscper,5,3)) as fiscper,\n        t.bpc_item,\n        t.bpc_case,\n        t.geo,\n        t.region_or_market,\n        t.bpc_country,\n        t.country,\n        t.ww_bpc_segment,\n        t.segment,\n        t.sub_segment_l1,\n        t.sub_segment_l2,\n        t.bpc_pgrp,\n        t.biz_group,\n        t.biz_unit_l1,\n        t.biz_unit_l2,\n        t.high_growth_l1, \n        t.high_growth_l2, \n        t.bpc_parents,\n        t.account_kpi,\n        0 as kpi_value,\n        t.kpi_value as Last_Year_kpi_value\n       from prj_optimus_prd.optimus_bpc_detail as t\n      WHERE partition_case='IDC' and  quarter<='${pre_y_qtr}') as a \ngroup by \n    quarter,\n    fiscper,\n    bpc_item,\n    bpc_case,\n    geo,\n    region_or_market,\n    bpc_country,\n    country,\n    ww_bpc_segment,\n    segment,\n    sub_segment_l1,\n    sub_segment_l2,\n    bpc_pgrp,\n    biz_group,\n    biz_unit_l1,\n    biz_unit_l2,\n    high_growth_l1, \n    high_growth_l2, \n    bpc_parents,\n    account_kpi",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "19466513_0_-1_data_0",
          "node_type": "data",
          "abstracted_path": "/prj_optimus_prd/optimus_bpc_detail",
          "storage_type": "hive",
          "urn": "hive://prj_optimus_prd/optimus_bpc_detail",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-06 15:01:23",
          "job_end_time": "2019-05-06 15:02:06",
          "job_start_unix_time": 1557126083,
          "job_end_unix_time": 1557126126,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 19466513,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "prj_optimus_prd",
          "tbl_name": "optimus_bpc_detail",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "0",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "19466515_0_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "hive",
          "cluster": null,
          "project_name": null,
          "job_path": "leap_182:Optimus_BPC_Calculate_MR_Test/ACT_YOY",
          "job_name": "ACT_YOY",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-06 15:17:42",
          "job_end_time": "2019-05-06 15:18:47",
          "job_start_unix_time": 1557127062,
          "job_end_unix_time": 1557127127,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 19466515,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_Optimus",
          "owner_id": "wuth3",
          "ref_id": "18727",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "Insert overwrite table prj_optimus_prd.optimus_bpc_detail partition(partition_case='ACT')\nselect \n    quarter,\n    fiscper,\n    bpc_item,\n    max(bpc_case),\n    geo,\n    region_or_market,\n    bpc_country,\n    country,\n    ww_bpc_segment,\n    segment,\n    sub_segment_l1,\n    sub_segment_l2,\n    bpc_pgrp,\n    biz_group,\n    biz_unit_l1,\n    biz_unit_l2,\n    high_growth_l1, \n    high_growth_l2,\n    bpc_parents,\n    account_kpi,\n    sum(kpi_value) as kpi_value,\n    sum(Last_Year_kpi_value) as Last_Year_kpi_value\nfrom (select \n        t.quarter,\n        t.fiscper,\n        t.bpc_item,\n        t.bpc_case,\n        t.geo,\n        t.region_or_market,\n        t.bpc_country,\n        t.country,\n        t.ww_bpc_segment,\n        t.segment,\n        t.sub_segment_l1,\n        t.sub_segment_l2,\n        t.bpc_pgrp,\n        t.biz_group,\n        t.biz_unit_l1,\n        t.biz_unit_l2,\n        t.high_growth_l1, \n        t.high_growth_l2, \n        t.bpc_parents,\n        t.account_kpi,\n        t.kpi_value,\n        0 as Last_Year_kpi_value\n       from prj_optimus_prd.optimus_bpc_detail as t\n      WHERE partition_case='ACT' and  quarter>='${pre_y_qtr}' \n        union all\n      select \n        CONCAT('FY',CAST(substr(t.quarter,3,2)+1 AS INT),cast(substr(t.quarter,5,2)+1 AS INT),substr(t.quarter,7,2)) AS quarter,\n        concat(cast(substr(t.fiscper,1,4)+1 as int),substr(t.fiscper,5,3)) as fiscper,\n        t.bpc_item,\n        t.bpc_case,\n        t.geo,\n        t.region_or_market,\n        t.bpc_country,\n        t.country,\n        t.ww_bpc_segment,\n        t.segment,\n        t.sub_segment_l1,\n        t.sub_segment_l2,\n        t.bpc_pgrp,\n        t.biz_group,\n        t.biz_unit_l1,\n        t.biz_unit_l2,\n        t.high_growth_l1, \n        t.high_growth_l2, \n        t.bpc_parents,\n        t.account_kpi,\n        0 as kpi_value,\n        t.kpi_value as Last_Year_kpi_value\n       from prj_optimus_prd.optimus_bpc_detail as t\n      WHERE partition_case='ACT' and  quarter<='${pre_y_qtr}' ) as a\ngroup by \n    quarter,\n    fiscper,\n    bpc_item,\n    geo,\n    region_or_market,\n    bpc_country,\n    country,\n    ww_bpc_segment,\n    segment,\n    sub_segment_l1,\n    sub_segment_l2,\n    bpc_pgrp,\n    biz_group,\n    biz_unit_l1,\n    biz_unit_l2,\n    high_growth_l1, \n    high_growth_l2, \n    bpc_parents,\n    account_kpi",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "19466515_0_-1_data_0",
          "node_type": "data",
          "abstracted_path": "/prj_optimus_prd/optimus_bpc_detail",
          "storage_type": "hive",
          "urn": "hive://prj_optimus_prd/optimus_bpc_detail",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-06 15:17:42",
          "job_end_time": "2019-05-06 15:18:47",
          "job_start_unix_time": 1557127062,
          "job_end_unix_time": 1557127127,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 19466515,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "prj_optimus_prd",
          "tbl_name": "optimus_bpc_detail",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "0",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "19466518_0_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "hive",
          "cluster": null,
          "project_name": null,
          "job_path": "leap_182:Optimus_BPC_Calculate_MR_Test/Final_BPC",
          "job_name": "Final_BPC",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-06 15:18:47",
          "job_end_time": "2019-05-06 15:24:00",
          "job_start_unix_time": 1557127127,
          "job_end_unix_time": 1557127440,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 19466518,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_Optimus",
          "owner_id": "wuth3",
          "ref_id": "18727",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "insert overwrite table prj_optimus_prd.optimus_final_bpc\nselect\n  concat(substr(t.quarter,1,4),'/',substr(t.quarter,5,2)) as Fiscal_year,\n  substr(t.quarter,-2,2) as Q_no, \n  p.m_no,\n  t.quarter,\n  t.fiscper,\n  p2.quarter_no,\n  p.month_no,\n  bpc_item,\n  bpc_case,\n  geo,\n  region_or_market,\n  bpc_country,\n  t.country,\n  segment,\n  sub_segment_l1,\n  sub_segment_l2,\n  t.biz_group,\n  biz_unit_l1,\n  biz_unit_l2,\n  t.high_growth_l1,\n  t.high_growth_l2,\n  bpc_parents,\n  account_kpi,\n  sum(case when nvl(biz_unit_l1,'') <> '' then nvl(kpi_value,0) else 0 end) as kpi_value,\n  SUM(case when nvl(biz_unit_l1,'') <> '' then nvl(Last_Year_kpi_value,0) else 0 end ) AS Last_Year_kpi_value,\n  sum( case when bpc_parents='TOTCA' AND nvl(biz_unit_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000 as BPC_CA,\n  sum( case when bpc_parents='TOTREV' AND nvl(biz_unit_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000000 as BPC_Revenue,\n  sum( case when bpc_parents='BMC' AND nvl(biz_unit_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000000 as BPC_BMC,\n  sum( case when bpc_parents='BMCGP' AND nvl(biz_unit_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000000 as BPC_BMCGP,\n  sum( case when (bpc_parents='BMC' OR bpc_parents='TOTNBMC') AND nvl(biz_unit_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000000 as BPC_TMC,\n  sum( case when bpc_parents='TOTGP' AND nvl(biz_unit_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000000 as BPC_TMCGP,\n  sum( case when bpc_parents='TOTCA' AND nvl(biz_unit_l1,'') <> '' and bpc_item='IDC' then nvl(Last_Year_kpi_value, 0) else 0 end )*1000 as Last_Year_IDC_CA,\n  sum( case when bpc_parents='TOTREV' AND nvl(biz_unit_l1,'') <> '' and bpc_item='IDC' then nvl(Last_Year_kpi_value, 0) else 0 end )*1000000 as Last_Year_IDC_Revenue,\n  0 as track_ca,\n  0 as track_revenue,\n  0 as track_bmcgp,\n  0 as track_tmcgp,\n  0 as hg_track_ca,\n  0 as hg_track_revenue,\n  0 as hg_track_bmcgp,\n  0 as hg_track_tmcgp,\n  0 as track_pts,\n  0 as track_pts,\n  \n  sum( case when bpc_parents='TOTCA' and nvl(high_growth_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000 as HG_BPC_CA,\n  sum( case when bpc_parents='TOTREV' and nvl(high_growth_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000000 as HG_BPC_Revenue,\n  sum( case when bpc_parents='BMCGP' and nvl(high_growth_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000000 as HG_BPC_BMCGP,\n  sum( case when bpc_parents='TOTGP' and nvl(high_growth_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000000 as HG_BPC_TMCGP,\n  sum( case when nvl(high_growth_l1,'') <> '' then nvl(kpi_value,0) else 0 end) as hg_kpi_value\nfrom prj_optimus_prd.optimus_bpc_detail t\nleft join prj_optimus_prd.mt_optimus_fiscal_period p\n  on p.fiscper=t.fiscper\nleft join(SELECT DISTINCT quarter,quarter_no FROM  prj_optimus_prd.mt_optimus_fiscal_period ) p2\n  on p2.quarter=t.quarter\nwhere t.quarter<='${cur_qtr}'\ngroup by\n  t.quarter,t.fiscper,p.m_no,p2.quarter_no,p.month_no,\n  bpc_item,bpc_case,\n  geo,region_or_market,bpc_country,t.country,\n  segment,sub_segment_l1,sub_segment_l2,\n  t.biz_group,biz_unit_l1,biz_unit_l2,t.high_growth_l1,t.high_growth_l2,\n  bpc_parents,account_kpi",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20267188_0_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PRJ_Optimus:Optimus_BPC_Calculate/IDC_YOY",
          "job_name": "IDC_YOY",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 05:11:31",
          "job_end_time": "2019-05-22 05:11:46",
          "job_start_unix_time": 1558473091,
          "job_end_unix_time": 1558473106,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20267188,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_Optimus",
          "owner_id": "houqn1",
          "ref_id": "18560",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "Insert overwrite table prj_optimus_prd.optimus_bpc_detail partition(partition_case='IDC')\nselect \n    quarter,\n    fiscper,\n    bpc_item,\n    bpc_case,\n    geo,\n    region_or_market,\n    bpc_country,\n    country,\n    ww_bpc_segment,\n    segment,\n    sub_segment_l1,\n    sub_segment_l2,\n    bpc_pgrp,\n    biz_group,\n    biz_unit_l1,\n    biz_unit_l2,\n    high_growth_l1, \n    high_growth_l2,\n    bpc_parents,\n    account_kpi,\n    sum(kpi_value) as kpi_value,\n    sum(Last_Year_kpi_value) as Last_Year_kpi_value\nfrom (select \n        t.quarter,\n        t.fiscper,\n        t.bpc_item,\n        t.bpc_case,\n        t.geo,\n        t.region_or_market,\n        t.bpc_country,\n        t.country,\n        t.ww_bpc_segment,\n        t.segment,\n        t.sub_segment_l1,\n        t.sub_segment_l2,\n        t.bpc_pgrp,\n        t.biz_group,\n        t.biz_unit_l1,\n        t.biz_unit_l2,\n        t.high_growth_l1, \n        t.high_growth_l2, \n        t.bpc_parents,\n        t.account_kpi,\n        t.kpi_value,\n        0 as Last_Year_kpi_value\n       from prj_optimus_prd.optimus_bpc_detail as t\n      WHERE partition_case='IDC' and quarter>='${pre_y_qtr}'\n        union all\n      select \n        CONCAT('FY',CAST(substr(t.quarter,3,2)+1 AS INT),cast(substr(t.quarter,5,2)+1 AS INT),substr(t.quarter,7,2)) AS quarter,\n        concat(cast(substr(t.fiscper,1,4)+1 as int),substr(t.fiscper,5,3)) as fiscper,\n        t.bpc_item,\n        t.bpc_case,\n        t.geo,\n        t.region_or_market,\n        t.bpc_country,\n        t.country,\n        t.ww_bpc_segment,\n        t.segment,\n        t.sub_segment_l1,\n        t.sub_segment_l2,\n        t.bpc_pgrp,\n        t.biz_group,\n        t.biz_unit_l1,\n        t.biz_unit_l2,\n        t.high_growth_l1, \n        t.high_growth_l2, \n        t.bpc_parents,\n        t.account_kpi,\n        0 as kpi_value,\n        t.kpi_value as Last_Year_kpi_value\n       from prj_optimus_prd.optimus_bpc_detail as t\n      WHERE partition_case='IDC' and  quarter<='${pre_y_qtr}') as a \ngroup by \n    quarter,\n    fiscper,\n    bpc_item,\n    bpc_case,\n    geo,\n    region_or_market,\n    bpc_country,\n    country,\n    ww_bpc_segment,\n    segment,\n    sub_segment_l1,\n    sub_segment_l2,\n    bpc_pgrp,\n    biz_group,\n    biz_unit_l1,\n    biz_unit_l2,\n    high_growth_l1, \n    high_growth_l2, \n    bpc_parents,\n    account_kpi",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20267188_0_-1_data_0",
          "node_type": "data",
          "abstracted_path": "/prj_optimus_prd/optimus_bpc_detail",
          "storage_type": "spark",
          "urn": "spark://prj_optimus_prd/optimus_bpc_detail",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 05:11:31",
          "job_end_time": "2019-05-22 05:11:46",
          "job_start_unix_time": 1558473091,
          "job_end_unix_time": 1558473106,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20267188,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "prj_optimus_prd",
          "tbl_name": "optimus_bpc_detail",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "0",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20267194_0_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PRJ_Optimus:Optimus_BPC_Calculate/ACT_YOY",
          "job_name": "ACT_YOY",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 05:12:54",
          "job_end_time": "2019-05-22 05:13:25",
          "job_start_unix_time": 1558473174,
          "job_end_unix_time": 1558473205,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20267194,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_Optimus",
          "owner_id": "houqn1",
          "ref_id": "18560",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "Insert overwrite table prj_optimus_prd.optimus_bpc_detail partition(partition_case='ACT')\nselect \n    quarter,\n    fiscper,\n    bpc_item,\n    max(bpc_case),\n    geo,\n    region_or_market,\n    bpc_country,\n    country,\n    ww_bpc_segment,\n    segment,\n    sub_segment_l1,\n    sub_segment_l2,\n    bpc_pgrp,\n    biz_group,\n    biz_unit_l1,\n    biz_unit_l2,\n    high_growth_l1, \n    high_growth_l2,\n    bpc_parents,\n    account_kpi,\n    sum(kpi_value) as kpi_value,\n    sum(Last_Year_kpi_value) as Last_Year_kpi_value\nfrom (select \n        t.quarter,\n        t.fiscper,\n        t.bpc_item,\n        t.bpc_case,\n        t.geo,\n        t.region_or_market,\n        t.bpc_country,\n        t.country,\n        t.ww_bpc_segment,\n        t.segment,\n        t.sub_segment_l1,\n        t.sub_segment_l2,\n        t.bpc_pgrp,\n        t.biz_group,\n        t.biz_unit_l1,\n        t.biz_unit_l2,\n        t.high_growth_l1, \n        t.high_growth_l2, \n        t.bpc_parents,\n        t.account_kpi,\n        t.kpi_value,\n        0 as Last_Year_kpi_value\n       from prj_optimus_prd.optimus_bpc_detail as t\n      WHERE partition_case='ACT' and  quarter>='${pre_y_qtr}' \n        union all\n      select \n        CONCAT('FY',CAST(substr(t.quarter,3,2)+1 AS INT),cast(substr(t.quarter,5,2)+1 AS INT),substr(t.quarter,7,2)) AS quarter,\n        concat(cast(substr(t.fiscper,1,4)+1 as int),substr(t.fiscper,5,3)) as fiscper,\n        t.bpc_item,\n        t.bpc_case,\n        t.geo,\n        t.region_or_market,\n        t.bpc_country,\n        t.country,\n        t.ww_bpc_segment,\n        t.segment,\n        t.sub_segment_l1,\n        t.sub_segment_l2,\n        t.bpc_pgrp,\n        t.biz_group,\n        t.biz_unit_l1,\n        t.biz_unit_l2,\n        t.high_growth_l1, \n        t.high_growth_l2, \n        t.bpc_parents,\n        t.account_kpi,\n        0 as kpi_value,\n        t.kpi_value as Last_Year_kpi_value\n       from prj_optimus_prd.optimus_bpc_detail as t\n      WHERE partition_case='ACT' and  quarter<='${pre_y_qtr}' ) as a\ngroup by \n    quarter,\n    fiscper,\n    bpc_item,\n    geo,\n    region_or_market,\n    bpc_country,\n    country,\n    ww_bpc_segment,\n    segment,\n    sub_segment_l1,\n    sub_segment_l2,\n    bpc_pgrp,\n    biz_group,\n    biz_unit_l1,\n    biz_unit_l2,\n    high_growth_l1, \n    high_growth_l2, \n    bpc_parents,\n    account_kpi",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20267194_0_-1_data_0",
          "node_type": "data",
          "abstracted_path": "/prj_optimus_prd/optimus_bpc_detail",
          "storage_type": "spark",
          "urn": "spark://prj_optimus_prd/optimus_bpc_detail",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 05:12:54",
          "job_end_time": "2019-05-22 05:13:25",
          "job_start_unix_time": 1558473174,
          "job_end_unix_time": 1558473205,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20267194,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "prj_optimus_prd",
          "tbl_name": "optimus_bpc_detail",
          "sqlText": null,
          "datasetId": null,
          "srl_no": "0",
          "datasetType": "",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20267190_0_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PRJ_Optimus:Optimus_BPC_Calculate/Final_BPC",
          "job_name": "Final_BPC",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 05:13:25",
          "job_end_time": "2019-05-22 05:16:00",
          "job_start_unix_time": 1558473205,
          "job_end_unix_time": 1558473360,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20267190,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PRJ_Optimus",
          "owner_id": "houqn1",
          "ref_id": "18560",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "insert overwrite table prj_optimus_prd.optimus_final_bpc\nselect\n  concat(substr(t.quarter,1,4),'/',substr(t.quarter,5,2)) as Fiscal_year,\n  substr(t.quarter,-2,2) as Q_no, \n  p.m_no,\n  t.quarter,\n  t.fiscper,\n  p2.quarter_no,\n  p.month_no,\n  bpc_item,\n  bpc_case,\n  geo,\n  region_or_market,\n  bpc_country,\n  t.country,\n  segment,\n  sub_segment_l1,\n  sub_segment_l2,\n  t.biz_group,\n  biz_unit_l1,\n  biz_unit_l2,\n  t.high_growth_l1,\n  t.high_growth_l2,\n  bpc_parents,\n  account_kpi,\n  sum(case when nvl(biz_unit_l1,'') <> '' then nvl(kpi_value,0) else 0 end) as kpi_value,\n  SUM(case when nvl(biz_unit_l1,'') <> '' then nvl(Last_Year_kpi_value,0) else 0 end ) AS Last_Year_kpi_value,\n  sum( case when bpc_parents='TOTCA' AND nvl(biz_unit_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000 as BPC_CA,\n  sum( case when bpc_parents='TOTREV' AND nvl(biz_unit_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000000 as BPC_Revenue,\n  sum( case when bpc_parents='BMC' AND nvl(biz_unit_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000000 as BPC_BMC,\n  sum( case when bpc_parents='BMCGP' AND nvl(biz_unit_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000000 as BPC_BMCGP,\n  sum( case when (bpc_parents='BMC' OR bpc_parents='TOTNBMC') AND nvl(biz_unit_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000000 as BPC_TMC,\n  sum( case when bpc_parents='TOTGP' AND nvl(biz_unit_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000000 as BPC_TMCGP,\n  sum( case when bpc_parents='TOTCA' AND nvl(biz_unit_l1,'') <> '' and bpc_item='IDC' then nvl(Last_Year_kpi_value, 0) else 0 end )*1000 as Last_Year_IDC_CA,\n  sum( case when bpc_parents='TOTREV' AND nvl(biz_unit_l1,'') <> '' and bpc_item='IDC' then nvl(Last_Year_kpi_value, 0) else 0 end )*1000000 as Last_Year_IDC_Revenue,\n  0 as track_ca,\n  0 as track_revenue,\n  0 as track_bmcgp,\n  0 as track_tmcgp,\n  0 as hg_track_ca,\n  0 as hg_track_revenue,\n  0 as hg_track_bmcgp,\n  0 as hg_track_tmcgp,\n  0 as track_pts,\n  0 as track_pts,\n  \n  sum( case when bpc_parents='TOTCA' and nvl(high_growth_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000 as HG_BPC_CA,\n  sum( case when bpc_parents='TOTREV' and nvl(high_growth_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000000 as HG_BPC_Revenue,\n  sum( case when bpc_parents='BMCGP' and nvl(high_growth_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000000 as HG_BPC_BMCGP,\n  sum( case when bpc_parents='TOTGP' and nvl(high_growth_l1,'') <> '' then nvl(kpi_value, 0) else 0 end )*1000000 as HG_BPC_TMCGP,\n  sum( case when nvl(high_growth_l1,'') <> '' then nvl(kpi_value,0) else 0 end) as hg_kpi_value\nfrom prj_optimus_prd.optimus_bpc_detail t\nleft join prj_optimus_prd.mt_optimus_fiscal_period p\n  on p.fiscper=t.fiscper\nleft join(SELECT DISTINCT quarter,quarter_no FROM  prj_optimus_prd.mt_optimus_fiscal_period ) p2\n  on p2.quarter=t.quarter\nwhere t.quarter<='${cur_qtr}'\ngroup by\n  t.quarter,t.fiscper,p.m_no,p2.quarter_no,p.month_no,\n  bpc_item,bpc_case,\n  geo,region_or_market,bpc_country,t.country,\n  segment,sub_segment_l1,sub_segment_l2,\n  t.biz_group,biz_unit_l1,biz_unit_l2,t.high_growth_l1,t.high_growth_l2,\n  bpc_parents,account_kpi",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20270235_1_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Group_Total_Revenue/union_all",
          "job_name": "union_all",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 05:41:01",
          "job_end_time": "2019-05-22 05:43:34",
          "job_start_unix_time": 1558474861,
          "job_end_unix_time": 1558475014,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20270235,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "14510",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "\n\n\ninsert OVERWRITE table proj_tx_kpi_prd.T_Transformation_BG_Total_Revenue\nselect \nCASE WHEN UPPER(zbpc_time) LIKE '%.JAN' THEN concat(substring(zbpc_time,1,4),'-01')\n            WHEN UPPER(zbpc_time) LIKE '%.FEB' THEN concat(substring(zbpc_time,1,4),'-02')\n            WHEN UPPER(zbpc_time) LIKE '%.MAR' THEN concat(substring(zbpc_time,1,4),'-03')\n            WHEN UPPER(zbpc_time) LIKE '%.APR' THEN concat(substring(zbpc_time,1,4),'-04')\n            WHEN UPPER(zbpc_time) LIKE '%.MAY' THEN concat(substring(zbpc_time,1,4),'-05')\n            WHEN UPPER(zbpc_time) LIKE '%.JUN' THEN concat(substring(zbpc_time,1,4),'-06')\n            WHEN UPPER(zbpc_time) LIKE '%.JUL' THEN concat(substring(zbpc_time,1,4),'-07')\n            WHEN UPPER(zbpc_time) LIKE '%.AUG' THEN concat(substring(zbpc_time,1,4),'-08')\n            WHEN UPPER(zbpc_time) LIKE '%.SEP' THEN concat(substring(zbpc_time,1,4),'-09')\n            WHEN UPPER(zbpc_time) LIKE '%.OCT' THEN concat(substring(zbpc_time,1,4),'-10')\n            WHEN UPPER(zbpc_time) LIKE '%.NOV' THEN concat(substring(zbpc_time,1,4),'-11')\n            WHEN UPPER(zbpc_time) LIKE '%.DEC' THEN concat(substring(zbpc_time,1,4),'-12')\n            END zbpc_time,\nkpi_layer1,\nbg,\nzbpc_data\nfrom\n(\nselect * from proj_tx_kpi_prd.T_Transformation_BG_Total_Revenue_LCIG\nUNION ALL\nselect * from proj_tx_kpi_prd.T_Transformation_BG_Total_Revenue_middle\n)\nA\n\n",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 1,
          "rootNode": false
        },
        {
          "id": "20270235_1_-1_data_9",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_bg_total_revenue_lcig",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_bg_total_revenue_lcig",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 05:41:01",
          "job_end_time": "2019-05-22 05:43:34",
          "job_start_unix_time": 1558474861,
          "job_end_unix_time": 1558475014,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20270235,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_bg_total_revenue_lcig",
          "sqlText": null,
          "datasetId": 4655980,
          "srl_no": "9",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 1,
          "rootNode": false
        },
        {
          "id": "20270235_1_-1_data_8",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_bg_total_revenue",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_bg_total_revenue",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 05:41:01",
          "job_end_time": "2019-05-22 05:43:34",
          "job_start_unix_time": 1558474861,
          "job_end_unix_time": 1558475014,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20270235,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_bg_total_revenue",
          "sqlText": null,
          "datasetId": 4655978,
          "srl_no": "8",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 1,
          "rootNode": false
        },
        {
          "id": "20288738_0_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Five_Part_PcServicePenRate_denominator/all_main",
          "job_name": "all_main",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:37:16",
          "job_end_time": "2019-05-22 12:39:56",
          "job_start_unix_time": 1558499836,
          "job_end_unix_time": 1558499996,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288738,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16360",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "insert overwrite table  proj_tx_kpi_prd.T_Transformation_Five_denominator_main\n\nselect \nA.zbpc_month\n,A.zbpc_time\n,A.geo\n,A.kpi_name\n,case when A.geo='PRCG' then (A.zbpc_data + B.zbpc_data)\n      when A.geo='EMEANEW' then (A.zbpc_data - C.zbpc_data)\n      else A.zbpc_data\n    end as zbpc_data\nfrom \nproj_tx_kpi_prd.T_Transformation_Five_denominator A\nleft join\nproj_tx_kpi_prd.T_Transformation_Five_Sunny  B\non A.zbpc_time =B.zbpc_time and A.geo=B.geo and A.zbpc_month = B.zbpc_month\nleft join\n\n(select\nzbpc_month \n,zbpc_time\n,'EMEANEW' as geo\n,kpi_name\n,zbpc_data\nfrom\nproj_tx_kpi_prd.T_Transformation_Five_Medion )C\non A.zbpc_time=C.zbpc_time and A.geo=C.geo and A.zbpc_month = C.zbpc_month\n\nunion all\nselect * from proj_tx_kpi_prd.T_Transformation_Five_part_denominator_BT\n",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288738_0_-1_data_1",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_five_denominator",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_five_denominator",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:37:16",
          "job_end_time": "2019-05-22 12:39:56",
          "job_start_unix_time": 1558499836,
          "job_end_unix_time": 1558499996,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20288738,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_five_denominator",
          "sqlText": null,
          "datasetId": 4656004,
          "srl_no": "1",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288738_0_-1_data_3",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_five_medion",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_five_medion",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:37:16",
          "job_end_time": "2019-05-22 12:39:56",
          "job_start_unix_time": 1558499836,
          "job_end_unix_time": 1558499996,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20288738,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_five_medion",
          "sqlText": null,
          "datasetId": 4656007,
          "srl_no": "3",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288738_0_-1_data_4",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_five_part_denominator_bt",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_five_part_denominator_bt",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:37:16",
          "job_end_time": "2019-05-22 12:39:56",
          "job_start_unix_time": 1558499836,
          "job_end_unix_time": 1558499996,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20288738,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_five_part_denominator_bt",
          "sqlText": null,
          "datasetId": 4656011,
          "srl_no": "4",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288738_0_-1_data_0",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_five_denominator_main",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_five_denominator_main",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:37:16",
          "job_end_time": "2019-05-22 12:39:56",
          "job_start_unix_time": 1558499836,
          "job_end_unix_time": 1558499996,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288738,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_five_denominator_main",
          "sqlText": null,
          "datasetId": 4656005,
          "srl_no": "0",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288741_1_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_Global_Accounts_and_Relationship/T_Transformation_PCSD_Relationship_Middle_M",
          "job_name": "T_Transformation_PCSD_Relationship_Middle_M",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:34:14",
          "job_end_time": "2019-05-22 12:36:03",
          "job_start_unix_time": 1558499654,
          "job_end_unix_time": 1558499763,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288741,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16393",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "\n\n-- 落地 table \ninsert overwrite table proj_tx_kpi_prd.T_Transformation_PCSD_Relationship_M\n\n\nselect \nzbpc_time \n,kpi_name\n,geo\n,bu\n,sum(zbpc_data) as zbpc_data \n--,sum(sum(zbpc_data)) OVER (PARTITION BY kpi_name,geo,bu ORDER BY zbpc_time ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS cumulative_amount\nfrom\nproj_tx_kpi_prd.T_Transformation_PCSD_Relationship_Middle_M\ngroup by\nzbpc_time,kpi_name,geo,bu\n",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 1,
          "rootNode": false
        },
        {
          "id": "20288741_1_-1_data_9",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_pcsd_relationship_m",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_pcsd_relationship_m",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:34:14",
          "job_end_time": "2019-05-22 12:36:03",
          "job_start_unix_time": 1558499654,
          "job_end_unix_time": 1558499763,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288741,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_pcsd_relationship_m",
          "sqlText": null,
          "datasetId": 4656116,
          "srl_no": "9",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 1,
          "rootNode": false
        },
        {
          "id": "20288708_0_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:idg_medion_non_pc_all_kpi_name_Fact_Geo/idg_medion_non_pc_all_kpi_name_Fact_Geo",
          "job_name": "idg_medion_non_pc_all_kpi_name_Fact_Geo",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:38:43",
          "job_end_time": "2019-05-22 12:39:56",
          "job_start_unix_time": 1558499923,
          "job_end_unix_time": 1558499996,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288708,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16224",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "--union all all kpi iteam\ninsert overwrite table proj_tx_kpi_prd.idg_medion_non_pc_all_kpi_name_Fact_Geo\n\nselect * from proj_tx_kpi_prd.medion_mobile_Fact_Geo \nunion all\nselect * from proj_tx_kpi_prd.medion_content_other_bigtal_Fact_Geo \nunion all\nselect * from proj_tx_kpi_prd.medion_pc_bounty_Fact_Geo \n",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288708_0_-1_data_0",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/medion_content_other_bigtal_fact_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/medion_content_other_bigtal_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:38:43",
          "job_end_time": "2019-05-22 12:39:56",
          "job_start_unix_time": 1558499923,
          "job_end_unix_time": 1558499996,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20288708,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "medion_content_other_bigtal_fact_geo",
          "sqlText": null,
          "datasetId": 4655940,
          "srl_no": "0",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288708_0_-1_data_1",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/medion_mobile_fact_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/medion_mobile_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:38:43",
          "job_end_time": "2019-05-22 12:39:56",
          "job_start_unix_time": 1558499923,
          "job_end_unix_time": 1558499996,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20288708,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "medion_mobile_fact_geo",
          "sqlText": null,
          "datasetId": 4655944,
          "srl_no": "1",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288708_0_-1_data_3",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/idg_medion_non_pc_all_kpi_name_fact_geo",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/idg_medion_non_pc_all_kpi_name_fact_geo",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:38:43",
          "job_end_time": "2019-05-22 12:39:56",
          "job_start_unix_time": 1558499923,
          "job_end_unix_time": 1558499996,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288708,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "idg_medion_non_pc_all_kpi_name_fact_geo",
          "sqlText": null,
          "datasetId": 4655910,
          "srl_no": "3",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288719_0_-1_script_0",
          "node_type": "script",
          "abstracted_path": null,
          "storage_type": null,
          "urn": null,
          "job_type": "sparksql",
          "cluster": null,
          "project_name": null,
          "job_path": "PROJ_TX_KPI_Automation:T_Transformation_5_Object/T_Transformation_5_Object",
          "job_name": "T_Transformation_5_Object",
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:32:13",
          "job_end_time": "2019-05-22 12:33:26",
          "job_start_unix_time": 1558499533,
          "job_end_unix_time": 1558499606,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "etl_name",
            "job_name",
            "job_type",
            "app_name",
            "owner_id",
            "ref_id",
            "job_start_time",
            "job_end_time"
          ],
          "source_target_type": "source",
          "exec_id": 20288719,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": "PROCESS",
          "app_name": "PROJ_TX_KPI_Automation",
          "owner_id": "wangfang12",
          "ref_id": "16274",
          "db_name": null,
          "tbl_name": null,
          "sqlText": "insert overwrite table proj_tx_kpi_prd.T_Transformation_Five_Object\nselect * from  proj_tx_kpi_prd.T_Transformation_Hyperscale\nunion all\nselect * from  proj_tx_kpi_prd.T_Transformation_SDI",
          "datasetId": null,
          "srl_no": null,
          "datasetType": null,
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288719_0_-1_data_2",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_hyperscale",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_hyperscale",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:32:13",
          "job_end_time": "2019-05-22 12:33:26",
          "job_start_unix_time": 1558499533,
          "job_end_unix_time": 1558499606,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "source",
          "exec_id": 20288719,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_hyperscale",
          "sqlText": null,
          "datasetId": 4656027,
          "srl_no": "2",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        },
        {
          "id": "20288719_0_-1_data_1",
          "node_type": "data",
          "abstracted_path": "/proj_tx_kpi_prd/t_transformation_five_object",
          "storage_type": "spark",
          "urn": "spark://proj_tx_kpi_prd/t_transformation_five_object",
          "job_type": null,
          "cluster": null,
          "project_name": null,
          "job_path": null,
          "job_name": null,
          "script_name": null,
          "script_path": null,
          "job_start_time": "2019-05-22 12:32:13",
          "job_end_time": "2019-05-22 12:33:26",
          "job_start_unix_time": 1558499533,
          "job_end_unix_time": 1558499606,
          "level": -1,
          "git_location": null,
          "_sort_list": [
            "storage_type",
            "db_name",
            "tbl_name"
          ],
          "source_target_type": "target",
          "exec_id": 20288719,
          "job_id": null,
          "record_count": null,
          "application_id": 0,
          "format_mask": null,
          "partition_type": null,
          "operation": null,
          "partition_start": null,
          "partition_end": null,
          "full_object_name": null,
          "pre_jobs": null,
          "post_jobs": null,
          "etl_name": null,
          "app_name": null,
          "owner_id": null,
          "ref_id": null,
          "db_name": "proj_tx_kpi_prd",
          "tbl_name": "t_transformation_five_object",
          "sqlText": null,
          "datasetId": 4656008,
          "srl_no": "1",
          "datasetType": "Table",
          "relatedTables": null,
          "source_srl_no": 0,
          "rootNode": false
        }
      ],
      "links": [
        {
          "id": 0,
          "source": "18864935_0_0_data_0",
          "target": "18864935_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 1,
          "source": "18864935_0_0_data_1",
          "target": "18864935_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 2,
          "source": "18864935_0_0_data_2",
          "target": "18864935_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 3,
          "source": "18864935_0_0_data_3",
          "target": "18864935_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 4,
          "source": "18864935_0_0_data_5",
          "target": "18864935_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 5,
          "source": "18864935_0_0_data_6",
          "target": "18864935_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 6,
          "source": "18864935_0_0_data_7",
          "target": "18864935_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 7,
          "source": "18864935_0_0_script_0",
          "target": "18864935_0_0_data_4",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 8,
          "source": "18864935_0_0_data_0",
          "target": "18864937_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 9,
          "source": "18864935_0_0_data_1",
          "target": "18864937_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 10,
          "source": "18864937_0_0_data_2",
          "target": "18864937_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 11,
          "source": "18864935_0_0_data_2",
          "target": "18864937_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 12,
          "source": "18864935_0_0_data_3",
          "target": "18864937_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 13,
          "source": "18864935_0_0_data_5",
          "target": "18864937_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 14,
          "source": "18864935_0_0_data_6",
          "target": "18864937_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 15,
          "source": "18864935_0_0_data_7",
          "target": "18864937_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 16,
          "source": "18864937_0_0_script_0",
          "target": "18864935_0_0_data_4",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 17,
          "source": "20270233_0_0_data_0",
          "target": "20270233_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 18,
          "source": "20270233_0_0_data_1",
          "target": "20270233_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 19,
          "source": "18864935_0_0_data_0",
          "target": "20270233_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 20,
          "source": "20270233_0_0_data_4",
          "target": "20270233_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 21,
          "source": "20270233_0_0_data_5",
          "target": "20270233_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 22,
          "source": "20270233_0_0_data_6",
          "target": "20270233_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 23,
          "source": "20270233_0_0_script_0",
          "target": "20270233_0_0_data_3",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 24,
          "source": "20270233_0_0_data_1",
          "target": "20288699_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 25,
          "source": "18864935_0_0_data_0",
          "target": "20288699_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 26,
          "source": "20270233_0_0_data_4",
          "target": "20288699_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 27,
          "source": "20270233_0_0_data_5",
          "target": "20288699_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 28,
          "source": "20270233_0_0_data_6",
          "target": "20288699_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 29,
          "source": "20288699_0_0_script_0",
          "target": "20288699_0_0_data_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 30,
          "source": "20288689_0_0_data_0",
          "target": "20288689_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 31,
          "source": "20270233_0_0_data_1",
          "target": "20288689_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 32,
          "source": "20288689_0_0_data_2",
          "target": "20288689_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 33,
          "source": "20270233_0_0_data_4",
          "target": "20288689_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 34,
          "source": "20288689_0_0_data_4",
          "target": "20288689_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 35,
          "source": "20270233_0_0_data_6",
          "target": "20288689_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 36,
          "source": "20288689_0_0_data_6",
          "target": "20288689_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 37,
          "source": "20270233_0_0_data_0",
          "target": "20288689_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 38,
          "source": "20288689_0_0_data_8",
          "target": "20288689_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 39,
          "source": "18864935_0_0_data_0",
          "target": "20288689_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 40,
          "source": "20270233_0_0_data_5",
          "target": "20288689_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 41,
          "source": "20288689_0_0_data_11",
          "target": "20288689_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 42,
          "source": "20288689_0_0_script_0",
          "target": "20288689_0_0_data_12",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 43,
          "source": "20270233_0_0_data_0",
          "target": "20288693_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 44,
          "source": "20270233_0_0_data_1",
          "target": "20288693_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 45,
          "source": "18864935_0_0_data_0",
          "target": "20288693_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 46,
          "source": "20270233_0_0_data_4",
          "target": "20288693_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 47,
          "source": "20270233_0_0_data_5",
          "target": "20288693_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 48,
          "source": "20270233_0_0_data_6",
          "target": "20288693_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 49,
          "source": "20288693_0_0_script_0",
          "target": "20288693_0_0_data_6",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 50,
          "source": "20270233_0_0_data_0",
          "target": "20270234_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 51,
          "source": "20270233_0_0_data_1",
          "target": "20270234_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 52,
          "source": "18864935_0_0_data_0",
          "target": "20270234_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 53,
          "source": "20270233_0_0_data_4",
          "target": "20270234_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 54,
          "source": "20270233_0_0_data_5",
          "target": "20270234_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 55,
          "source": "20270233_0_0_data_6",
          "target": "20270234_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 56,
          "source": "20270234_0_0_script_0",
          "target": "20270234_0_0_data_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 57,
          "source": "20270233_0_0_data_0",
          "target": "20288707_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 58,
          "source": "20270233_0_0_data_1",
          "target": "20288707_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 59,
          "source": "18864935_0_0_data_0",
          "target": "20288707_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 60,
          "source": "20270233_0_0_data_4",
          "target": "20288707_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 61,
          "source": "20270233_0_0_data_5",
          "target": "20288707_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 62,
          "source": "20270233_0_0_data_6",
          "target": "20288707_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 63,
          "source": "20288707_0_0_script_0",
          "target": "20288707_0_0_data_5",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 64,
          "source": "20270233_0_0_data_1",
          "target": "20288690_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 65,
          "source": "18864935_0_0_data_0",
          "target": "20288690_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 66,
          "source": "20270233_0_0_data_4",
          "target": "20288690_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 67,
          "source": "20270233_0_0_data_5",
          "target": "20288690_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 68,
          "source": "20270233_0_0_data_6",
          "target": "20288690_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 69,
          "source": "20288690_0_0_script_0",
          "target": "20288690_0_0_data_3",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 70,
          "source": "20270233_0_0_data_0",
          "target": "20270235_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 71,
          "source": "20270233_0_0_data_1",
          "target": "20270235_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 72,
          "source": "18864935_0_0_data_0",
          "target": "20270235_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 73,
          "source": "20270233_0_0_data_4",
          "target": "20270235_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 74,
          "source": "20270233_0_0_data_5",
          "target": "20270235_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 75,
          "source": "20270233_0_0_data_6",
          "target": "20270235_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 76,
          "source": "20270235_0_0_script_0",
          "target": "20270235_0_0_data_3",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 77,
          "source": "20270233_0_0_data_0",
          "target": "20288709_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 78,
          "source": "20270233_0_0_data_1",
          "target": "20288709_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 79,
          "source": "18864935_0_0_data_0",
          "target": "20288709_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 80,
          "source": "20270233_0_0_data_4",
          "target": "20288709_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 81,
          "source": "20270233_0_0_data_5",
          "target": "20288709_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 82,
          "source": "20270233_0_0_data_6",
          "target": "20288709_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 83,
          "source": "20288709_0_0_script_0",
          "target": "20288709_0_0_data_3",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 84,
          "source": "20270233_0_0_data_0",
          "target": "20288694_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 85,
          "source": "20270233_0_0_data_1",
          "target": "20288694_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 86,
          "source": "18864935_0_0_data_0",
          "target": "20288694_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 87,
          "source": "20270233_0_0_data_4",
          "target": "20288694_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 88,
          "source": "20270233_0_0_data_5",
          "target": "20288694_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 89,
          "source": "20270233_0_0_data_6",
          "target": "20288694_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 90,
          "source": "20288694_0_0_script_0",
          "target": "20288694_0_0_data_3",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 91,
          "source": "20270233_0_0_data_1",
          "target": "20288703_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 92,
          "source": "18864935_0_0_data_0",
          "target": "20288703_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 93,
          "source": "20270233_0_0_data_4",
          "target": "20288703_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 94,
          "source": "20270233_0_0_data_5",
          "target": "20288703_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 95,
          "source": "20270233_0_0_data_6",
          "target": "20288703_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 96,
          "source": "20288703_0_0_script_0",
          "target": "20288703_0_0_data_5",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 97,
          "source": "20270233_0_0_data_1",
          "target": "20288710_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 98,
          "source": "18864935_0_0_data_0",
          "target": "20288710_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 99,
          "source": "20270233_0_0_data_4",
          "target": "20288710_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 100,
          "source": "20270233_0_0_data_5",
          "target": "20288710_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 101,
          "source": "20270233_0_0_data_6",
          "target": "20288710_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 102,
          "source": "20288710_0_0_script_0",
          "target": "20288710_0_0_data_5",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 103,
          "source": "20270233_0_0_data_1",
          "target": "20288695_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 104,
          "source": "18864935_0_0_data_0",
          "target": "20288695_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 105,
          "source": "20270233_0_0_data_4",
          "target": "20288695_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 106,
          "source": "20270233_0_0_data_5",
          "target": "20288695_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 107,
          "source": "20270233_0_0_data_6",
          "target": "20288695_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 108,
          "source": "20288695_0_0_script_0",
          "target": "20288695_0_0_data_5",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 109,
          "source": "20270233_0_0_data_1",
          "target": "20288711_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 110,
          "source": "18864935_0_0_data_0",
          "target": "20288711_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 111,
          "source": "20270233_0_0_data_4",
          "target": "20288711_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 112,
          "source": "20270233_0_0_data_5",
          "target": "20288711_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 113,
          "source": "20270233_0_0_data_6",
          "target": "20288711_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 114,
          "source": "20288711_0_0_script_0",
          "target": "20288711_0_0_data_5",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 115,
          "source": "20270233_0_0_data_0",
          "target": "20288712_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 116,
          "source": "20270233_0_0_data_1",
          "target": "20288712_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 117,
          "source": "18864935_0_0_data_0",
          "target": "20288712_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 118,
          "source": "20270233_0_0_data_4",
          "target": "20288712_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 119,
          "source": "20270233_0_0_data_5",
          "target": "20288712_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 120,
          "source": "20270233_0_0_data_6",
          "target": "20288712_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 121,
          "source": "20288712_0_0_script_0",
          "target": "20288712_0_0_data_3",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 122,
          "source": "20270233_0_0_data_0",
          "target": "20288731_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 123,
          "source": "20270233_0_0_data_1",
          "target": "20288731_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 124,
          "source": "18864935_0_0_data_0",
          "target": "20288731_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 125,
          "source": "20270233_0_0_data_4",
          "target": "20288731_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 126,
          "source": "20270233_0_0_data_5",
          "target": "20288731_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 127,
          "source": "20288731_0_0_script_0",
          "target": "20288731_0_0_data_5",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 128,
          "source": "20270233_0_0_data_0",
          "target": "20288735_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 129,
          "source": "20270233_0_0_data_1",
          "target": "20288735_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 130,
          "source": "18864935_0_0_data_0",
          "target": "20288735_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 131,
          "source": "20288735_0_0_data_3",
          "target": "20288735_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 132,
          "source": "20270233_0_0_data_4",
          "target": "20288735_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 133,
          "source": "20270233_0_0_data_5",
          "target": "20288735_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 134,
          "source": "20288735_0_0_script_0",
          "target": "20288735_0_0_data_5",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 135,
          "source": "20270233_0_0_data_0",
          "target": "20288732_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 136,
          "source": "20270233_0_0_data_1",
          "target": "20288732_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 137,
          "source": "18864935_0_0_data_0",
          "target": "20288732_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 138,
          "source": "20270233_0_0_data_5",
          "target": "20288732_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 139,
          "source": "20288732_0_0_script_0",
          "target": "20288732_0_0_data_3",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 140,
          "source": "20270233_0_0_data_0",
          "target": "20288733_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 141,
          "source": "20270233_0_0_data_1",
          "target": "20288733_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 142,
          "source": "18864935_0_0_data_0",
          "target": "20288733_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 143,
          "source": "20270233_0_0_data_5",
          "target": "20288733_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 144,
          "source": "20288733_0_0_script_0",
          "target": "20288733_0_0_data_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 145,
          "source": "20270233_0_0_data_1",
          "target": "20288736_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 146,
          "source": "18864935_0_0_data_0",
          "target": "20288736_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 147,
          "source": "20288735_0_0_data_3",
          "target": "20288736_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 148,
          "source": "20270233_0_0_data_4",
          "target": "20288736_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 149,
          "source": "20270233_0_0_data_5",
          "target": "20288736_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 150,
          "source": "20288736_0_0_script_0",
          "target": "20288736_0_0_data_3",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 151,
          "source": "20270233_0_0_data_0",
          "target": "20288737_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 152,
          "source": "20270233_0_0_data_1",
          "target": "20288737_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 153,
          "source": "18864935_0_0_data_0",
          "target": "20288737_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 154,
          "source": "20288735_0_0_data_3",
          "target": "20288737_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 155,
          "source": "20270233_0_0_data_5",
          "target": "20288737_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 156,
          "source": "20288737_0_0_script_0",
          "target": "20288737_0_0_data_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 157,
          "source": "20270233_0_0_data_1",
          "target": "20288721_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 158,
          "source": "18864935_0_0_data_0",
          "target": "20288721_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 159,
          "source": "20288735_0_0_data_3",
          "target": "20288721_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 160,
          "source": "20270233_0_0_data_4",
          "target": "20288721_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 161,
          "source": "20270233_0_0_data_5",
          "target": "20288721_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 162,
          "source": "20288721_0_0_script_0",
          "target": "20288721_0_0_data_4",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 163,
          "source": "20270233_0_0_data_0",
          "target": "20288717_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 164,
          "source": "20270233_0_0_data_1",
          "target": "20288717_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 165,
          "source": "18864935_0_0_data_0",
          "target": "20288717_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 166,
          "source": "20288735_0_0_data_3",
          "target": "20288717_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 167,
          "source": "20270233_0_0_data_4",
          "target": "20288717_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 168,
          "source": "20270233_0_0_data_5",
          "target": "20288717_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 169,
          "source": "20270233_0_0_data_6",
          "target": "20288717_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 170,
          "source": "20288717_0_0_script_0",
          "target": "20288717_0_0_data_5",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 171,
          "source": "20270233_0_0_data_0",
          "target": "20288722_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 172,
          "source": "20270233_0_0_data_1",
          "target": "20288722_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 173,
          "source": "18864935_0_0_data_0",
          "target": "20288722_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 174,
          "source": "20288735_0_0_data_3",
          "target": "20288722_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 175,
          "source": "20270233_0_0_data_4",
          "target": "20288722_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 176,
          "source": "20270233_0_0_data_5",
          "target": "20288722_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 177,
          "source": "20288722_0_0_script_0",
          "target": "20288722_0_0_data_6",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 178,
          "source": "20270233_0_0_data_0",
          "target": "20288718_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 179,
          "source": "20270233_0_0_data_1",
          "target": "20288718_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 180,
          "source": "18864935_0_0_data_0",
          "target": "20288718_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 181,
          "source": "20288735_0_0_data_3",
          "target": "20288718_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 182,
          "source": "20270233_0_0_data_4",
          "target": "20288718_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 183,
          "source": "20270233_0_0_data_5",
          "target": "20288718_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 184,
          "source": "20270233_0_0_data_6",
          "target": "20288718_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 185,
          "source": "20288718_0_0_script_0",
          "target": "20288718_0_0_data_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 186,
          "source": "20270233_0_0_data_0",
          "target": "20288729_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 187,
          "source": "20270233_0_0_data_1",
          "target": "20288729_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 188,
          "source": "18864935_0_0_data_0",
          "target": "20288729_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 189,
          "source": "20288735_0_0_data_3",
          "target": "20288729_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 190,
          "source": "20270233_0_0_data_4",
          "target": "20288729_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 191,
          "source": "20270233_0_0_data_5",
          "target": "20288729_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 192,
          "source": "20288729_0_0_script_0",
          "target": "20288729_0_0_data_6",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 193,
          "source": "20270233_0_0_data_0",
          "target": "20288739_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 194,
          "source": "20270233_0_0_data_1",
          "target": "20288739_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 195,
          "source": "18864935_0_0_data_0",
          "target": "20288739_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 196,
          "source": "20288735_0_0_data_3",
          "target": "20288739_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 197,
          "source": "20270233_0_0_data_4",
          "target": "20288739_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 198,
          "source": "20270233_0_0_data_5",
          "target": "20288739_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 199,
          "source": "20288739_0_0_script_0",
          "target": "20288739_0_0_data_3",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 200,
          "source": "20270233_0_0_data_0",
          "target": "20288728_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 201,
          "source": "20270233_0_0_data_1",
          "target": "20288728_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 202,
          "source": "18864935_0_0_data_0",
          "target": "20288728_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 203,
          "source": "20288735_0_0_data_3",
          "target": "20288728_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 204,
          "source": "20270233_0_0_data_4",
          "target": "20288728_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 205,
          "source": "20270233_0_0_data_5",
          "target": "20288728_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 206,
          "source": "20288728_0_0_script_0",
          "target": "20288728_0_0_data_1",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 207,
          "source": "20270233_0_0_data_0",
          "target": "20288730_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 208,
          "source": "20270233_0_0_data_1",
          "target": "20288730_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 209,
          "source": "18864935_0_0_data_0",
          "target": "20288730_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 210,
          "source": "20288735_0_0_data_3",
          "target": "20288730_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 211,
          "source": "20270233_0_0_data_4",
          "target": "20288730_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 212,
          "source": "20270233_0_0_data_5",
          "target": "20288730_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 213,
          "source": "20288730_0_0_data_7",
          "target": "20288730_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 214,
          "source": "20288730_0_0_script_0",
          "target": "20288730_0_0_data_1",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 215,
          "source": "20270233_0_0_data_0",
          "target": "20288740_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 216,
          "source": "20270233_0_0_data_1",
          "target": "20288740_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 217,
          "source": "18864935_0_0_data_0",
          "target": "20288740_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 218,
          "source": "20288735_0_0_data_3",
          "target": "20288740_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 219,
          "source": "20270233_0_0_data_4",
          "target": "20288740_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 220,
          "source": "20270233_0_0_data_5",
          "target": "20288740_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 221,
          "source": "20288740_0_0_script_0",
          "target": "20288740_0_0_data_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 222,
          "source": "20270233_0_0_data_0",
          "target": "20288741_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 223,
          "source": "20270233_0_0_data_1",
          "target": "20288741_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 224,
          "source": "18864935_0_0_data_0",
          "target": "20288741_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 225,
          "source": "20288735_0_0_data_3",
          "target": "20288741_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 226,
          "source": "20270233_0_0_data_4",
          "target": "20288741_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 227,
          "source": "20270233_0_0_data_5",
          "target": "20288741_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 228,
          "source": "20288730_0_0_data_7",
          "target": "20288741_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 229,
          "source": "20288741_0_0_script_0",
          "target": "20288741_0_0_data_5",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 230,
          "source": "18864935_0_0_data_0",
          "target": "20242551_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 231,
          "source": "20242551_0_0_script_0",
          "target": "20242551_0_0_data_1",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 232,
          "source": "18807706_0_0_data_0",
          "target": "18807706_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 233,
          "source": "18864935_0_0_data_0",
          "target": "18807706_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 234,
          "source": "18864935_0_0_data_1",
          "target": "18807706_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 235,
          "source": "18864935_0_0_data_2",
          "target": "18807706_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 236,
          "source": "18864935_0_0_data_3",
          "target": "18807706_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 237,
          "source": "18864935_0_0_data_6",
          "target": "18807706_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 238,
          "source": "18807706_0_0_script_0",
          "target": "18807706_0_0_data_1",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 239,
          "source": "18807706_0_0_data_0",
          "target": "18807708_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 240,
          "source": "18864935_0_0_data_0",
          "target": "18807708_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 241,
          "source": "18864935_0_0_data_1",
          "target": "18807708_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 242,
          "source": "18864935_0_0_data_2",
          "target": "18807708_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 243,
          "source": "18864935_0_0_data_3",
          "target": "18807708_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 244,
          "source": "18864935_0_0_data_6",
          "target": "18807708_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 245,
          "source": "18807708_0_0_script_0",
          "target": "18807706_0_0_data_1",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 246,
          "source": "18864935_0_0_data_0",
          "target": "18856565_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 247,
          "source": "18864935_0_0_data_1",
          "target": "18856565_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 248,
          "source": "18864935_0_0_data_2",
          "target": "18856565_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 249,
          "source": "18864935_0_0_data_3",
          "target": "18856565_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 250,
          "source": "18856565_0_0_data_5",
          "target": "18856565_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 251,
          "source": "18864935_0_0_data_6",
          "target": "18856565_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 252,
          "source": "18856565_0_0_script_0",
          "target": "18807706_0_0_data_1",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 253,
          "source": "18864935_0_0_data_0",
          "target": "18856567_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 254,
          "source": "18864935_0_0_data_1",
          "target": "18856567_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 255,
          "source": "18864937_0_0_data_2",
          "target": "18856567_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 256,
          "source": "18864935_0_0_data_2",
          "target": "18856567_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 257,
          "source": "18864935_0_0_data_3",
          "target": "18856567_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 258,
          "source": "18856565_0_0_data_5",
          "target": "18856567_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 259,
          "source": "18864935_0_0_data_6",
          "target": "18856567_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 260,
          "source": "18856567_0_0_script_0",
          "target": "18807706_0_0_data_1",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 261,
          "source": "18864935_0_0_data_0",
          "target": "18900947_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 262,
          "source": "18864935_0_0_data_1",
          "target": "18900947_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 263,
          "source": "18864935_0_0_data_2",
          "target": "18900947_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 264,
          "source": "18864935_0_0_data_3",
          "target": "18900947_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 265,
          "source": "18856565_0_0_data_5",
          "target": "18900947_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 266,
          "source": "18864935_0_0_data_6",
          "target": "18900947_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 267,
          "source": "18900947_0_0_script_0",
          "target": "18864935_0_0_data_4",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 268,
          "source": "18864935_0_0_data_0",
          "target": "18900949_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 269,
          "source": "18864935_0_0_data_1",
          "target": "18900949_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 270,
          "source": "18864937_0_0_data_2",
          "target": "18900949_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 271,
          "source": "18864935_0_0_data_2",
          "target": "18900949_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 272,
          "source": "18864935_0_0_data_3",
          "target": "18900949_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 273,
          "source": "18856565_0_0_data_5",
          "target": "18900949_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 274,
          "source": "18864935_0_0_data_6",
          "target": "18900949_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 275,
          "source": "18900949_0_0_script_0",
          "target": "18864935_0_0_data_4",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 276,
          "source": "18864935_0_0_data_0",
          "target": "19554665_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 277,
          "source": "18864935_0_0_data_1",
          "target": "19554665_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 278,
          "source": "18864935_0_0_data_2",
          "target": "19554665_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 279,
          "source": "18864935_0_0_data_3",
          "target": "19554665_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 280,
          "source": "18856565_0_0_data_5",
          "target": "19554665_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 281,
          "source": "18864935_0_0_data_6",
          "target": "19554665_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 282,
          "source": "19554665_0_0_script_0",
          "target": "18864935_0_0_data_4",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 283,
          "source": "18864935_0_0_data_0",
          "target": "19554667_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 284,
          "source": "18864935_0_0_data_1",
          "target": "19554667_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 285,
          "source": "18864937_0_0_data_2",
          "target": "19554667_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 286,
          "source": "18864935_0_0_data_2",
          "target": "19554667_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 287,
          "source": "18864935_0_0_data_3",
          "target": "19554667_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 288,
          "source": "18856565_0_0_data_5",
          "target": "19554667_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 289,
          "source": "18864935_0_0_data_6",
          "target": "19554667_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 290,
          "source": "19554667_0_0_script_0",
          "target": "18864935_0_0_data_4",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 291,
          "source": "18864935_0_0_data_0",
          "target": "19466510_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 292,
          "source": "18864935_0_0_data_1",
          "target": "19466510_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 293,
          "source": "18864935_0_0_data_2",
          "target": "19466510_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 294,
          "source": "18864935_0_0_data_3",
          "target": "19466510_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 295,
          "source": "18856565_0_0_data_5",
          "target": "19466510_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 296,
          "source": "18864935_0_0_data_6",
          "target": "19466510_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 297,
          "source": "19466510_0_0_script_0",
          "target": "18864935_0_0_data_4",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 298,
          "source": "18864935_0_0_data_0",
          "target": "19466514_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 299,
          "source": "18864935_0_0_data_1",
          "target": "19466514_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 300,
          "source": "18864937_0_0_data_2",
          "target": "19466514_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 301,
          "source": "18864935_0_0_data_2",
          "target": "19466514_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 302,
          "source": "18864935_0_0_data_3",
          "target": "19466514_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 303,
          "source": "18856565_0_0_data_5",
          "target": "19466514_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 304,
          "source": "18864935_0_0_data_6",
          "target": "19466514_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 305,
          "source": "19466514_0_0_script_0",
          "target": "18864935_0_0_data_4",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 306,
          "source": "18864935_0_0_data_0",
          "target": "20267187_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 307,
          "source": "18864935_0_0_data_1",
          "target": "20267187_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 308,
          "source": "18864935_0_0_data_2",
          "target": "20267187_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 309,
          "source": "18864935_0_0_data_3",
          "target": "20267187_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 310,
          "source": "18856565_0_0_data_5",
          "target": "20267187_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 311,
          "source": "18864935_0_0_data_6",
          "target": "20267187_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 312,
          "source": "20267187_0_0_script_0",
          "target": "18864935_0_0_data_4",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 313,
          "source": "18864935_0_0_data_0",
          "target": "20267189_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 314,
          "source": "18864935_0_0_data_1",
          "target": "20267189_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 315,
          "source": "18864937_0_0_data_2",
          "target": "20267189_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 316,
          "source": "18864935_0_0_data_2",
          "target": "20267189_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 317,
          "source": "18864935_0_0_data_3",
          "target": "20267189_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 318,
          "source": "18856565_0_0_data_5",
          "target": "20267189_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 319,
          "source": "18864935_0_0_data_6",
          "target": "20267189_0_0_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 320,
          "source": "20267189_0_0_script_0",
          "target": "18864935_0_0_data_4",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 321,
          "source": "18807706_0_0_data_1",
          "target": "18856566_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 322,
          "source": "18856566_0_-1_script_0",
          "target": "18856566_0_-1_data_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 323,
          "source": "18807706_0_0_data_1",
          "target": "18856572_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 324,
          "source": "18856572_0_-1_script_0",
          "target": "18856572_0_-1_data_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 325,
          "source": "18807706_0_0_data_1",
          "target": "18856568_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 326,
          "source": "18856568_0_-1_data_2",
          "target": "18856568_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 327,
          "source": "18856568_0_-1_script_0",
          "target": "18856568_0_-1_data_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 328,
          "source": "20288698_0_-1_data_1",
          "target": "20288698_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 329,
          "source": "20288698_0_-1_data_2",
          "target": "20288698_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 330,
          "source": "20288693_0_0_data_6",
          "target": "20288698_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 331,
          "source": "20288698_0_-1_data_4",
          "target": "20288698_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 332,
          "source": "20288698_0_-1_data_5",
          "target": "20288698_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 333,
          "source": "20288698_0_-1_script_0",
          "target": "20288698_0_-1_data_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 334,
          "source": "20288723_0_-1_data_0",
          "target": "20288723_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 335,
          "source": "20288721_0_0_data_4",
          "target": "20288723_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 336,
          "source": "20288723_0_-1_data_3",
          "target": "20288723_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 337,
          "source": "20288723_0_-1_script_0",
          "target": "20288723_0_-1_data_1",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 338,
          "source": "20288739_0_0_data_3",
          "target": "20288739_1_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 339,
          "source": "20288739_1_-1_script_0",
          "target": "20288739_1_-1_data_7",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 340,
          "source": "20288703_0_0_data_5",
          "target": "20288704_1_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 341,
          "source": "20288704_1_-1_data_6",
          "target": "20288704_1_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 342,
          "source": "20288704_1_-1_script_0",
          "target": "20288704_1_-1_data_5",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 343,
          "source": "20288735_0_0_data_5",
          "target": "20288735_1_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 344,
          "source": "20288735_1_-1_script_0",
          "target": "20288735_1_-1_data_8",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 345,
          "source": "20288735_0_0_data_5",
          "target": "20288735_2_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 346,
          "source": "20288735_2_-1_script_0",
          "target": "20288735_2_-1_data_10",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 347,
          "source": "20288715_0_-1_data_0",
          "target": "20288715_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 348,
          "source": "20288715_0_-1_data_1",
          "target": "20288715_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 349,
          "source": "20288712_0_0_data_3",
          "target": "20288715_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 350,
          "source": "20288715_0_-1_data_3",
          "target": "20288715_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 351,
          "source": "20288715_0_-1_data_4",
          "target": "20288715_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 352,
          "source": "20288715_0_-1_data_6",
          "target": "20288715_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 353,
          "source": "20288715_0_-1_data_7",
          "target": "20288715_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 354,
          "source": "20288715_0_-1_script_0",
          "target": "20288715_0_-1_data_5",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 355,
          "source": "20242552_0_-1_data_1",
          "target": "20242552_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 356,
          "source": "20242552_0_-1_data_2",
          "target": "20242552_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 357,
          "source": "20242552_0_-1_data_3",
          "target": "20242552_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 358,
          "source": "20242552_0_-1_data_4",
          "target": "20242552_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 359,
          "source": "20242552_0_-1_data_5",
          "target": "20242552_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 360,
          "source": "20242551_0_0_data_1",
          "target": "20242552_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 361,
          "source": "20242552_0_-1_script_0",
          "target": "20242552_0_-1_data_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 362,
          "source": "20242552_0_-1_data_1",
          "target": "20242553_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 363,
          "source": "20242552_0_-1_data_2",
          "target": "20242553_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 364,
          "source": "20242553_0_-1_data_2",
          "target": "20242553_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 365,
          "source": "20242552_0_-1_data_5",
          "target": "20242553_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 366,
          "source": "20242551_0_0_data_1",
          "target": "20242553_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 367,
          "source": "20242553_0_-1_script_0",
          "target": "20242553_0_-1_data_3",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 368,
          "source": "20242553_0_-1_script_0",
          "target": "20242553_0_-1_data_5",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 369,
          "source": "20288690_0_0_data_3",
          "target": "20288692_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 370,
          "source": "20288692_0_-1_data_2",
          "target": "20288692_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 371,
          "source": "20288692_0_-1_data_3",
          "target": "20288692_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 372,
          "source": "20288692_0_-1_script_0",
          "target": "20288692_0_-1_data_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 373,
          "source": "20288740_0_0_data_0",
          "target": "20288740_1_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 374,
          "source": "20288740_1_-1_script_0",
          "target": "20288740_1_-1_data_8",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 375,
          "source": "20288734_0_-1_data_0",
          "target": "20288734_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 376,
          "source": "20288733_0_0_data_0",
          "target": "20288734_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 377,
          "source": "20288734_0_-1_data_3",
          "target": "20288734_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 378,
          "source": "20288734_0_-1_script_0",
          "target": "20288734_0_-1_data_2",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 379,
          "source": "20270270_0_-1_data_0",
          "target": "20270270_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 380,
          "source": "20288699_0_0_data_0",
          "target": "20270270_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 381,
          "source": "20270270_0_-1_data_2",
          "target": "20270270_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 382,
          "source": "20270270_0_-1_data_3",
          "target": "20270270_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 383,
          "source": "20270270_0_-1_data_5",
          "target": "20270270_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 384,
          "source": "20270270_0_-1_script_0",
          "target": "20270270_0_-1_data_4",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 385,
          "source": "18864935_0_0_data_4",
          "target": "18864936_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 386,
          "source": "18864936_0_-1_script_0",
          "target": "18864936_0_-1_data_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 387,
          "source": "18864935_0_0_data_4",
          "target": "18864942_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 388,
          "source": "18864942_0_-1_script_0",
          "target": "18864942_0_-1_data_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 389,
          "source": "18864938_0_-1_data_0",
          "target": "18864938_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 390,
          "source": "18864935_0_0_data_4",
          "target": "18864938_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 391,
          "source": "18864938_0_-1_script_0",
          "target": "18864938_0_-1_data_2",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 392,
          "source": "18864935_0_0_data_4",
          "target": "18900948_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 393,
          "source": "18900948_0_-1_script_0",
          "target": "18900948_0_-1_data_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 394,
          "source": "18864935_0_0_data_4",
          "target": "18900951_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 395,
          "source": "18900951_0_-1_script_0",
          "target": "18900951_0_-1_data_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 396,
          "source": "18864938_0_-1_data_0",
          "target": "18902516_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 397,
          "source": "18864935_0_0_data_4",
          "target": "18902516_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 398,
          "source": "18902516_0_-1_script_0",
          "target": "18864938_0_-1_data_2",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 399,
          "source": "18864935_0_0_data_4",
          "target": "19554666_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 400,
          "source": "19554666_0_-1_script_0",
          "target": "19554666_0_-1_data_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 401,
          "source": "18864935_0_0_data_4",
          "target": "19554672_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 402,
          "source": "19554672_0_-1_script_0",
          "target": "19554672_0_-1_data_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 403,
          "source": "18864938_0_-1_data_0",
          "target": "19554668_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 404,
          "source": "18864935_0_0_data_4",
          "target": "19554668_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 405,
          "source": "19554668_0_-1_script_0",
          "target": "18864938_0_-1_data_2",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 406,
          "source": "18864935_0_0_data_4",
          "target": "19466513_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 407,
          "source": "19466513_0_-1_script_0",
          "target": "19466513_0_-1_data_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 408,
          "source": "18864935_0_0_data_4",
          "target": "19466515_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 409,
          "source": "19466515_0_-1_script_0",
          "target": "19466515_0_-1_data_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 410,
          "source": "18864938_0_-1_data_0",
          "target": "19466518_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 411,
          "source": "18864935_0_0_data_4",
          "target": "19466518_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 412,
          "source": "19466518_0_-1_script_0",
          "target": "18864938_0_-1_data_2",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 413,
          "source": "18864935_0_0_data_4",
          "target": "20267188_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 414,
          "source": "20267188_0_-1_script_0",
          "target": "20267188_0_-1_data_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 415,
          "source": "18864935_0_0_data_4",
          "target": "20267194_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 416,
          "source": "20267194_0_-1_script_0",
          "target": "20267194_0_-1_data_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 417,
          "source": "18864938_0_-1_data_0",
          "target": "20267190_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 418,
          "source": "18864935_0_0_data_4",
          "target": "20267190_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 419,
          "source": "20267190_0_-1_script_0",
          "target": "18864938_0_-1_data_2",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 420,
          "source": "20270234_0_0_data_0",
          "target": "20270235_1_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 421,
          "source": "20270235_1_-1_data_9",
          "target": "20270235_1_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 422,
          "source": "20270235_1_-1_script_0",
          "target": "20270235_1_-1_data_8",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 423,
          "source": "20288738_0_-1_data_1",
          "target": "20288738_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 424,
          "source": "20288736_0_0_data_3",
          "target": "20288738_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 425,
          "source": "20288738_0_-1_data_3",
          "target": "20288738_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 426,
          "source": "20288738_0_-1_data_4",
          "target": "20288738_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 427,
          "source": "20288738_0_-1_script_0",
          "target": "20288738_0_-1_data_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 428,
          "source": "20288741_0_0_data_5",
          "target": "20288741_1_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 429,
          "source": "20288741_1_-1_script_0",
          "target": "20288741_1_-1_data_9",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 430,
          "source": "20288708_0_-1_data_0",
          "target": "20288708_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 431,
          "source": "20288708_0_-1_data_1",
          "target": "20288708_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 432,
          "source": "20288707_0_0_data_5",
          "target": "20288708_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 433,
          "source": "20288708_0_-1_script_0",
          "target": "20288708_0_-1_data_3",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 434,
          "source": "20288718_0_0_data_0",
          "target": "20288719_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 435,
          "source": "20288719_0_-1_data_2",
          "target": "20288719_0_-1_script_0",
          "label": null,
          "chain": null,
          "type": null
        },
        {
          "id": 436,
          "source": "20288719_0_-1_script_0",
          "target": "20288719_0_-1_data_1",
          "label": null,
          "chain": null,
          "type": null
        }
      ],
      "urn": "hive://cdl_finance/bw_fin_coobps02l_cdl",
      "message": null
    }
  }
}